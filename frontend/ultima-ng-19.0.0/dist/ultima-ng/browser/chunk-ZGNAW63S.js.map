{
  "version": 3,
  "sources": ["src/app/layout/service/layout.service.ts"],
  "sourcesContent": ["import {computed, effect, Injectable, signal, Signal, WritableSignal} from '@angular/core';\nimport {Subject} from 'rxjs';\nimport {MenuItem} from 'primeng/api';\n\nexport type MenuMode = 'static' | 'overlay' | 'slim-plus' | 'slim' | 'horizontal' | 'reveal' | 'drawer';\n\nexport interface layoutConfig {\n    primary: string;\n    surface: string | undefined | null;\n    darkTheme: boolean;\n    menuMode: MenuMode;\n    menuTheme: string;\n    topbarTheme: string;\n    menuProfilePosition: string;\n}\n\nexport interface LayoutState {\n    staticMenuDesktopInactive: boolean;\n    overlayMenuActive: boolean;\n    configSidebarVisible: boolean;\n    staticMenuMobileActive: boolean;\n    menuHoverActive: boolean;\n    rightMenuActive: boolean;\n    topbarMenuActive: boolean;\n    sidebarActive: boolean;\n    activeMenuItem: any;\n    overlaySubmenuActive: boolean;\n    anchored: boolean;\n    menuProfileActive: boolean;\n}\n\nexport interface MenuChangeEvent {\n    key: string;\n    routeEvent?: boolean;\n}\n\nexport interface TabCloseEvent {\n    tab: MenuItem;\n    index: number;\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class LayoutService {\n    _config: layoutConfig = {\n        primary: 'indigo',\n        surface: null,\n        darkTheme: false,\n        menuMode: 'static',\n        menuTheme: 'light',\n        topbarTheme: 'indigo',\n        menuProfilePosition: 'end'\n    };\n\n    _state: LayoutState = {\n        staticMenuDesktopInactive: false,\n        overlayMenuActive: false,\n        configSidebarVisible: false,\n        staticMenuMobileActive: false,\n        menuHoverActive: false,\n        rightMenuActive: false,\n        topbarMenuActive: false,\n        sidebarActive: false,\n        anchored: false,\n        activeMenuItem: null,\n        overlaySubmenuActive: false,\n        menuProfileActive: false\n    };\n\n    layoutConfig = signal<layoutConfig>(this._config);\n\n    layoutState = signal<LayoutState>(this._state);\n\n    private configUpdate = new Subject<layoutConfig>();\n\n    private overlayOpen = new Subject<any>();\n\n    private menuSource = new Subject<MenuChangeEvent>();\n\n    private resetSource = new Subject();\n\n    menuSource$ = this.menuSource.asObservable();\n\n    resetSource$ = this.resetSource.asObservable();\n\n    configUpdate$ = this.configUpdate.asObservable();\n\n    overlayOpen$ = this.overlayOpen.asObservable();\n\n    isSidebarActive: Signal<boolean> = computed(() => this.layoutState().overlayMenuActive || this.layoutState().staticMenuMobileActive);\n\n    isDarkTheme: Signal<boolean> = computed(() => this.layoutConfig().darkTheme);\n\n    isOverlay: Signal<boolean> = computed(() => this.layoutConfig().menuMode === 'overlay');\n\n    isSlim: Signal<boolean> = computed(() => this.layoutConfig().menuMode === 'slim');\n\n    isSlimPlus: Signal<boolean> = computed(() => this.layoutConfig().menuMode === 'slim-plus');\n\n    isHorizontal: Signal<boolean> = computed(() => this.layoutConfig().menuMode === 'horizontal');\n\n    transitionComplete: WritableSignal<boolean> = signal<boolean>(false);\n\n    isSidebarStateChanged = computed(() => {\n        const layoutConfig = this.layoutConfig();\n        return layoutConfig.menuMode === 'horizontal' || layoutConfig.menuMode === 'slim' || layoutConfig.menuMode === 'slim-plus';\n    });\n\n    private initialized = false;\n\n    constructor() {\n        effect(() => {\n            const config = this.layoutConfig();\n            if (config) {\n                this.onConfigUpdate();\n            }\n        });\n\n        effect(() => {\n            const config = this.layoutConfig();\n\n            if (!this.initialized || !config) {\n                this.initialized = true;\n                return;\n            }\n\n            this.handleDarkModeTransition(config);\n        });\n\n        effect(() => {\n            this.isSidebarStateChanged() && this.reset();\n        });\n    }\n\n    private handleDarkModeTransition(config: layoutConfig): void {\n        if ((document as any).startViewTransition) {\n            this.startViewTransition(config);\n        } else {\n            this.toggleDarkMode(config);\n            this.onTransitionEnd();\n        }\n    }\n\n    private startViewTransition(config: layoutConfig): void {\n        const transition = (document as any).startViewTransition(() => {\n            this.toggleDarkMode(config);\n        });\n\n        transition.ready\n            .then(() => {\n                this.onTransitionEnd();\n            })\n            .catch(() => {});\n    }\n\n    toggleDarkMode(config?: layoutConfig): void {\n        const _config = config || this.layoutConfig();\n        if (_config.darkTheme) {\n            document.documentElement.classList.add('app-dark');\n        } else {\n            document.documentElement.classList.remove('app-dark');\n        }\n    }\n\n    private onTransitionEnd() {\n        this.transitionComplete.set(true);\n        setTimeout(() => {\n            this.transitionComplete.set(false);\n        });\n    }\n\n    onMenuToggle() {\n        if (this.isOverlay()) {\n            this.layoutState.update((prev) => ({ ...prev, overlayMenuActive: !this.layoutState().overlayMenuActive }));\n\n            if (this.layoutState().overlayMenuActive) {\n                this.overlayOpen.next(null);\n            }\n        }\n\n        if (this.isDesktop()) {\n            this.layoutState.update((prev) => ({ ...prev, staticMenuDesktopInactive: !this.layoutState().staticMenuDesktopInactive }));\n        } else {\n            this.layoutState.update((prev) => ({ ...prev, staticMenuMobileActive: !this.layoutState().staticMenuMobileActive }));\n\n            if (this.layoutState().staticMenuMobileActive) {\n                this.overlayOpen.next(null);\n            }\n        }\n    }\n\n    onMenuProfileToggle() {\n        this.layoutState.update((prev) => ({ ...prev, menuProfileActive: !prev.menuProfileActive }));\n    }\n\n    openRightMenu() {\n        this.layoutState.update((prev) => ({ ...prev, rightMenuActive: true }));\n    }\n\n    isDesktop() {\n        return window.innerWidth > 991;\n    }\n\n    isMobile() {\n        return !this.isDesktop();\n    }\n\n    onConfigUpdate() {\n        this._config = { ...this.layoutConfig() };\n        this.configUpdate.next(this.layoutConfig());\n    }\n\n    onMenuStateChange(event: MenuChangeEvent) {\n        this.menuSource.next(event);\n    }\n\n    reset() {\n        this.resetSource.next(true);\n    }\n\n    onOverlaySubmenuOpen() {\n        this.overlayOpen.next(null);\n    }\n\n    hideConfigSidebar() {\n        this.layoutState.update((prev) => ({ ...prev, configSidebarVisible: false }));\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
