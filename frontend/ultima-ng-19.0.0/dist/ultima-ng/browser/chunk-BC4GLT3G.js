import{a as W}from"./chunk-UL24E3TI.js";import{a as K,b as Q}from"./chunk-E24E7YRI.js";import"./chunk-F6BLPIFZ.js";import"./chunk-SQPWYWAP.js";import"./chunk-TOQUJNDH.js";import{c as q,d as z}from"./chunk-JK4JG2UW.js";import{a as H,b as J}from"./chunk-KNXQC5ZK.js";import{b as V,d as $}from"./chunk-UCSGE5ZL.js";import"./chunk-2O7XYKW4.js";import{a as I}from"./chunk-YTFCGSG6.js";import"./chunk-RHLJ6NE2.js";import"./chunk-GFZUU5ZD.js";import"./chunk-BODZH67C.js";import"./chunk-KR7F45VC.js";import{f as j,g as O}from"./chunk-XKXBFP6V.js";import"./chunk-ULM4QL4Q.js";import{ka as x,oa as y}from"./chunk-3YZBLOIS.js";import{b as Y}from"./chunk-FVCMZ6IK.js";import"./chunk-VDYO34A5.js";import"./chunk-Y2QT2WK5.js";import"./chunk-S35HUXPS.js";import{n as L,y as A}from"./chunk-GZWLZB4Q.js";import{Gb as n,Hb as r,Ib as l,O as T,Rb as P,Sb as b,Va as a,_ as p,cc as d,ec as u,fc as G,gb as R,i as M,lc as U,ma as w,mb as v,mc as B,va as N,vb as c,yb as F}from"./chunk-MKA3N2SS.js";import{a as o,b as m}from"./chunk-GAL4ENT6.js";var Z=()=>({width:"450px"});function ee(s,t){if(s&1&&(n(0,"div",24)(1,"div",25)(2,"div",10),l(3,"i",26),n(4,"span",27),d(5),r()()()()),s&2){let i,e=b();a(5),u(" Attention : Type de cr\xE9dit non reconnu (",(i=e.state().demandeIndividuel)==null?null:i.tipCredito,") ")}}function te(s,t){s&1&&l(0,"i",28)}function ie(s,t){if(s&1&&(n(0,"p"),l(1,"i",29),d(2),r()),s&2){let i,e=b();a(2),u(" Montant ",(((i=e.state().demandeIndividuel)==null?null:i.montantDemande)||0)<=25e6?"\xE9ligible pour traitement standard":"n\xE9cessitant un traitement sp\xE9cialis\xE9"," ")}}var X=class s{state=N({loading:!1,message:void 0,error:void 0});router=p($);destroyRef=p(w);activatedRouter=p(V);userService=p(Y);typeCreditService=p(W);messageService=p(y);confirmationService=p(x);ngOnInit(){this.loadLastDemandeInd()}loadLastDemandeInd(){this.activatedRouter.paramMap.pipe(T(t=>{let i=t.get("numeroMembre");return i?(this.state.update(e=>m(o({},e),{loading:!0,message:void 0,error:void 0})),this.userService.getLastDemandeInd$(i)):(this.state.update(e=>m(o({},e),{loading:!1,message:void 0,error:"Invalide NumeroMembre"})),M)}),I(this.destroyRef)).subscribe({next:t=>{this.state.update(i=>m(o({},i),{demandeIndividuel:t.data.demandeIndividuel,user:t.data.user,loading:!1,message:t.message,error:void 0}))},error:t=>{this.state.update(i=>m(o({},i),{loading:!1,message:void 0,error:t}))}})}formatMontantGNF(t){return t?new Intl.NumberFormat("fr-GN",{style:"currency",currency:"GNF",minimumFractionDigits:0,maximumFractionDigits:0}).format(t):"0 GNF"}getCreditTypeDescription(t){return this.typeCreditService.getCreditTypeDescription(t)}isCreditTypeValid(t){return t?this.typeCreditService.creditTypeExists(t):!1}getCreditTypeChipStyle(t){return t?t<=5?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":t<=14?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":t<=23?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":t<=47?"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-gray-100 text-gray-800"}startNewCredit(t){this.confirmationService.confirm({message:"\xCAtes-vous s\xFBr de vouloir continuer pour la mise en place du nouveau cr\xE9dit?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.state.update(i=>m(o({},i),{loading:!0})),this.userService.startCredit$(t).pipe(I(this.destroyRef)).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:i.message}),this.state.update(e=>m(o({},e),{loading:!1})),i.data&&i.data.demandeIndividuel?(i.data.demandeIndividuel.montantDemande||0)<=25e6?this.router.navigate(["/dashboards/agent-credit/process-credit",t]):this.router.navigate(["/dashboards/agent-credit/process-big-credit",t]):(this.state().demandeIndividuel?.montantDemande||0)<=25e6?this.router.navigate(["/dashboards/agent-credit/process-credit",t]):this.router.navigate(["/dashboards/agent-credit/process-big-credit",t])},error:i=>{this.messageService.add({severity:"error",summary:"Erreur",detail:i}),this.state.update(e=>m(o({},e),{loading:!1,error:i}))}})}})}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=R({type:s,selectors:[["app-start-credit"]],features:[U([y,x])],decls:49,vars:15,consts:[[1,"bg-surface-0","dark:bg-surface-950","px-6","py-20","md:px-12","lg:px-20"],[1,"bg-surface-0","dark:bg-surface-950"],[1,"font-medium","text-3xl","text-surface-900","dark:text-surface-0","mb-4"],[1,"bg-white","dark:bg-surface-800","shadow-lg","rounded-lg","overflow-hidden"],[1,"bg-surface-50","dark:bg-surface-700","px-6","py-4"],[1,"flex","items-center","font-semibold","text-surface-700","dark:text-surface-200","text-sm","uppercase","tracking-wide"],[1,"w-6/12","md:w-2/12"],[1,"px-6","py-4"],[1,"flex","items-center","text-surface-600","dark:text-surface-300"],[1,"w-6/12","md:w-2/12","font-medium"],[1,"flex","items-center"],[1,"pi","pi-user","mr-2","text-surface-400"],[1,"pi","pi-phone","mr-2","text-surface-400"],[1,"pi","pi-id-card","mr-2","text-surface-400"],[1,"pi","pi-dollar","mr-2","text-green-500"],[1,"font-bold","text-lg","text-green-600","dark:text-green-400"],[1,"pi","pi-bookmark","mr-2","text-surface-400"],[3,"label","styleClass"],["class","px-6 pb-4",4,"ngIf"],[1,"text-surface-700","dark:text-surface-100","text-center"],["label","Commencer la mise en place de Cr\xE9dit","icon","pi pi-play","raised","","rounded","",1,"font-bold","px-8","py-4","whitespace-nowrap",3,"click","disabled"],["class","pi pi-spin pi-spinner mr-2",4,"ngIf"],[1,"mt-4","text-surface-500","dark:text-surface-400","text-sm"],[4,"ngIf"],[1,"px-6","pb-4"],[1,"bg-orange-50","dark:bg-orange-900","border","border-orange-200","dark:border-orange-700","rounded-lg","p-3"],[1,"pi","pi-exclamation-triangle","text-orange-500","mr-2"],[1,"text-orange-700","dark:text-orange-200","text-sm"],[1,"pi","pi-spin","pi-spinner","mr-2"],[1,"pi","pi-info-circle","mr-1"]],template:function(i,e){if(i&1&&(l(0,"p-toast")(1,"p-confirmDialog"),n(2,"div",0)(3,"div",1)(4,"div",2),d(5),r(),n(6,"div",3)(7,"div",4)(8,"div",5)(9,"div",6),d(10,"Nom & Pr\xE9nom"),r(),n(11,"div",6),d(12,"T\xE9l\xE9phone"),r(),n(13,"div",6),d(14,"N\xB0 Membre"),r(),n(15,"div",6),d(16,"Montant"),r(),n(17,"div",6),d(18,"Type de Cr\xE9dit"),r()()(),n(19,"div",7)(20,"div",8)(21,"div",9)(22,"div",10),l(23,"i",11),d(24),r()(),n(25,"div",9)(26,"div",10),l(27,"i",12),d(28),r()(),n(29,"div",9)(30,"div",10),l(31,"i",13),d(32),r()(),n(33,"div",9)(34,"div",10),l(35,"i",14),n(36,"span",15),d(37),r()()(),n(38,"div",9)(39,"div",10),l(40,"i",16)(41,"p-chip",17),r()()()(),v(42,ee,6,1,"div",18),r()(),l(43,"br"),n(44,"div",19)(45,"p-button",20),P("click",function(){let g;return e.startNewCredit((g=e.state().demandeIndividuel)==null?null:g.numeroMembre)}),v(46,te,1,0,"i",21),r(),n(47,"div",22),v(48,ie,3,1,"p",23),r()()()),i&2){let f,g,C,h,S,_,k,E,D;a(),F(B(14,Z)),a(4),u(" ",e.state().message," "),a(19),G(" ",(f=e.state().demandeIndividuel)==null?null:f.nom," ",(f=e.state().demandeIndividuel)==null?null:f.prenom," "),a(4),u(" ",(g=e.state().demandeIndividuel)==null?null:g.telephone," "),a(4),u(" ",(C=e.state().demandeIndividuel)==null?null:C.numeroMembre," "),a(5),u(" ",e.formatMontantGNF((h=e.state().demandeIndividuel)==null?null:h.montantDemande)," "),a(4),c("label",e.getCreditTypeDescription((S=e.state().demandeIndividuel)==null?null:S.tipCredito))("styleClass","text-xs font-semibold px-3 py-1 rounded-full "+e.getCreditTypeChipStyle((_=e.state().demandeIndividuel)==null?null:_.tipCredito)),a(),c("ngIf",!e.isCreditTypeValid((k=e.state().demandeIndividuel)==null?null:k.tipCredito)),a(3),c("disabled",e.state().loading||!((E=e.state().demandeIndividuel)!=null&&E.numeroMembre)),a(),c("ngIf",e.state().loading),a(2),c("ngIf",(D=e.state().demandeIndividuel)==null?null:D.montantDemande)}},dependencies:[A,L,O,j,J,H,Q,K,z,q],encapsulation:2})};export{X as StartCreditComponent};
