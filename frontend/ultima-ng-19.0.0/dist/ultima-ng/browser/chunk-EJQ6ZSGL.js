import{a as W,b as Y}from"./chunk-JKGVJSBA.js";import{a as xt}from"./chunk-UL24E3TI.js";import{a as ct,b as ft,c as pe}from"./chunk-Q5MOEBGQ.js";import{a as gt,b as vt}from"./chunk-E24E7YRI.js";import{a as J,b as P}from"./chunk-4JPZ5GKU.js";import{a as rt,b as at}from"./chunk-GBSAZIIF.js";import"./chunk-F6BLPIFZ.js";import"./chunk-SQPWYWAP.js";import"./chunk-TOQUJNDH.js";import{c as me,d as se}from"./chunk-JK4JG2UW.js";import{a as pt,b as ut}from"./chunk-KNXQC5ZK.js";import{a as mt,k as de}from"./chunk-SRGIHKGJ.js";import"./chunk-KLDL5O4H.js";import"./chunk-PXEEYFPS.js";import"./chunk-4MNJFNZT.js";import"./chunk-7A4CRAMP.js";import"./chunk-3WTE2CKQ.js";import"./chunk-LA2FUI34.js";import"./chunk-ZNTL7BEM.js";import{a as st,b as dt}from"./chunk-QZOXHZZK.js";import"./chunk-MPVO6A2U.js";import"./chunk-D6YNXGTA.js";import"./chunk-ED7TFTUL.js";import"./chunk-MZ7FZGG3.js";import{a as A,b as G}from"./chunk-C4WQ325L.js";import{b as ot,c as lt}from"./chunk-HNZBC55R.js";import"./chunk-J62YMCRW.js";import"./chunk-J6B6CWYC.js";import"./chunk-IEQZB3PI.js";import"./chunk-ATSSA22C.js";import"./chunk-XYTTGGFW.js";import"./chunk-ZNT52ZF3.js";import"./chunk-Z7KSDRLV.js";import"./chunk-N4Q6Z3MW.js";import{a as it,b as nt}from"./chunk-3BEM77IG.js";import{b as Ye,d as oe}from"./chunk-UCSGE5ZL.js";import"./chunk-2O7XYKW4.js";import{a as z}from"./chunk-YTFCGSG6.js";import"./chunk-RHLJ6NE2.js";import{b as et}from"./chunk-R2ZYXRFE.js";import"./chunk-NRZ4QNP7.js";import"./chunk-GFZUU5ZD.js";import"./chunk-BODZH67C.js";import"./chunk-KR7F45VC.js";import{e as $,f as tt,g as F}from"./chunk-XKXBFP6V.js";import"./chunk-ULM4QL4Q.js";import{ka as ie,oa as X,sa as Ze}from"./chunk-3YZBLOIS.js";import{b as R,c as _,e as k,f as B,j as q,m as j,p as U,w as L,x as O,y as H}from"./chunk-2I6ZAGC7.js";import{b as le}from"./chunk-FVCMZ6IK.js";import"./chunk-VDYO34A5.js";import"./chunk-Y2QT2WK5.js";import"./chunk-S35HUXPS.js";import{l as Xe,n as w,u as D,w as We,y as T}from"./chunk-GZWLZB4Q.js";import{Cc as Qe,Gb as e,Hb as t,Ib as s,Jb as Je,Kb as ze,Mb as I,O as Ue,Qa as He,Rb as x,Sb as f,Va as l,_ as E,_a as Q,bc as Ke,cc as n,dc as y,ec as u,fa as C,fc as te,ga as h,gb as N,i as je,lc as ae,ma as Le,mb as c,mc as M,oc as he,pa as K,va as Oe,vb as d,wb as $e,wc as S,yb as re,yc as V,zc as ye}from"./chunk-MKA3N2SS.js";import{a as g,b as v}from"./chunk-GAL4ENT6.js";function ht(a,o){a&1&&(e(0,"small",14),n(1," Note requise entre 0 et 5 "),t())}function yt(a,o){a&1&&(e(0,"small",14),n(1," Motif requis "),t())}function It(a,o){if(a&1){let i=I();e(0,"form",4),x("ngSubmit",function(){C(i);let m=f();return h(m.submit())}),e(1,"div",5)(2,"div",6)(3,"div",7)(4,"label",8),n(5,"Note (0-5)"),t(),s(6,"p-rating",9),c(7,ht,2,0,"small",10),t()(),e(8,"div",11)(9,"div",7)(10,"label",8),n(11,"Motif"),t(),s(12,"textarea",12),c(13,yt,2,0,"small",10),t()(),e(14,"div",11),s(15,"button",13),t()()()}if(a&2){let i,r,m=f();d("formGroup",m.noteForm),l(6),d("stars",5),l(),d("ngIf",((i=m.noteForm.get("note"))==null?null:i.invalid)&&((i=m.noteForm.get("note"))==null?null:i.touched)),l(6),d("ngIf",((r=m.noteForm.get("motif"))==null?null:r.invalid)&&((r=m.noteForm.get("motif"))==null?null:r.touched)),l(2),d("loading",m.submitting)("disabled",m.noteForm.invalid)}}function Et(a,o){if(a&1){let i=I();e(0,"div",15)(1,"div",16)(2,"h3"),n(3),t(),e(4,"button",17),x("click",function(){C(i);let m=f();return h(m.editNote())}),t()(),e(5,"p")(6,"strong"),n(7,"Motif:"),t(),n(8),t(),e(9,"p")(10,"small"),n(11),S(12,"date"),t()()()}if(a&2){let i=f();l(3),u("Note actuelle: ",i.noteProfile==null?null:i.noteProfile.note,"/5"),l(5),u(" ",i.noteProfile==null?null:i.noteProfile.motif,""),l(3),u("Date: ",V(12,3,i.noteProfile==null?null:i.noteProfile.createdAt,"dd/MM/yyyy HH:mm"),"")}}var ue=class a{constructor(o){this.fb=o}noteProfile;referenceCredit;userId;submitting=!1;submitNote=new K;noteForm;ngOnInit(){this.initForm()}initForm(){this.noteForm=this.fb.group({note:[null,[_.required,_.min(0),_.max(5)]],motif:["",_.required]})}submit(){if(this.noteForm.invalid)return;let o=v(g({},this.noteForm.value),{referenceCredit:this.referenceCredit,createdAt:new Date,statusNote:"ACTIVE",userId:this.userId});this.submitNote.emit(o)}editNote(){this.noteProfile&&(this.noteForm.patchValue({note:this.noteProfile.note,motif:this.noteProfile.motif}),this.submitNote.emit(void 0))}static \u0275fac=function(i){return new(i||a)(Q(L))};static \u0275cmp=N({type:a,selectors:[["app-note-profile"]],inputs:{noteProfile:"noteProfile",referenceCredit:"referenceCredit",userId:"userId",submitting:"submitting"},outputs:{submitNote:"submitNote"},decls:4,vars:2,consts:[[1,"col-12","mt-4"],["header","Notation du Profil"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","p-3 border-round bg-blue-50",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6"],[1,"field"],[1,"font-bold"],["formControlName","note",3,"stars"],["class","p-error",4,"ngIf"],[1,"col-12"],["pTextarea","","formControlName","motif","rows","3",1,"w-full"],["pButton","","type","submit","label","Soumettre la notation","icon","pi pi-check",3,"loading","disabled"],[1,"p-error"],[1,"p-3","border-round","bg-blue-50"],[1,"flex","justify-content-between"],["pButton","","icon","pi pi-pencil",1,"p-button-text","p-button-sm",3,"click"]],template:function(i,r){i&1&&(e(0,"div",0)(1,"p-card",1),c(2,It,16,6,"form",2)(3,Et,13,6,"div",3),t()()),i&2&&(l(2),d("ngIf",!(r.noteProfile!=null&&r.noteProfile.noteProfileId)),l(),d("ngIf",r.noteProfile==null?null:r.noteProfile.noteProfileId))},dependencies:[T,w,D,O,q,R,k,B,H,j,U,G,A,F,$,Y,W,P,J],encapsulation:2})};function St(a,o){a&1&&(e(0,"small",14),n(1," Note requise entre 0 et 5 "),t())}function Nt(a,o){a&1&&(e(0,"small",14),n(1," Motif requis "),t())}function wt(a,o){if(a&1){let i=I();e(0,"form",4),x("ngSubmit",function(){C(i);let m=f();return h(m.submit())}),e(1,"div",5)(2,"div",6)(3,"div",7)(4,"label",8),n(5,"Note (0-5)"),t(),s(6,"p-rating",9),c(7,St,2,0,"small",10),t()(),e(8,"div",11)(9,"div",7)(10,"label",8),n(11,"Motif"),t(),s(12,"textarea",12),c(13,Nt,2,0,"small",10),t()(),e(14,"div",11),s(15,"button",13),t()()()}if(a&2){let i,r,m=f();d("formGroup",m.noteForm),l(6),d("stars",5),l(),d("ngIf",((i=m.noteForm.get("note"))==null?null:i.invalid)&&((i=m.noteForm.get("note"))==null?null:i.touched)),l(6),d("ngIf",((r=m.noteForm.get("motif"))==null?null:r.invalid)&&((r=m.noteForm.get("motif"))==null?null:r.touched)),l(2),d("loading",m.submitting)("disabled",m.noteForm.invalid)}}function Tt(a,o){if(a&1){let i=I();e(0,"div",15)(1,"div",16)(2,"h3"),n(3),t(),e(4,"button",17),x("click",function(){C(i);let m=f();return h(m.editNote())}),t()(),e(5,"p")(6,"strong"),n(7,"Motif:"),t(),n(8),t(),e(9,"p")(10,"small"),n(11),S(12,"date"),t()()()}if(a&2){let i=f();l(3),u("Note actuelle: ",i.noteAnalyse==null?null:i.noteAnalyse.note,"/5"),l(5),u(" ",i.noteAnalyse==null?null:i.noteAnalyse.motif,""),l(3),u("Date: ",V(12,3,i.noteAnalyse==null?null:i.noteAnalyse.createdAt,"dd/MM/yyyy HH:mm"),"")}}var _e=class a{constructor(o){this.fb=o}noteAnalyse;referenceCredit;userId;submitting=!1;submitNote=new K;noteForm;ngOnInit(){this.initForm()}initForm(){this.noteForm=this.fb.group({note:[null,[_.required,_.min(0),_.max(5)]],motif:["",_.required]})}submit(){if(this.noteForm.invalid)return;let o=v(g({},this.noteForm.value),{referenceCredit:this.referenceCredit,createdAt:new Date,statusNote:"ACTIVE",userId:this.userId});this.submitNote.emit(o)}editNote(){this.noteAnalyse&&(this.noteForm.patchValue({note:this.noteAnalyse.note,motif:this.noteAnalyse.motif}),this.submitNote.emit(void 0))}static \u0275fac=function(i){return new(i||a)(Q(L))};static \u0275cmp=N({type:a,selectors:[["app-note-analyse"]],inputs:{noteAnalyse:"noteAnalyse",referenceCredit:"referenceCredit",userId:"userId",submitting:"submitting"},outputs:{submitNote:"submitNote"},decls:4,vars:2,consts:[[1,"col-12","mt-4"],["header","Notation de l'Analyse"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","p-3 border-round bg-orange-50",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6"],[1,"field"],[1,"font-bold"],["formControlName","note",3,"stars"],["class","p-error",4,"ngIf"],[1,"col-12"],["pTextarea","","formControlName","motif","rows","3",1,"w-full"],["pButton","","type","submit","label","Soumettre la notation","icon","pi pi-check",3,"loading","disabled"],[1,"p-error"],[1,"p-3","border-round","bg-orange-50"],[1,"flex","justify-content-between"],["pButton","","icon","pi pi-pencil",1,"p-button-text","p-button-sm",3,"click"]],template:function(i,r){i&1&&(e(0,"div",0)(1,"p-card",1),c(2,wt,16,6,"form",2)(3,Tt,13,6,"div",3),t()()),i&2&&(l(2),d("ngIf",!(r.noteAnalyse!=null&&r.noteAnalyse.noteAnalyseId)),l(),d("ngIf",r.noteAnalyse==null?null:r.noteAnalyse.noteAnalyseId))},dependencies:[T,w,D,O,q,R,k,B,H,j,U,G,A,F,$,Y,W,P,J],encapsulation:2})};function Ft(a,o){a&1&&(e(0,"small",14),n(1," Note requise entre 0 et 5 "),t())}function At(a,o){a&1&&(e(0,"small",14),n(1," Motif requis "),t())}function Gt(a,o){if(a&1){let i=I();e(0,"form",4),x("ngSubmit",function(){C(i);let m=f();return h(m.submit())}),e(1,"div",5)(2,"div",6)(3,"div",7)(4,"label",8),n(5,"Note (0-5)"),t(),s(6,"p-rating",9),c(7,Ft,2,0,"small",10),t()(),e(8,"div",11)(9,"div",7)(10,"label",8),n(11,"Motif"),t(),s(12,"textarea",12),c(13,At,2,0,"small",10),t()(),e(14,"div",11),s(15,"button",13),t()()()}if(a&2){let i,r,m=f();d("formGroup",m.noteForm),l(6),d("stars",5),l(),d("ngIf",((i=m.noteForm.get("note"))==null?null:i.invalid)&&((i=m.noteForm.get("note"))==null?null:i.touched)),l(6),d("ngIf",((r=m.noteForm.get("motif"))==null?null:r.invalid)&&((r=m.noteForm.get("motif"))==null?null:r.touched)),l(2),d("loading",m.submitting)("disabled",m.noteForm.invalid)}}function Pt(a,o){if(a&1){let i=I();e(0,"div",15)(1,"div",16)(2,"h3"),n(3),t(),e(4,"button",17),x("click",function(){C(i);let m=f();return h(m.editNote())}),t()(),e(5,"p")(6,"strong"),n(7,"Motif:"),t(),n(8),t(),e(9,"p")(10,"small"),n(11),S(12,"date"),t()()()}if(a&2){let i=f();l(3),u("Note actuelle: ",i.noteGarantie==null?null:i.noteGarantie.note,"/5"),l(5),u(" ",i.noteGarantie==null?null:i.noteGarantie.motif,""),l(3),u("Date: ",V(12,3,i.noteGarantie==null?null:i.noteGarantie.createdAt,"dd/MM/yyyy HH:mm"),"")}}var be=class a{constructor(o){this.fb=o}noteGarantie;referenceCredit;userId;submitting=!1;submitNote=new K;noteForm;ngOnInit(){this.initForm()}initForm(){this.noteForm=this.fb.group({note:[null,[_.required,_.min(0),_.max(5)]],motif:["",_.required]})}submit(){if(this.noteForm.invalid)return;let o=v(g({},this.noteForm.value),{referenceCredit:this.referenceCredit,createdAt:new Date,statusNote:"ACTIVE",userId:this.userId});this.submitNote.emit(o)}editNote(){this.noteGarantie&&(this.noteForm.patchValue({note:this.noteGarantie.note,motif:this.noteGarantie.motif}),this.submitNote.emit(void 0))}static \u0275fac=function(i){return new(i||a)(Q(L))};static \u0275cmp=N({type:a,selectors:[["app-note-garantie"]],inputs:{noteGarantie:"noteGarantie",referenceCredit:"referenceCredit",userId:"userId",submitting:"submitting"},outputs:{submitNote:"submitNote"},decls:4,vars:2,consts:[[1,"col-12","mt-4"],["header","Notation de la Garantie"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","p-3 border-round bg-green-50",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6"],[1,"field"],[1,"font-bold"],["formControlName","note",3,"stars"],["class","p-error",4,"ngIf"],[1,"col-12"],["pTextarea","","formControlName","motif","rows","3",1,"w-full"],["pButton","","type","submit","label","Soumettre la notation","icon","pi pi-check",3,"loading","disabled"],[1,"p-error"],[1,"p-3","border-round","bg-green-50"],[1,"flex","justify-content-between"],["pButton","","icon","pi pi-pencil",1,"p-button-text","p-button-sm",3,"click"]],template:function(i,r){i&1&&(e(0,"div",0)(1,"p-card",1),c(2,Gt,16,6,"form",2)(3,Pt,13,6,"div",3),t()()),i&2&&(l(2),d("ngIf",!(r.noteGarantie!=null&&r.noteGarantie.noteGarantieId)),l(),d("ngIf",r.noteGarantie==null?null:r.noteGarantie.noteGarantieId))},dependencies:[T,w,D,O,q,R,k,B,H,j,U,G,A,F,$,Y,W,P,J],encapsulation:2})};var Vt=()=>({width:"450px"}),Dt=(a,o)=>({"bg-green-50":a,"bg-red-50":o}),Rt=(a,o)=>({"text-green-700":a,"text-red-700":o});function kt(a,o){a&1&&(e(0,"small",15),n(1," Montant sugg\xE9r\xE9 requis "),t())}function Bt(a,o){a&1&&(e(0,"small",15),n(1," Motif requis "),t())}function qt(a,o){if(a&1){let i=I();e(0,"div")(1,"form",4),x("ngSubmit",function(){C(i);let m=f();return h(m.confirmSubmission())}),e(2,"div",5)(3,"div",6)(4,"div",7)(5,"label",8),n(6,"Montant Demand\xE9"),t(),s(7,"p-inputNumber",9),t()(),e(8,"div",6)(9,"div",7)(10,"label",8),n(11,"Montant Sugg\xE9r\xE9"),t(),s(12,"p-inputNumber",10),c(13,kt,2,0,"small",11),t()(),e(14,"div",12)(15,"div",7)(16,"label",8),n(17,"Motif"),t(),s(18,"textarea",13),c(19,Bt,2,0,"small",11),t()(),e(20,"div",12),s(21,"button",14),t()()()()}if(a&2){let i,r,m=f();l(),d("formGroup",m.appreciationForm),l(6),d("disabled",!0),l(6),d("ngIf",((i=m.appreciationForm.get("montantSuggere"))==null?null:i.invalid)&&((i=m.appreciationForm.get("montantSuggere"))==null?null:i.touched)),l(6),d("ngIf",((r=m.appreciationForm.get("motif"))==null?null:r.invalid)&&((r=m.appreciationForm.get("motif"))==null?null:r.touched)),l(2),d("loading",m.calculating)("disabled",m.appreciationForm.invalid)}}function jt(a,o){if(a&1){let i=I();e(0,"div",16)(1,"div",17)(2,"h3"),n(3,"D\xE9cision finale: "),e(4,"span",18),n(5),t()(),e(6,"div")(7,"button",19),x("click",function(){C(i);let m=f();return h(m.resetForm())}),t(),e(8,"button",20),x("click",function(){C(i);let m=f();return h(m.confirmNavigation())}),t()()(),e(9,"div",5)(10,"div",21)(11,"div",7)(12,"label",8),n(13,"Note Totale"),t(),e(14,"div",22),n(15),t()()(),e(16,"div",21)(17,"div",7)(18,"label",8),n(19,"Montant Demand\xE9"),t(),e(20,"div",22),n(21),S(22,"currency"),t()()(),e(23,"div",21)(24,"div",7)(25,"label",8),n(26,"Montant Sugg\xE9r\xE9"),t(),e(27,"div",22),n(28),S(29,"currency"),t()()(),e(30,"div",12)(31,"div",7)(32,"label",8),n(33,"Motif"),t(),e(34,"div"),n(35),t()()()()()}if(a&2){let i,r,m=f();d("ngClass",he(16,Dt,m.resultNote.newStatus==="ACCEPTED",m.resultNote.newStatus==="REJECTED")),l(4),d("ngClass",he(19,Rt,m.resultNote.newStatus==="ACCEPTED",m.resultNote.newStatus==="REJECTED")),l(),u(" ",m.resultNote.newStatus==="ACCEPTED"?"ACCEPT\xC9":"REJET\xC9"," "),l(10),te("",m.resultNote.totalNote,"/",m.maxScore,""),l(6),y(ye(22,8,m.montantDemande,"GNF","symbol")),l(7),y(ye(29,12,(i=m.appreciationForm.get("montantSuggere"))==null?null:i.value,"GNF","symbol")),l(7),y((r=m.appreciationForm.get("motif"))==null?null:r.value)}}var Ce=class a{static DEFAULT_THRESHOLD=7.5;static MAX_SCORE=15;referenceCredit;userId;montantDemande;appreciationForm;calculating=!1;resultNote;maxScore=a.MAX_SCORE;fb=E(L);userService=E(le);messageService=E(X);confirmationService=E(ie);router=E(oe);ngOnInit(){this.initForm()}initForm(){this.appreciationForm=this.fb.group({motif:["",_.required],montantSuggere:[null,[_.required,_.min(0)]],montantDemande:[{value:this.montantDemande,disabled:!0}]})}confirmSubmission(){if(this.appreciationForm.invalid){this.messageService.add({severity:"error",summary:"Erreur",detail:"Veuillez remplir correctement tous les champs requis"});return}this.confirmationService.confirm({message:"\xCAtes-vous s\xFBr de vouloir finaliser cette \xE9valuation de cr\xE9dit?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.submitAppreciation()}})}submitAppreciation(){if(!this.referenceCredit||!this.userId){this.messageService.add({severity:"error",summary:"Erreur",detail:"Informations de r\xE9f\xE9rence manquantes"});return}let o=a.DEFAULT_THRESHOLD,i={motif:this.appreciationForm.get("motif")?.value,montantSuggere:this.appreciationForm.get("montantSuggere")?.value,montantDemande:this.montantDemande,referenceCredit:this.referenceCredit,userId:this.userId,createdAt:new Date};this.calculating=!0,this.userService.calculateNotesAndUpdateCredit(o,i).subscribe({next:r=>{this.calculating=!1,this.resultNote=r.data.resultNote,this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`\xC9valuation de cr\xE9dit compl\xE9t\xE9e avec succ\xE8s. Statut: ${this.resultNote?.newStatus==="ACCEPTED"?"ACCEPT\xC9":"REJET\xC9"}`}),this.appreciationForm.disable(),setTimeout(()=>{this.confirmNavigation()},2e3)},error:r=>{this.calculating=!1,this.messageService.add({severity:"error",summary:"Erreur",detail:typeof r=="string"?r:"Une erreur s'est produite lors du calcul"})}})}confirmNavigation(){this.confirmationService.confirm({message:"Souhaitez-vous retourner au tableau de bord?",header:"Navigation",icon:"pi pi-home",accept:()=>{this.navigateToDashboard()}})}navigateToDashboard(){this.router.navigate(["/dashboards/home"])}resetForm(){this.appreciationForm.reset({montantDemande:this.montantDemande}),this.appreciationForm.enable(),this.appreciationForm.get("montantDemande")?.disable(),this.resultNote=void 0}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=N({type:a,selectors:[["app-appreciation"]],inputs:{referenceCredit:"referenceCredit",userId:"userId",montantDemande:"montantDemande"},features:[ae([X,ie])],decls:6,vars:5,consts:[[1,"col-12","mt-4"],["header","Appr\xE9ciation Finale"],[4,"ngIf"],["class","p-3 border-round",3,"ngClass",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6"],[1,"field"],[1,"font-bold"],["formControlName","montantDemande","mode","currency","currency","GNF","locale","fr-FR",1,"w-full",3,"disabled"],["formControlName","montantSuggere","mode","currency","currency","GNF","locale","fr-FR",1,"w-full"],["class","p-error",4,"ngIf"],[1,"col-12"],["pTextarea","","formControlName","motif","rows","3",1,"w-full"],["pButton","","type","submit","label","Calculer et Finaliser","icon","pi pi-calculator",3,"loading","disabled"],[1,"p-error"],[1,"p-3","border-round",3,"ngClass"],[1,"flex","justify-content-between","align-items-center","mb-3"],[3,"ngClass"],["pButton","","icon","pi pi-refresh","label","R\xE9initialiser",1,"p-button-text","mr-2",3,"click"],["pButton","","icon","pi pi-home","label","Tableau de bord",1,"p-button-text",3,"click"],[1,"col-12","md:col-4"],[1,"text-xl"]],template:function(i,r){i&1&&(e(0,"div",0),s(1,"p-toast")(2,"p-confirmDialog"),e(3,"p-card",1),c(4,qt,22,6,"div",2)(5,jt,36,22,"div",3),t()()),i&2&&(l(2),re(M(4,Vt)),l(2),d("ngIf",!r.resultNote),l(),d("ngIf",r.resultNote))},dependencies:[T,Xe,w,We,O,q,R,k,B,H,j,U,G,A,F,$,et,lt,ot,P,J,pe,de,vt,gt,se,me],encapsulation:2})};var Ut=()=>({width:"60px",height:"60px"}),ne=()=>[];function Lt(a,o){a&1&&s(0,"i",25)}function Ot(a,o){a&1&&(e(0,"div",26)(1,"div",27),s(2,"p-progressSpinner",28),e(3,"p",29),n(4,"Chargement des d\xE9tails du cr\xE9dit..."),t()()()),a&2&&(l(2),re(M(2,Ut)))}function Ht(a,o){if(a&1&&(e(0,"div",30),s(1,"p-message",31),t()),a&2){let i=f();l(),d("text",i.state().error)}}function $t(a,o){a&1&&s(0,"p-chip",105)}function Jt(a,o){if(a&1&&(s(0,"i",103),e(1,"span"),n(2,"Profil Client"),t(),c(3,$t,1,0,"p-chip",104)),a&2){let i=f(2);l(3),d("ngIf",i.state().noteProfile)}}function zt(a,o){a&1&&(e(0,"div",106)(1,"h3",107),s(2,"i",108),n(3,"Information du Client "),t()())}function Kt(a,o){a&1&&(e(0,"div",109)(1,"h3",107),s(2,"i",110),n(3,"D\xE9tails du Cr\xE9dit "),t()())}function Qt(a,o){a&1&&s(0,"p-chip",105)}function Xt(a,o){if(a&1&&(s(0,"i",111),e(1,"span"),n(2,"Analyse Financi\xE8re"),t(),c(3,Qt,1,0,"p-chip",104)),a&2){let i=f(2);l(3),d("ngIf",i.state().noteAnalyse)}}function Wt(a,o){a&1&&(e(0,"div",112)(1,"h3",107),s(2,"i",113),n(3,"R\xE9capitulatif Financier "),t()())}function Yt(a,o){a&1&&(e(0,"div",106)(1,"h3",107),s(2,"i",114),n(3,"D\xE9tail des Produits "),t()())}function Zt(a,o){a&1&&(e(0,"tr")(1,"th"),s(2,"i",115),n(3,"Libell\xE9"),t(),e(4,"th",116),s(5,"i",117),n(6,"Prix Unitaire"),t(),e(7,"th",27),s(8,"i",118),n(9,"Quantit\xE9"),t(),e(10,"th",116),s(11,"i",119),n(12,"Total"),t(),e(13,"th"),s(14,"i",120),n(15,"Observation"),t()())}function ei(a,o){if(a&1&&(e(0,"tr",121)(1,"td")(2,"div",122)(3,"span",123),n(4),t(),e(5,"span",124),n(6),t()()(),e(7,"td",125),n(8),t(),e(9,"td",27)(10,"span",126),n(11),t()(),e(12,"td",127),n(13),t(),e(14,"td")(15,"span",99),n(16),t()()()),a&2){let i=o.$implicit,r=o.rowIndex,m=f(2);l(4),y(r+1),l(2),y(i.libele),l(2),u("",m.formatMontantGNF(i.prix_unit||0)," "),l(3),y(i.qte),l(2),u(" ",m.formatMontantGNF((i.prix_unit||0)*(i.qte||0))," "),l(3),y(i.observation||"Aucune observation")}}function ti(a,o){if(a&1&&(e(0,"tr",128)(1,"td",129),s(2,"i",113),n(3,"Total G\xE9n\xE9ral: "),t(),e(4,"td",130),n(5),t(),s(6,"td"),t()),a&2){let i=f(2);l(5),u(" ",i.formatMontantGNF(i.calculateProductTotal())," ")}}function ii(a,o){a&1&&(e(0,"tr")(1,"td",131)(2,"div",132),s(3,"i",133),e(4,"span",134),n(5,"Aucun produit disponible"),t()()()())}function ni(a,o){a&1&&(e(0,"div",135)(1,"h3",107),s(2,"i",136),n(3,"D\xE9tail des Charges "),t()())}function ri(a,o){a&1&&(e(0,"tr")(1,"th"),s(2,"i",115),n(3,"Libell\xE9"),t(),e(4,"th",116),s(5,"i",117),n(6,"Prix Unitaire"),t(),e(7,"th",27),s(8,"i",118),n(9,"Quantit\xE9"),t(),e(10,"th",116),s(11,"i",119),n(12,"Total"),t(),e(13,"th",27),s(14,"i",137),n(15,"Date"),t()())}function ai(a,o){if(a&1&&(e(0,"tr",138)(1,"td")(2,"div",122)(3,"span",139),n(4),t(),e(5,"span",124),n(6),t()()(),e(7,"td",125),n(8),t(),e(9,"td",27)(10,"span",126),n(11),t()(),e(12,"td",140),n(13),t(),e(14,"td",27)(15,"span",99),n(16),S(17,"date"),t()()()),a&2){let i=o.$implicit,r=o.rowIndex,m=f(2);l(4),y(r+1),l(2),y(i.libele),l(2),u("",m.formatMontantGNF(i.prix_unit||0)," "),l(3),y(i.qte),l(2),u(" ",m.formatMontantGNF((i.prix_unit||0)*(i.qte||0))," "),l(3),y(V(17,6,i.create_at,"dd/MM/yyyy"))}}function oi(a,o){if(a&1&&(e(0,"tr",141)(1,"td",129),s(2,"i",113),n(3,"Total G\xE9n\xE9ral: "),t(),e(4,"td",142),n(5),t(),s(6,"td"),t()),a&2){let i=f(2);l(5),u(" ",i.formatMontantGNF(i.calculateChargeTotal())," ")}}function li(a,o){a&1&&(e(0,"tr")(1,"td",131)(2,"div",132),s(3,"i",143),e(4,"span",134),n(5,"Aucune charge disponible"),t()()()())}function mi(a,o){a&1&&s(0,"p-chip",105)}function si(a,o){if(a&1&&(s(0,"i",144),e(1,"span"),n(2,"Garanties"),t(),c(3,mi,1,0,"p-chip",104)),a&2){let i=f(2);l(3),d("ngIf",i.state().noteGarantie)}}function di(a,o){a&1&&(e(0,"div",145)(1,"h3",107),s(2,"i",146),n(3,"Garantie Mat\xE9rielle "),t()())}function pi(a,o){if(a&1&&(Je(0),n(1),S(2,"date"),ze()),a&2){let i,r=f(2);l(),u(" ",V(2,1,(i=r.state().instanceCreditInd)==null?null:i.garantieCreatedAt,"dd/MM/yyyy HH:mm")," ")}}function ui(a,o){a&1&&n(0,"N/A")}function ci(a,o){a&1&&(e(0,"div",147)(1,"h3",107),s(2,"i",148),n(3,"Localisation "),t()())}function fi(a,o){a&1&&(e(0,"div",149)(1,"h3",107),s(2,"i",150),n(3,"Personnes Caution "),t()())}function gi(a,o){a&1&&(e(0,"tr")(1,"th"),s(2,"i",151),n(3,"Nom & Pr\xE9nom"),t(),e(4,"th"),s(5,"i",152),n(6,"T\xE9l\xE9phone"),t(),e(7,"th",27),s(8,"i",137),n(9,"\xC2ge"),t(),e(10,"th"),s(11,"i",153),n(12,"Activit\xE9"),t(),e(13,"th"),s(14,"i",154),n(15,"Profession"),t()())}function vi(a,o){if(a&1&&(e(0,"tr",155)(1,"td")(2,"div",122)(3,"span",156),n(4),t(),e(5,"div")(6,"div",98),n(7),t()()()(),e(8,"td")(9,"a",157),s(10,"i",152),n(11),t()(),e(12,"td",27)(13,"span",126),n(14),t()(),e(15,"td")(16,"span",99),n(17),t()(),e(18,"td"),s(19,"p-tag",158),t()()),a&2){let i=o.$implicit,r=o.rowIndex;l(4),y(r+1),l(3),te("",i.nom," ",i.prenom,""),l(2),d("href","tel:"+i.telephone,He),l(2),u("",i.telephone," "),l(3),u("",i.age," ans"),l(3),y(i.activite),l(2),d("value",i.profession)}}function xi(a,o){a&1&&(e(0,"tr")(1,"td",131)(2,"div",132),s(3,"i",159),e(4,"span",134),n(5,"Aucune personne de caution disponible"),t()()()())}function _i(a,o){a&1&&(s(0,"i",161),e(1,"span"),n(2,"Appr\xE9ciation Finale"),t(),s(3,"p-chip",105))}function bi(a,o){if(a&1&&(e(0,"p-tabPanel"),c(1,_i,4,0,"ng-template",33),s(2,"app-appreciation",160),t()),a&2){let i,r,m=f(2);l(2),d("referenceCredit",(i=m.state().instanceCreditInd)==null?null:i.referenceCredit)("userId",m.userId)("montantDemande",(r=m.state().instanceCreditInd)==null?null:r.capital)}}function Ci(a,o){if(a&1){let i=I();e(0,"div",30)(1,"p-tabView",32)(2,"p-tabPanel"),c(3,Jt,4,1,"ng-template",33),e(4,"div",34)(5,"div",35)(6,"p-card",36),c(7,zt,4,0,"ng-template",33),e(8,"div",37)(9,"div",38)(10,"label",39),s(11,"i",40),n(12,"Num\xE9ro Membre "),t(),e(13,"div",41),n(14),t()(),e(15,"div",38)(16,"label",39),s(17,"i",42),n(18,"Nom & Pr\xE9nom "),t(),e(19,"div",43),n(20),t()(),e(21,"div",38)(22,"label",39),s(23,"i",44),n(24,"T\xE9l\xE9phone "),t(),e(25,"div",45),n(26),t()(),e(27,"div",38)(28,"label",39),s(29,"i",46),n(30,"Type de Cr\xE9dit "),t(),e(31,"div",47),n(32),t()()()()(),e(33,"div",35)(34,"p-card",36),c(35,Kt,4,0,"ng-template",33),e(36,"div",37)(37,"div",38)(38,"label",39),s(39,"i",48),n(40,"Moyen de Transport "),t(),e(41,"div",41),n(42),t()(),e(43,"div",38)(44,"label",39),s(45,"i",49),n(46,"Capital Demand\xE9 "),t(),e(47,"div",50),n(48),t()(),e(49,"div",34)(50,"div",51)(51,"div",38)(52,"label",52),s(53,"i",53),n(54,"Cr\xE9ance "),t(),e(55,"div",54),n(56),t()()(),e(57,"div",51)(58,"div",38)(59,"label",52),s(60,"i",55),n(61,"Dette "),t(),e(62,"div",56),n(63),t()()()(),e(64,"div",38)(65,"label",39),s(66,"i",57),n(67,"Statut Activit\xE9 "),t(),s(68,"p-tag",58),t(),e(69,"div",38)(70,"label",39),s(71,"i",59),n(72,"Exp\xE9rience "),t(),e(73,"div",47),n(74),t()(),e(75,"div",38)(76,"label",39),s(77,"i",60),n(78,"Lieu d'Activit\xE9 "),t(),e(79,"div",61),n(80),t()()()()(),e(81,"div",62)(82,"app-note-profile",63),x("submitNote",function(m){C(i);let b=f();return h(b.handleProfileNote(m))}),t()()()(),e(83,"p-tabPanel"),c(84,Xt,4,1,"ng-template",33),e(85,"div",34)(86,"div",64)(87,"p-card",65),c(88,Wt,4,0,"ng-template",33),e(89,"div",34)(90,"div",66)(91,"div",67),s(92,"i",68),e(93,"h4",69),n(94,"Total Produits"),t(),e(95,"div",70),n(96),t(),e(97,"small",71),n(98),t()()(),e(99,"div",66)(100,"div",72),s(101,"i",73),e(102,"h4",74),n(103,"Total Charges"),t(),e(104,"div",75),n(105),t(),e(106,"small",76),n(107),t()()(),e(108,"div",66)(109,"div",77),s(110,"i",78),e(111,"h4",79),n(112,"R\xE9sultat Net"),t(),e(113,"div",80),n(114),t(),e(115,"small",81),n(116,"Produits - Charges"),t()()()()()(),e(117,"div",82)(118,"p-card",65),c(119,Yt,4,0,"ng-template",33),e(120,"p-table",83),c(121,Zt,16,0,"ng-template",33)(122,ei,17,6,"ng-template",84)(123,ti,7,1,"ng-template",85)(124,ii,6,0,"ng-template",86),t()()(),e(125,"div",62)(126,"p-card",65),c(127,ni,4,0,"ng-template",33),e(128,"p-table",87),c(129,ri,16,0,"ng-template",33)(130,ai,18,9,"ng-template",84)(131,oi,7,1,"ng-template",85)(132,li,6,0,"ng-template",86),t()()(),e(133,"div",62)(134,"app-note-analyse",88),x("submitNote",function(m){C(i);let b=f();return h(b.handleAnalyseNote(m))}),t()()()(),e(135,"p-tabPanel"),c(136,si,4,1,"ng-template",33),e(137,"div",34)(138,"div",89)(139,"p-card",36),c(140,di,4,0,"ng-template",33),e(141,"div",37)(142,"div",38)(143,"label",39),s(144,"i",90),n(145,"Libell\xE9 "),t(),e(146,"div",41),n(147),t()(),e(148,"div",38)(149,"label",39),s(150,"i",91),n(151,"Montant de la Garantie "),t(),e(152,"div",50),n(153),t()(),e(154,"div",38)(155,"label",39),s(156,"i",59),n(157,"Date de Cr\xE9ation "),t(),e(158,"div",47),c(159,pi,3,4,"ng-container",92)(160,ui,1,0,"ng-template",null,0,Qe),t()()()()(),e(162,"div",89)(163,"p-card",36),c(164,ci,4,0,"ng-template",33),e(165,"div",37)(166,"div",38)(167,"label",39),s(168,"i",93),n(169,"IT ASS "),t(),e(170,"div",45),n(171),t()(),e(172,"div",38)(173,"label",39),s(174,"i",94),n(175,"IT PC "),t(),e(176,"div",95),n(177),t()(),e(178,"div",38)(179,"label",39),s(180,"i",96),n(181,"Fr\xE9quence de Remboursement "),t(),e(182,"div",97)(183,"span",98),n(184),t(),e(185,"span",99),n(186,"jours"),t()()()()()(),e(187,"div",62)(188,"p-card",65),c(189,fi,4,0,"ng-template",33),e(190,"p-table",100),c(191,gi,16,0,"ng-template",33)(192,vi,20,8,"ng-template",84)(193,xi,6,0,"ng-template",86),t()()(),e(194,"div",62)(195,"app-note-garantie",101),x("submitNote",function(m){C(i);let b=f();return h(b.handleGarantieNote(m))}),t()()()(),c(196,bi,3,3,"p-tabPanel",102),t()()}if(a&2){let i,r,m,b,Z,ee,Se,Ne,we,Te,Fe,Ae,Ge,Pe,Me,Ve,De,Re,ke,Be,qe,Ct=Ke(161),p=f();l(14),u(" ",(i=p.state().membre)==null||i.clientesPKId==null?null:i.clientesPKId.codCliente," "),l(6),u(" ",((r=p.state().membre)==null?null:r.nom_CLIENTE)||"N/A"," "),l(6),u(" ",((m=p.state().membre)==null?null:m.tel_PRINCIPAL)||"N/A"," "),l(6),u(" ",p.typeCreditService.getCreditTypeDescription(+((b=p.state().creditDto)==null?null:b.typeCredit))," "),l(10),u(" ",((Z=p.state().instanceCreditInd)==null?null:Z.moyenPerson)||"N/A"," "),l(6),u(" ",p.formatMontantGNF(((ee=p.state().instanceCreditInd)==null?null:ee.capital)||0)," "),l(8),u(" ",p.formatMontantGNF(((Se=p.state().instanceCreditInd)==null?null:Se.creance)||0)," "),l(7),u(" ",p.formatMontantGNF(((Ne=p.state().instanceCreditInd)==null?null:Ne.dette)||0)," "),l(5),d("value",((we=p.state().instanceCreditInd)==null?null:we.statutActivite)||"N/A")("severity",p.getStatusSeverity((Te=p.state().instanceCreditInd)==null?null:Te.statutActivite)),l(6),u(" ",((Fe=p.state().instanceCreditInd)==null?null:Fe.experience)||"N/A"," "),l(6),u(" ",((Ae=p.state().instanceCreditInd)==null?null:Ae.lieuxAct)||"N/A"," "),l(2),d("noteProfile",p.state().noteProfile)("referenceCredit",(Ge=p.state().instanceCreditInd)==null?null:Ge.referenceCredit)("userId",p.userId)("submitting",p.state().submittingProfile),l(14),u(" ",p.formatMontantGNF(p.calculateProductTotal())," "),l(2),u("",(p.state().products||M(49,ne)).length," produit(s)"),l(7),u(" ",p.formatMontantGNF(p.calculateChargeTotal())," "),l(2),u("",(p.state().charges||M(50,ne)).length," charge(s)"),l(7),u(" ",p.formatMontantGNF(p.calculateNetTotal())," "),l(6),d("value",p.state().products||M(51,ne))("paginator",!0)("rows",5)("showCurrentPageReport",!0),l(8),d("value",p.state().charges||M(52,ne))("paginator",!0)("rows",5)("showCurrentPageReport",!0),l(6),d("noteAnalyse",p.state().noteAnalyse)("referenceCredit",(Pe=p.state().instanceCreditInd)==null?null:Pe.referenceCredit)("userId",p.userId)("submitting",p.state().submittingAnalyse),l(13),u(" ",((Me=p.state().instanceCreditInd)==null?null:Me.garantieLibele)||"N/A"," "),l(6),u(" ",p.formatMontantGNF(((Ve=p.state().instanceCreditInd)==null?null:Ve.garantieMontant)||0)," "),l(6),d("ngIf",(De=p.state().instanceCreditInd)==null?null:De.garantieCreatedAt)("ngIfElse",Ct),l(12),u(" ",((Re=p.state().instanceCreditInd)==null?null:Re.itAss)||"Non renseign\xE9"," "),l(6),u(" ",((ke=p.state().instanceCreditInd)==null?null:ke.itPc)||"Non renseign\xE9"," "),l(7),y(((Be=p.state().instanceCreditInd)==null?null:Be.frequence)||0),l(6),d("value",p.state().garantieCaution||M(53,ne))("paginator",!0)("rows",5)("showCurrentPageReport",!0),l(5),d("noteGarantie",p.state().noteGarantie)("referenceCredit",(qe=p.state().instanceCreditInd)==null?null:qe.referenceCredit)("userId",p.userId)("submitting",p.state().submittingGarantie),l(),d("ngIf",p.showAppreciationTab())}}var bt=class a{analyseForm;garantieForm;userId=null;state=Oe({loading:!1,submittingProfile:!1,submittingAnalyse:!1,submittingGarantie:!1,message:void 0,error:void 0});userService=E(le);router=E(oe);destroyRef=E(Le);activatedRouter=E(Ye);messageService=E(X);typeCreditService=E(xt);ngOnInit(){this.loadCreditNew()}formatMontantGNF(o){return!o||o===0?"0 GNF":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"GNF",minimumFractionDigits:0,maximumFractionDigits:0}).format(o)}getNotesCompletionStatus(){let i=[this.state().noteProfile,this.state().noteAnalyse,this.state().noteGarantie].filter(b=>b).length,r=3,m=Math.round(i/r*100);return{completed:i,total:r,percentage:m}}getCreditStatusClass(o){if(!o)return"bg-gray-100 text-gray-800";switch(o.toUpperCase()){case"VALIDE":return"bg-green-100 text-green-800";case"ENCOURS":return"bg-yellow-100 text-yellow-800";case"REJECTED":return"bg-red-100 text-red-800";default:return"bg-blue-100 text-blue-800"}}submitAnalyseNote(){if(this.analyseForm.invalid){this.messageService.add({severity:"error",summary:"Erreur",detail:"Veuillez remplir correctement tous les champs requis"});return}let o=this.state().instanceCreditInd?.referenceCredit;if(!o){this.messageService.add({severity:"error",summary:"Erreur",detail:"R\xE9f\xE9rence de cr\xE9dit manquante"});return}if(!this.userId){this.messageService.add({severity:"error",summary:"Erreur",detail:"ID utilisateur manquant"});return}let i=v(g({},this.analyseForm.value),{referenceCredit:o,createdAt:new Date,statusNote:"ACTIVE",userId:this.userId});this.state.update(r=>v(g({},r),{submittingAnalyse:!0})),this.userService.addNoteAnalyse$(o,i).pipe(z(this.destroyRef)).subscribe({next:r=>{this.state.update(m=>v(g({},m),{submittingAnalyse:!1,noteAnalyse:i})),this.analyseForm.reset(),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Note d'analyse ajout\xE9e avec succ\xE8s"})},error:r=>{this.state.update(m=>v(g({},m),{submittingAnalyse:!1})),this.messageService.add({severity:"error",summary:"Erreur",detail:typeof r=="string"?r:"Une erreur s'est produite lors de l'ajout de la note"})}})}submitGarantieNote(){if(this.garantieForm.invalid){this.messageService.add({severity:"error",summary:"Erreur",detail:"Veuillez remplir correctement tous les champs requis"});return}let o=this.state().instanceCreditInd?.referenceCredit;if(!o){this.messageService.add({severity:"error",summary:"Erreur",detail:"R\xE9f\xE9rence de cr\xE9dit manquante"});return}if(!this.userId){this.messageService.add({severity:"error",summary:"Erreur",detail:"ID utilisateur manquant"});return}let i=v(g({},this.garantieForm.value),{referenceCredit:o,createdAt:new Date,statusNote:"ACTIVE",userId:this.userId});this.state.update(r=>v(g({},r),{submittingGarantie:!0})),this.userService.addNoteGarantie$(o,i).pipe(z(this.destroyRef)).subscribe({next:r=>{this.state.update(m=>v(g({},m),{submittingGarantie:!1,noteGarantie:i})),this.garantieForm.reset(),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Note de garantie ajout\xE9e avec succ\xE8s"})},error:r=>{this.state.update(m=>v(g({},m),{submittingGarantie:!1})),this.messageService.add({severity:"error",summary:"Erreur",detail:typeof r=="string"?r:"Une erreur s'est produite lors de l'ajout de la note"})}})}loadCreditNew(){this.activatedRouter.paramMap.pipe(Ue(o=>{let i=o.get("referenceCredit"),r=o.get("numeroMembre"),m=o.get("userId");return this.userId=m?+m:null,i?(this.state.update(b=>v(g({},b),{loading:!0,message:void 0,error:void 0})),this.userService.viewInstanceCredit$(i,r,+m)):(this.state.update(b=>v(g({},b),{loading:!1,message:void 0,error:"Invalide NumeroMembre"})),je)}),z(this.destroyRef)).subscribe({next:o=>{this.state.update(i=>v(g({},i),{instanceCreditInd:o.data?.instanceCreditInd,creditDto:o.data?.creditDto,referenceCredit:o.data?.creditDto?.referenceCredit,membre:o.data?.membre,charges:o.data?.charges||[],products:o.data?.products||[],garantieCaution:o.data?.garantieCaution||[],noteProfile:o.data?.noteProfile,noteAnalyse:o.data?.noteAnalyse,noteGarantie:o.data?.noteGarantie,loading:!1,message:o.message,error:void 0}))},error:o=>{this.state.update(i=>v(g({},i),{loading:!1,message:void 0,error:o})),this.messageService.add({severity:"error",summary:"Erreur",detail:typeof o=="string"?o:"Une erreur s'est produite lors du chargement des donn\xE9es"})}})}getStatusSeverity(o){if(!o)return"info";switch(o.toUpperCase()){case"ACTIVE":case"APPROUVE":return"success";case"EN_ATTENTE":return"warn";case"INACTIVE":case"REJETE":return"danger";default:return"info"}}getCreditStateSeverity(o){if(!o)return"info";switch(o.toUpperCase()){case"VALIDE":return"success";case"ENCOURS":return"warn";case"REJECTED":return"danger";default:return"info"}}calculateProductTotal(){return this.state().products?.length?this.state().products.reduce((o,i)=>o+(i.prix_unit||0)*(i.qte||0),0):0}calculateChargeTotal(){return this.state().charges?.length?this.state().charges.reduce((o,i)=>o+(i.prix_unit||0)*(i.qte||0),0):0}calculateNetTotal(){return this.calculateProductTotal()-this.calculateChargeTotal()}handleProfileNote(o){if(!o){this.state.update(r=>v(g({},r),{noteProfile:void 0}));return}let i=this.state().instanceCreditInd?.referenceCredit;if(!i){this.messageService.add({severity:"error",summary:"Erreur",detail:"R\xE9f\xE9rence de cr\xE9dit manquante"});return}this.state.update(r=>v(g({},r),{submittingProfile:!0})),this.userService.addNoteProfile$(i,o).pipe(z(this.destroyRef)).subscribe({next:r=>{this.state.update(m=>v(g({},m),{submittingProfile:!1,noteProfile:r.data.noteProfile,noteAnalyse:r.data.noteAnalyse,noteGarantie:r.data.noteGarantie})),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Note de profil ajout\xE9e avec succ\xE8s"})},error:r=>{this.state.update(m=>v(g({},m),{submittingProfile:!1})),this.messageService.add({severity:"error",summary:"Erreur",detail:typeof r=="string"?r:"Une erreur s'est produite lors de l'ajout de la note"})}})}handleAnalyseNote(o){if(!o){this.state.update(r=>v(g({},r),{noteAnalyse:void 0}));return}let i=this.state().instanceCreditInd?.referenceCredit;if(!i){this.messageService.add({severity:"error",summary:"Erreur",detail:"R\xE9f\xE9rence de cr\xE9dit manquante"});return}this.state.update(r=>v(g({},r),{submittingAnalyse:!0})),this.userService.addNoteAnalyse$(i,o).pipe(z(this.destroyRef)).subscribe({next:r=>{this.state.update(m=>v(g({},m),{submittingAnalyse:!1,noteProfile:r.data.noteProfile,noteAnalyse:r.data.noteAnalyse,noteGarantie:r.data.noteGarantie})),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Note d'analyse ajout\xE9e avec succ\xE8s"})},error:r=>{this.state.update(m=>v(g({},m),{submittingAnalyse:!1})),this.messageService.add({severity:"error",summary:"Erreur",detail:typeof r=="string"?r:"Une erreur s'est produite lors de l'ajout de la note"})}})}handleGarantieNote(o){if(!o){this.state.update(r=>v(g({},r),{noteGarantie:void 0}));return}let i=this.state().instanceCreditInd?.referenceCredit;if(!i){this.messageService.add({severity:"error",summary:"Erreur",detail:"R\xE9f\xE9rence de cr\xE9dit manquante"});return}this.state.update(r=>v(g({},r),{submittingGarantie:!0})),this.userService.addNoteGarantie$(i,o).pipe(z(this.destroyRef)).subscribe({next:r=>{this.state.update(m=>v(g({},m),{submittingGarantie:!1,noteProfile:r.data.noteProfile,noteAnalyse:r.data.noteAnalyse,noteGarantie:r.data.noteGarantie})),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Note de garantie ajout\xE9e avec succ\xE8s"})},error:r=>{this.state.update(m=>v(g({},m),{submittingGarantie:!1})),this.messageService.add({severity:"error",summary:"Erreur",detail:typeof r=="string"?r:"Une erreur s'est produite lors de l'ajout de la note"})}})}showAppreciationTab(){return!!(this.state().noteProfile&&this.state().noteAnalyse&&this.state().noteGarantie)}refreshData(){this.loadCreditNew(),this.messageService.add({severity:"info",summary:"Actualisation",detail:"Donn\xE9es actualis\xE9es avec succ\xE8s",life:2e3})}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=N({type:a,selectors:[["app-view-instance-credit-ind"]],features:[ae([X,ie])],decls:40,vars:14,consts:[["noGarantieDate",""],[1,"surface-0","min-h-screen"],[1,"p-6","shadow-lg",2,"background","linear-gradient(135deg, #1976D2 0%, #2196F3 100%)","color","white"],[1,"flex","flex-column","md:flex-row","align-items-start","md:align-items-center","justify-content-between","gap-4"],[1,"flex","align-items-center","gap-3"],["icon","pi pi-arrow-left","severity","success","text","","styleClass","text-white border-white hover:bg-white hover:text-emerald-600",3,"click"],[1,"text-2xl","md:text-3xl","font-bold","m-0","mb-2"],[1,"pi","pi-file-edit","mr-2"],[1,"text-emerald-100","m-0","text-lg"],[1,"flex","gap-3","flex-wrap"],[1,"bg-dark","bg-opacity-20","p-3","border-round","text-center"],[1,"text-2xl","font-bold"],[1,"text-sm","opacity-90"],[3,"label","styleClass"],[1,"text-sm","opacity-90","mt-1"],["icon","pi pi-refresh","severity","secondary","text","","styleClass","text-white border-white hover:bg-white hover:text-blue-600","pTooltip","Actualiser les donn\xE9es",3,"click","loading"],[1,"mt-4"],[1,"flex","align-items-center","gap-2","mb-2"],[1,"text-sm","font-medium"],[1,"text-sm"],[1,"w-full","bg-white","bg-opacity-20","border-round","h-2rem","overflow-hidden"],[1,"bg-emerald-400","h-full","transition-all","duration-500","ease-in-out","flex","align-items-center","justify-content-end","pr-2"],["class","pi pi-check text-white text-xs",4,"ngIf"],["class","flex justify-content-center align-items-center py-8",4,"ngIf"],["class","p-4",4,"ngIf"],[1,"pi","pi-check","text-white","text-xs"],[1,"flex","justify-content-center","align-items-center","py-8"],[1,"text-center"],["strokeWidth","4"],[1,"text-600","mt-3"],[1,"p-4"],["severity","error","styleClass","w-full",3,"text"],["styleClass","custom-tabview"],["pTemplate","header"],[1,"grid"],[1,"col-12","lg:col-4"],["styleClass","h-full shadow-2"],[1,"p-fluid"],[1,"field","mb-4"],[1,"font-bold","text-900","mb-2","block"],[1,"pi","pi-id-card","mr-2","text-blue-500"],[1,"p-3","bg-blue-50","border-round"],[1,"pi","pi-users","mr-2","text-green-500"],[1,"p-3","bg-green-50","border-round"],[1,"pi","pi-phone","mr-2","text-orange-500"],[1,"p-3","bg-orange-50","border-round"],[1,"pi","pi-briefcase","mr-2","text-purple-500"],[1,"p-3","bg-purple-50","border-round"],[1,"pi","pi-car","mr-2","text-blue-500"],[1,"pi","pi-wallet","mr-2","text-green-500"],[1,"p-3","bg-green-50","border-round","font-bold","text-green-700","text-xl"],[1,"col-6"],[1,"font-bold","text-900","mb-2","block","text-sm"],[1,"pi","pi-plus-circle","mr-1","text-cyan-500"],[1,"p-2","bg-cyan-50","border-round","text-sm"],[1,"pi","pi-minus-circle","mr-1","text-red-500"],[1,"p-2","bg-red-50","border-round","text-sm"],[1,"pi","pi-flag","mr-2","text-orange-500"],["styleClass","w-full justify-content-center",3,"value","severity"],[1,"pi","pi-calendar","mr-2","text-purple-500"],[1,"pi","pi-map-marker","mr-2","text-red-500"],[1,"p-3","bg-red-50","border-round"],[1,"col-12","mt-4"],[3,"submitNote","noteProfile","referenceCredit","userId","submitting"],[1,"col-12","mb-4"],["styleClass","shadow-2"],[1,"col-12","md:col-4"],[1,"bg-blue-50","p-4","border-round","text-center","border-left-3","border-blue-500"],[1,"pi","pi-shopping-cart","text-3xl","text-blue-500","mb-2"],[1,"text-blue-700","m-0","mb-1"],[1,"text-2xl","font-bold","text-blue-800"],[1,"text-blue-600"],[1,"bg-orange-50","p-4","border-round","text-center","border-left-3","border-orange-500"],[1,"pi","pi-minus-circle","text-3xl","text-orange-500","mb-2"],[1,"text-orange-700","m-0","mb-1"],[1,"text-2xl","font-bold","text-orange-800"],[1,"text-orange-600"],[1,"bg-green-50","p-4","border-round","text-center","border-left-3","border-green-500"],[1,"pi","pi-chart-line","text-3xl","text-green-500","mb-2"],[1,"text-green-700","m-0","mb-1"],[1,"text-2xl","font-bold","text-green-800"],[1,"text-green-600"],[1,"col-12"],["responsiveLayout","scroll","styleClass","p-datatable-striped","currentPageReportTemplate","Affichage de {first} \xE0 {last} sur {totalRecords} produits",3,"value","paginator","rows","showCurrentPageReport"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],["responsiveLayout","scroll","styleClass","p-datatable-striped","currentPageReportTemplate","Affichage de {first} \xE0 {last} sur {totalRecords} charges",3,"value","paginator","rows","showCurrentPageReport"],[3,"submitNote","noteAnalyse","referenceCredit","userId","submitting"],[1,"col-12","md:col-6"],[1,"pi","pi-tag","mr-2","text-blue-500"],[1,"pi","pi-money-bill","mr-2","text-green-500"],[4,"ngIf","ngIfElse"],[1,"pi","pi-building","mr-2","text-orange-500"],[1,"pi","pi-desktop","mr-2","text-cyan-500"],[1,"p-3","bg-cyan-50","border-round"],[1,"pi","pi-clock","mr-2","text-indigo-500"],[1,"p-3","bg-indigo-50","border-round","flex","align-items-center","gap-2"],[1,"font-bold"],[1,"text-600"],["responsiveLayout","scroll","styleClass","p-datatable-striped","currentPageReportTemplate","Affichage de {first} \xE0 {last} sur {totalRecords} cautions",3,"value","paginator","rows","showCurrentPageReport"],[3,"submitNote","noteGarantie","referenceCredit","userId","submitting"],[4,"ngIf"],[1,"pi","pi-user","mr-2"],["icon","pi pi-check","styleClass","ml-2 bg-green-100 text-green-800 text-xs",4,"ngIf"],["icon","pi pi-check","styleClass","ml-2 bg-green-100 text-green-800 text-xs"],[1,"bg-gradient-to-r","from-blue-500","to-cyan-500","text-white","p-4"],[1,"m-0","font-bold"],[1,"pi","pi-user-plus","mr-2"],[1,"bg-gradient-to-r","from-green-500","to-teal-500","text-white","p-4"],[1,"pi","pi-money-bill","mr-2"],[1,"pi","pi-chart-line","mr-2"],[1,"bg-gradient-to-r","from-emerald-500","to-teal-500","text-white","p-4"],[1,"pi","pi-calculator","mr-2"],[1,"pi","pi-shopping-bag","mr-2"],[1,"pi","pi-tag","mr-1"],[1,"text-right"],[1,"pi","pi-money-bill","mr-1"],[1,"pi","pi-sort-amount-up","mr-1"],[1,"pi","pi-calculator","mr-1"],[1,"pi","pi-comment","mr-1"],[1,"hover:bg-blue-50"],[1,"flex","align-items-center","gap-2"],[1,"bg-blue-100","text-blue-800","text-xs","font-medium","px-2","py-1","border-round"],[1,"font-medium"],[1,"text-right","font-medium"],[1,"bg-gray-100","px-2","py-1","border-round","font-bold"],[1,"text-right","font-bold","text-green-600"],[1,"bg-blue-50"],["colspan","3",1,"text-right","font-bold","text-lg"],[1,"font-bold","text-lg","text-green-600","text-right"],["colspan","5",1,"text-center","p-6"],[1,"flex","flex-column","align-items-center","gap-3"],[1,"pi","pi-shopping-bag","text-4xl","text-400"],[1,"text-600","font-medium"],[1,"bg-gradient-to-r","from-orange-500","to-red-500","text-white","p-4"],[1,"pi","pi-minus-circle","mr-2"],[1,"pi","pi-calendar","mr-1"],[1,"hover:bg-orange-50"],[1,"bg-orange-100","text-orange-800","text-xs","font-medium","px-2","py-1","border-round"],[1,"text-right","font-bold","text-red-600"],[1,"bg-orange-50"],[1,"font-bold","text-lg","text-red-600","text-right"],[1,"pi","pi-minus-circle","text-4xl","text-400"],[1,"pi","pi-shield","mr-2"],[1,"bg-gradient-to-r","from-green-500","to-emerald-500","text-white","p-4"],[1,"pi","pi-home","mr-2"],[1,"bg-gradient-to-r","from-blue-500","to-indigo-500","text-white","p-4"],[1,"pi","pi-map-marker","mr-2"],[1,"bg-gradient-to-r","from-purple-500","to-pink-500","text-white","p-4"],[1,"pi","pi-users","mr-2"],[1,"pi","pi-user","mr-1"],[1,"pi","pi-phone","mr-1"],[1,"pi","pi-briefcase","mr-1"],[1,"pi","pi-id-card","mr-1"],[1,"hover:bg-purple-50"],[1,"bg-purple-100","text-purple-800","text-xs","font-medium","px-2","py-1","border-round"],[1,"text-blue-600","hover:text-blue-800",3,"href"],["severity","info","styleClass","text-xs",3,"value"],[1,"pi","pi-users","text-4xl","text-400"],[3,"referenceCredit","userId","montantDemande"],[1,"pi","pi-star","mr-2"]],template:function(i,r){if(i&1&&(e(0,"div",1),s(1,"p-toast"),e(2,"div",2)(3,"div",3)(4,"div",4)(5,"p-button",5),x("click",function(){return r.router.navigate(["/d"])}),t(),e(6,"div")(7,"h1",6),s(8,"i",7),n(9,"Analyse de Cr\xE9dit "),t(),e(10,"p",8),n(11),t()()(),e(12,"div",9)(13,"div",10)(14,"div",11),n(15),t(),e(16,"div",12),n(17,"Montant demand\xE9"),t()(),e(18,"div",10)(19,"div",11),n(20),t(),e(21,"div",12),n(22,"Notes compl\xE9t\xE9es"),t()(),e(23,"div",10),s(24,"p-chip",13),e(25,"div",14),n(26,"Statut"),t()(),e(27,"p-button",15),x("click",function(){return r.refreshData()}),t()()(),e(28,"div",16)(29,"div",17)(30,"span",18),n(31,"Progression des notes:"),t(),e(32,"span",19),n(33),t()(),e(34,"div",20)(35,"div",21),c(36,Lt,1,0,"i",22),t()()()(),c(37,Ot,5,3,"div",23)(38,Ht,2,1,"div",24)(39,Ci,197,54,"div",24),t()),i&2){let m,b,Z,ee;l(11),u(" ",(m=r.state().instanceCreditInd)==null?null:m.referenceCredit," "),l(4),u("",r.formatMontantGNF((b=r.state().creditDto)==null?null:b.montantCredit)," "),l(5),te("",r.getNotesCompletionStatus().completed,"/",r.getNotesCompletionStatus().total,""),l(4),d("label",((Z=r.state().instanceCreditInd)==null?null:Z.stateCredit)||"N/A")("styleClass","font-bold "+r.getCreditStatusClass((ee=r.state().instanceCreditInd)==null?null:ee.stateCredit)),l(3),d("loading",r.state().loading),l(6),u("",r.getNotesCompletionStatus().percentage,"%"),l(2),$e("width",r.getNotesCompletionStatus().percentage,"%"),l(),d("ngIf",r.getNotesCompletionStatus().percentage===100),l(),d("ngIf",r.state().loading),l(),d("ngIf",r.state().error&&!r.state().loading),l(),d("ngIf",!r.state().loading&&!r.state().error)}},dependencies:[T,w,D,pe,ft,ct,Ze,G,A,de,mt,nt,it,at,rt,dt,st,F,tt,P,ut,pt,se,me,ue,_e,be,Ce],encapsulation:2})};export{bt as ViewInstanceCreditIndComponent};
