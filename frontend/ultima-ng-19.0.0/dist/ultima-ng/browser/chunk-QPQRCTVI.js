import{a as Pe}from"./chunk-IAYGIRSF.js";import{b as Be}from"./chunk-K2RLQDMJ.js";import{a as Re,b as Te}from"./chunk-JA4WM3ZQ.js";import{b as _e}from"./chunk-4JPZ5GKU.js";import{b as he}from"./chunk-IDKLANHK.js";import{c as fe,d as be}from"./chunk-JK4JG2UW.js";import{b as xe}from"./chunk-ML3LU6MO.js";import{k as Se}from"./chunk-SRGIHKGJ.js";import"./chunk-KLDL5O4H.js";import{b as Ce}from"./chunk-PXEEYFPS.js";import"./chunk-4MNJFNZT.js";import{b as Ne}from"./chunk-7A4CRAMP.js";import"./chunk-3WTE2CKQ.js";import"./chunk-LA2FUI34.js";import"./chunk-ZNTL7BEM.js";import{b as Fe}from"./chunk-QZOXHZZK.js";import"./chunk-MPVO6A2U.js";import"./chunk-D6YNXGTA.js";import"./chunk-ED7TFTUL.js";import"./chunk-MZ7FZGG3.js";import{a as Ae,b as Ie}from"./chunk-C4WQ325L.js";import{b as Ee,c as ye}from"./chunk-HNZBC55R.js";import"./chunk-J62YMCRW.js";import"./chunk-J6B6CWYC.js";import"./chunk-IEQZB3PI.js";import"./chunk-ATSSA22C.js";import"./chunk-XYTTGGFW.js";import"./chunk-ZNT52ZF3.js";import"./chunk-Z7KSDRLV.js";import"./chunk-N4Q6Z3MW.js";import{b as W,d as X}from"./chunk-UCSGE5ZL.js";import"./chunk-2O7XYKW4.js";import{a as x}from"./chunk-YTFCGSG6.js";import"./chunk-RHLJ6NE2.js";import{a as se,b as le}from"./chunk-R2ZYXRFE.js";import{a as de,b as ce}from"./chunk-NRZ4QNP7.js";import"./chunk-GFZUU5ZD.js";import"./chunk-BODZH67C.js";import"./chunk-KR7F45VC.js";import{b as ue,e as me,g as pe}from"./chunk-XKXBFP6V.js";import"./chunk-ULM4QL4Q.js";import{oa as G,sa as J}from"./chunk-3YZBLOIS.js";import{b as K,e as Y,f as Z,j as ee,l as te,m as ie,p as ne,w as re,x as oe,y as ae}from"./chunk-2I6ZAGC7.js";import{b as ge}from"./chunk-FVCMZ6IK.js";import{a as ve}from"./chunk-VDYO34A5.js";import{e as Q}from"./chunk-Y2QT2WK5.js";import"./chunk-S35HUXPS.js";import{j as L,l as q,m as $,n as U,v as O,w as H,y as z}from"./chunk-GZWLZB4Q.js";import{Bc as g,Ec as k,Gb as n,Hb as t,Ib as a,Mb as B,Mc as u,Rb as F,Sb as h,Va as r,_ as A,cc as o,dc as R,ec as d,fa as I,fc as D,ga as _,gb as j,lc as w,ma as V,mb as C,nc as v,u as P,va as S,vb as s,wc as c,yc as M}from"./chunk-MKA3N2SS.js";import{a as E,b as y}from"./chunk-GAL4ENT6.js";var f=m=>[m,"GNF","symbol","1.0-0","fr-FR"];function Ge(m,i){if(m&1){let e=B();n(0,"div",9)(1,"div",10)(2,"span"),a(3,"i",11),o(4,"Aucune analyse financi\xE8re n'existe pour cette demande."),t(),n(5,"button",12),F("click",function(){I(e);let p=h();return _(p.createOrUpdateAnalyse())}),t()()()}if(m&2){let e=h();r(5),s("loading",e.loading())}}function Ve(m,i){if(m&1&&(n(0,"div",9)(1,"div",13),a(2,"i",14),n(3,"span",15),o(4),t()()()),m&2){let e=h();r(4),d("Analyse financi\xE8re #",e.state().analyseId," en cours d'\xE9dition")}}function je(m,i){m&1&&(n(0,"div",45)(1,"h2",46),o(2,"BILAN"),t(),n(3,"span",47),o(4,"en GNF"),t()())}function we(m,i){if(m&1){let e=B();n(0,"div",48)(1,"button",49),F("click",function(){I(e);let p=h(2);return _(p.saveBilanAll())}),t()()}if(m&2){let e=h(2);r(),s("loading",e.savingBilan())("disabled",!e.state().analyseExiste)}}function Me(m,i){if(m&1&&(n(0,"div")(1,"p-card"),C(2,je,5,0,"ng-template",16),n(3,"div",17)(4,"table",18)(5,"thead")(6,"tr",19)(7,"th",20),o(8,"Bilan"),t(),n(9,"th",21),o(10," \xC9valuation actuelle"),a(11,"br"),n(12,"small",22),o(13,"Montant (N)"),t()(),n(14,"th",23),o(15," \xC9valuation pr\xE9c\xE9dente"),a(16,"br"),n(17,"small",22),o(18,"Montant (N-1)"),t()(),n(19,"th",24),o(20,"Observations"),t()()(),n(21,"tbody")(22,"tr",25)(23,"td",26),o(24,"ACTIF"),t()(),n(25,"tr",27)(26,"td",28),o(27,"Immobilisations"),t(),n(28,"td",29),o(29),c(30,"currency"),t(),n(31,"td",30),o(32),c(33,"currency"),t(),a(34,"td",31),t(),n(35,"tr")(36,"td",32),o(37,"Terrains"),t(),n(38,"td",33),a(39,"p-inputNumber",34),t(),n(40,"td",33),a(41,"p-inputNumber",34),t(),n(42,"td",33),a(43,"input",35),t()(),n(44,"tr")(45,"td",32),o(46,"B\xE2timents et magasin"),t(),n(47,"td",33),a(48,"p-inputNumber",34),t(),n(49,"td",33),a(50,"p-inputNumber",34),t(),n(51,"td",33),a(52,"input",35),t()(),n(53,"tr")(54,"td",32),o(55,"Installations et agencements"),t(),n(56,"td",33),a(57,"p-inputNumber",34),t(),n(58,"td",33),a(59,"p-inputNumber",34),t(),n(60,"td",33),a(61,"input",35),t()(),n(62,"tr")(63,"td",32),o(64,"Mat\xE9riels industriels"),t(),n(65,"td",33),a(66,"p-inputNumber",34),t(),n(67,"td",33),a(68,"p-inputNumber",34),t(),n(69,"td",33),a(70,"input",35),t()(),n(71,"tr")(72,"td",32),o(73,"Mobilier de bureau"),t(),n(74,"td",33),a(75,"p-inputNumber",34),t(),n(76,"td",33),a(77,"p-inputNumber",34),t(),n(78,"td",33),a(79,"input",35),t()(),n(80,"tr")(81,"td",32),o(82,"Mat\xE9riel informatique"),t(),n(83,"td",33),a(84,"p-inputNumber",34),t(),n(85,"td",33),a(86,"p-inputNumber",34),t(),n(87,"td",33),a(88,"input",35),t()(),n(89,"tr")(90,"td",32),o(91,"Mat\xE9riel de transport"),t(),n(92,"td",33),a(93,"p-inputNumber",34),t(),n(94,"td",33),a(95,"p-inputNumber",34),t(),n(96,"td",33),a(97,"input",35),t()(),n(98,"tr")(99,"td",32),o(100,"Autres immobilisations"),t(),n(101,"td",33),a(102,"p-inputNumber",34),t(),n(103,"td",33),a(104,"p-inputNumber",34),t(),n(105,"td",33),a(106,"input",35),t()(),n(107,"tr")(108,"td",28),o(109,"Stocks"),t(),n(110,"td",33),a(111,"p-inputNumber",34),t(),n(112,"td",33),a(113,"p-inputNumber",34),t(),n(114,"td",33),a(115,"input",35),t()(),n(116,"tr")(117,"td",28),o(118,"Cr\xE9ances, Clients"),t(),n(119,"td",33),a(120,"p-inputNumber",34),t(),n(121,"td",33),a(122,"p-inputNumber",34),t(),n(123,"td",33),a(124,"input",35),t()(),n(125,"tr")(126,"td",28),o(127,"Tr\xE9sorerie (Caisse+Banque)"),t(),n(128,"td",33),a(129,"p-inputNumber",34),t(),n(130,"td",33),a(131,"p-inputNumber",34),t(),n(132,"td",33),a(133,"input",35),t()(),n(134,"tr",36)(135,"td",37),o(136,"TOTAL ACTIF"),t(),n(137,"td",38),o(138),c(139,"currency"),t(),n(140,"td",38),o(141),c(142,"currency"),t(),a(143,"td",31),t(),n(144,"tr"),a(145,"td",39),t(),n(146,"tr",40)(147,"td",26),o(148,"PASSIF"),t()(),n(149,"tr")(150,"td",28),o(151,"Situation nette (Capitaux propres) "),t(),n(152,"td",33),a(153,"p-inputNumber",34),t(),n(154,"td",33),a(155,"p-inputNumber",34),t(),n(156,"td",33),a(157,"input",35),t()(),n(158,"tr")(159,"td",28),o(160,"Emprunt \xE0 plus d'un an"),t(),n(161,"td",33),a(162,"p-inputNumber",34),t(),n(163,"td",33),a(164,"p-inputNumber",34),t(),n(165,"td",33),a(166,"input",35),t()(),n(167,"tr")(168,"td",28),o(169,"Emprunt \xE0 moins d'un an"),t(),n(170,"td",33),a(171,"p-inputNumber",34),t(),n(172,"td",33),a(173,"p-inputNumber",34),t(),n(174,"td",33),a(175,"input",35),t()(),n(176,"tr")(177,"td",28),o(178,"Autres dettes"),t(),n(179,"td",33),a(180,"p-inputNumber",34),t(),n(181,"td",33),a(182,"p-inputNumber",34),t(),n(183,"td",33),a(184,"input",35),t()(),n(185,"tr",36)(186,"td",37),o(187,"TOTAL BILAN"),t(),n(188,"td",38),o(189),c(190,"currency"),t(),n(191,"td",38),o(192),c(193,"currency"),t(),a(194,"td",31),t(),n(195,"tr"),a(196,"td",39),t(),n(197,"tr",41)(198,"td",28),o(199,"Fonds de roulement"),t(),n(200,"td",42),o(201),c(202,"currency"),t(),n(203,"td",42),o(204),c(205,"currency"),t(),n(206,"td",43),o(207,"= CP + DLT - Immo"),t()(),n(208,"tr",41)(209,"td",28),o(210,"Besoin en fonds de roulement"),t(),n(211,"td",30),o(212),c(213,"currency"),t(),n(214,"td",30),o(215),c(216,"currency"),t(),n(217,"td",43),o(218,"= Stocks + Cr\xE9ances - DCT"),t()(),n(219,"tr",41)(220,"td",28),o(221,"Tr\xE9sorerie nette"),t(),n(222,"td",42),o(223),c(224,"currency"),t(),n(225,"td",42),o(226),c(227,"currency"),t(),n(228,"td",43),o(229,"= FR - BFR"),t()()()()(),C(230,we,2,2,"ng-template",44),t()()),m&2){let e=h();r(29),d(" ",g(30,76,v(148,f,e.totalActifImmobiliseN()))," "),r(3),d(" ",g(33,82,v(150,f,e.totalActifImmobiliseN1()))," "),r(7),s("formControl",e.getControl(e.bilanNForm,"terrains"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"terrains"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"constructions"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"constructions"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"installationsTechniques"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"installationsTechniques"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"autresImmobilisations"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"autresImmobilisations"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"materielBureau"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"materielBureau"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"immobilisationsFinancieres"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"immobilisationsFinancieres"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"materielTransport"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"materielTransport"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"immobilisationsEnCours"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"immobilisationsEnCours"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"stocks"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"stocks"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"creances"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"creances"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"tresorerieActif"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"tresorerieActif"))("useGrouping",!0),r(7),d(" ",g(139,88,v(152,f,e.totalActifN()))," "),r(3),d(" ",g(142,94,v(154,f,e.totalActifN1()))," "),r(12),s("formControl",e.getControl(e.bilanNForm,"capitauxPropre"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"capitauxPropre"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"dettesLongTerme"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"dettesLongTerme"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"dettesCourtTerme"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"dettesCourtTerme"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.bilanNForm,"tresoreriePassif"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.bilanN1Form,"tresoreriePassif"))("useGrouping",!0),r(7),d(" ",g(190,100,v(156,f,e.totalPassifN()))," "),r(3),d(" ",g(193,106,v(158,f,e.totalPassifN1()))," "),r(8),s("ngClass",e.fondsRoulementN()>=0?"text-green-700":"text-red-700"),r(),d(" ",g(202,112,v(160,f,e.fondsRoulementN()))," "),r(2),s("ngClass",e.fondsRoulementN1()>=0?"text-green-700":"text-red-700"),r(),d(" ",g(205,118,v(162,f,e.fondsRoulementN1()))," "),r(8),d(" ",g(213,124,v(164,f,e.besoinFondsRoulementN()))," "),r(3),d(" ",g(216,130,v(166,f,e.besoinFondsRoulementN1()))," "),r(7),s("ngClass",e.tresorerieNetteN()>=0?"text-green-700":"text-red-700"),r(),d(" ",g(224,136,v(168,f,e.tresorerieNetteN()))," "),r(2),s("ngClass",e.tresorerieNetteN1()>=0?"text-green-700":"text-red-700"),r(),d(" ",g(227,142,v(170,f,e.tresorerieNetteN1()))," ")}}function ke(m,i){m&1&&(n(0,"div",45)(1,"h2",46),o(2,"RENTABILIT\xC9 DE L'ACTIVIT\xC9"),t(),n(3,"span",47),o(4,"en GNF"),t()())}function Le(m,i){if(m&1){let e=B();n(0,"div",48)(1,"button",68),F("click",function(){I(e);let p=h(2);return _(p.saveRentabiliteAll())}),t()()}if(m&2){let e=h(2);r(),s("loading",e.savingRentabilite())("disabled",!e.state().analyseExiste)}}function qe(m,i){if(m&1&&(n(0,"div")(1,"p-card"),C(2,ke,5,0,"ng-template",16),n(3,"div",17)(4,"table",18)(5,"thead")(6,"tr",19)(7,"th",50),o(8,"Rentabilit\xE9 de l'activit\xE9"),t(),n(9,"th",51),o(10," \xC9valuation actuelle"),a(11,"br"),n(12,"small",22),o(13,"Montant (N)"),t()(),n(14,"th",52),o(15," \xC9valuation pr\xE9c\xE9dente"),a(16,"br"),n(17,"small",22),o(18,"Montant (N-1)"),t()(),n(19,"th",53),o(20," Analyse du Projet"),a(21,"br"),n(22,"small",22),o(23,"Montant (N+1)"),t()(),n(24,"th",54),o(25,"Obs."),t()()(),n(26,"tbody")(27,"tr",55)(28,"td",37),o(29,"Chiffre d'affaires"),t(),n(30,"td",33),a(31,"p-inputNumber",34),t(),n(32,"td",33),a(33,"p-inputNumber",34),t(),n(34,"td",33),a(35,"p-inputNumber",34),t(),n(36,"td",56),o(37,"Hyp. Moy."),t()(),n(38,"tr")(39,"td",31),o(40,"Co\xFBt d'achats des marchandises vendues"),t(),n(41,"td",33),a(42,"p-inputNumber",34),t(),n(43,"td",33),a(44,"p-inputNumber",34),t(),n(45,"td",33),a(46,"p-inputNumber",34),t(),a(47,"td",33),t(),n(48,"tr",36)(49,"td",37),o(50," Marge brute "),n(51,"span",57),o(52),c(53,"number"),t()(),n(54,"td",38),o(55),c(56,"currency"),t(),n(57,"td",38),o(58),c(59,"currency"),t(),n(60,"td",38),o(61),c(62,"currency"),t(),n(63,"td",43),o(64,"% Recom."),t()(),n(65,"tr",58)(66,"td",59),o(67,"Autres charges"),t()(),n(68,"tr")(69,"td",60),o(70,"Salaires"),t(),n(71,"td",33),a(72,"p-inputNumber",34),t(),n(73,"td",33),a(74,"p-inputNumber",34),t(),n(75,"td",33),a(76,"p-inputNumber",34),t(),a(77,"td",33),t(),n(78,"tr")(79,"td",60),o(80,"Pr\xE9l\xE8vement de l'entrepreneur"),t(),n(81,"td",33),a(82,"p-inputNumber",34),t(),n(83,"td",33),a(84,"p-inputNumber",34),t(),n(85,"td",33),a(86,"p-inputNumber",34),t(),a(87,"td",33),t(),n(88,"tr")(89,"td",60),o(90,"Loyers"),t(),n(91,"td",33),a(92,"p-inputNumber",34),t(),n(93,"td",33),a(94,"p-inputNumber",34),t(),n(95,"td",33),a(96,"p-inputNumber",34),t(),a(97,"td",33),t(),n(98,"tr")(99,"td",60),o(100,"Transport"),t(),n(101,"td",33),a(102,"p-inputNumber",34),t(),n(103,"td",33),a(104,"p-inputNumber",34),t(),n(105,"td",33),a(106,"p-inputNumber",34),t(),a(107,"td",33),t(),n(108,"tr")(109,"td",60),o(110,"\xC9lectricit\xE9, eau, t\xE9l\xE9phone"),t(),n(111,"td",33),a(112,"p-inputNumber",34),t(),n(113,"td",33),a(114,"p-inputNumber",34),t(),n(115,"td",33),a(116,"p-inputNumber",34),t(),a(117,"td",33),t(),n(118,"tr")(119,"td",60),o(120,"Fournitures et autres besoins"),t(),n(121,"td",33),a(122,"p-inputNumber",34),t(),n(123,"td",33),a(124,"p-inputNumber",34),t(),n(125,"td",33),a(126,"p-inputNumber",34),t(),a(127,"td",33),t(),n(128,"tr")(129,"td",60),o(130,"Entretien et r\xE9paration"),t(),n(131,"td",33),a(132,"p-inputNumber",34),t(),n(133,"td",33),a(134,"p-inputNumber",34),t(),n(135,"td",33),a(136,"p-inputNumber",34),t(),a(137,"td",33),t(),n(138,"tr")(139,"td",60),o(140,"Carburant et lubrifiants"),t(),n(141,"td",33),a(142,"p-inputNumber",34),t(),n(143,"td",33),a(144,"p-inputNumber",34),t(),n(145,"td",33),a(146,"p-inputNumber",34),t(),a(147,"td",33),t(),n(148,"tr")(149,"td",60),o(150,"Frais de publicit\xE9 et promotion"),t(),n(151,"td",33),a(152,"p-inputNumber",34),t(),n(153,"td",33),a(154,"p-inputNumber",34),t(),n(155,"td",33),a(156,"p-inputNumber",34),t(),a(157,"td",33),t(),n(158,"tr")(159,"td",60),o(160,"Redevance, imp\xF4ts et taxes"),t(),n(161,"td",33),a(162,"p-inputNumber",34),t(),n(163,"td",33),a(164,"p-inputNumber",34),t(),n(165,"td",33),a(166,"p-inputNumber",34),t(),a(167,"td",33),t(),n(168,"tr")(169,"td",60),o(170,"Frais bancaires, Int\xE9r\xEAts pay\xE9s"),t(),n(171,"td",33),a(172,"p-inputNumber",34),t(),n(173,"td",33),a(174,"p-inputNumber",34),t(),n(175,"td",33),a(176,"p-inputNumber",34),t(),a(177,"td",33),t(),n(178,"tr")(179,"td",60),o(180,"\xC9ch\xE9ance autre cr\xE9dit"),t(),n(181,"td",33),a(182,"p-inputNumber",34),t(),n(183,"td",33),a(184,"p-inputNumber",34),t(),n(185,"td",33),a(186,"p-inputNumber",34),t(),a(187,"td",33),t(),n(188,"tr")(189,"td",60),o(190,"Diverses charges"),t(),n(191,"td",33),a(192,"p-inputNumber",34),t(),n(193,"td",33),a(194,"p-inputNumber",34),t(),n(195,"td",33),a(196,"p-inputNumber",34),t(),a(197,"td",33),t(),n(198,"tr",61)(199,"td",37),o(200,"Total autres charges d'exploitation"),t(),n(201,"td",62),o(202),c(203,"currency"),t(),n(204,"td",62),o(205),c(206,"currency"),t(),n(207,"td",62),o(208),c(209,"currency"),t(),n(210,"td",43),o(211,"Auto."),t()(),n(212,"tr",63)(213,"td",64),o(214,"Amortissements et Provisions"),t(),n(215,"td",33),a(216,"p-inputNumber",34),t(),n(217,"td",33),a(218,"p-inputNumber",34),t(),n(219,"td",33),a(220,"p-inputNumber",34),t(),a(221,"td",33),t(),n(222,"tr",25)(223,"td",37),o(224,"R\xE9sultat d'exploitation de l'activit\xE9"),t(),n(225,"td",42),o(226),c(227,"currency"),t(),n(228,"td",42),o(229),c(230,"currency"),t(),n(231,"td",42),o(232),c(233,"currency"),t(),n(234,"td",43),o(235,"MB - Charges - Amort."),t()(),n(236,"tr"),a(237,"td",65),t(),n(238,"tr",40)(239,"td",37),o(240,"Cash-flow (Exc\xE9dent de tr\xE9sorerie)"),t(),n(241,"td",66),o(242),c(243,"currency"),t(),n(244,"td",66),o(245),c(246,"currency"),t(),n(247,"td",66),o(248),c(249,"currency"),t(),n(250,"td",43),o(251,"R\xE9sultat + Amort."),t()(),n(252,"tr"),a(253,"td",65),t(),n(254,"tr")(255,"td",28),o(256,"Autres revenus net hors activit\xE9"),t(),n(257,"td",33),a(258,"p-inputNumber",34),t(),n(259,"td",33),a(260,"p-inputNumber",34),t(),n(261,"td",33),a(262,"p-inputNumber",34),t(),a(263,"td",33),t(),n(264,"tr"),a(265,"td",65),t(),n(266,"tr",67)(267,"td",37),o(268,"Capacit\xE9 de remboursement calcul\xE9e"),t(),n(269,"td",42),o(270),c(271,"currency"),t(),n(272,"td",42),o(273),c(274,"currency"),t(),n(275,"td",42),o(276),c(277,"currency"),t(),n(278,"td",43),o(279,"CF + Autres rev."),t()()()()(),C(280,Le,2,2,"ng-template",44),t()()),m&2){let e=h();r(31),s("formControl",e.getControl(e.rentabiliteNForm,"chiffreAffaires"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"chiffreAffaires"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"chiffreAffaires"))("useGrouping",!0),r(7),s("formControl",e.getControl(e.rentabiliteNForm,"coutAchatMarchandises"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"coutAchatMarchandises"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"coutAchatMarchandises"))("useGrouping",!0),r(6),d(" (",M(53,124,e.tauxMargeBruteN(),"1.0-0"),"%) "),r(3),d(" ",g(56,127,v(217,f,e.margeBruteN()))," "),r(3),d(" ",g(59,133,v(219,f,e.margeBruteN1()))," "),r(3),d(" ",g(62,139,v(221,f,e.margeBruteN2()))," "),r(11),s("formControl",e.getControl(e.rentabiliteNForm,"salaires"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"salaires"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"salaires"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"prelevementEntrepreneur"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"prelevementEntrepreneur"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"prelevementEntrepreneur"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"loyers"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"loyers"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"loyers"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"transport"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"transport"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"transport"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"electriciteEauTelephone"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"electriciteEauTelephone"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"electriciteEauTelephone"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"fournituresAutresBesoins"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"fournituresAutresBesoins"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"fournituresAutresBesoins"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"entretienReparation"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"entretienReparation"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"entretienReparation"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"carburantLubrifiants"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"carburantLubrifiants"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"carburantLubrifiants"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"publicitePromotion"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"publicitePromotion"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"publicitePromotion"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"impotsTaxes"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"impotsTaxes"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"impotsTaxes"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"fraisBancairesInterets"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"fraisBancairesInterets"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"fraisBancairesInterets"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"echeanceAutreCredit"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"echeanceAutreCredit"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"echeanceAutreCredit"))("useGrouping",!0),r(6),s("formControl",e.getControl(e.rentabiliteNForm,"diversesCharges"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"diversesCharges"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"diversesCharges"))("useGrouping",!0),r(6),d(" ",g(203,145,v(223,f,e.totalChargesN()))," "),r(3),d(" ",g(206,151,v(225,f,e.totalChargesN1()))," "),r(3),d(" ",g(209,157,v(227,f,e.totalChargesN2()))," "),r(8),s("formControl",e.getControl(e.rentabiliteNForm,"amortissementsProvisions"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"amortissementsProvisions"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"amortissementsProvisions"))("useGrouping",!0),r(5),s("ngClass",e.resultatExploitationN()>=0?"text-green-700":"text-red-700"),r(),d(" ",g(227,163,v(229,f,e.resultatExploitationN()))," "),r(2),s("ngClass",e.resultatExploitationN1()>=0?"text-green-700":"text-red-700"),r(),d(" ",g(230,169,v(231,f,e.resultatExploitationN1()))," "),r(2),s("ngClass",e.resultatExploitationN2()>=0?"text-green-700":"text-red-700"),r(),d(" ",g(233,175,v(233,f,e.resultatExploitationN2()))," "),r(10),d(" ",g(243,181,v(235,f,e.cashFlowN()))," "),r(3),d(" ",g(246,187,v(237,f,e.cashFlowN1()))," "),r(3),d(" ",g(249,193,v(239,f,e.cashFlowN2()))," "),r(10),s("formControl",e.getControl(e.rentabiliteNForm,"autresRevenusHorsActivite"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN1Form,"autresRevenusHorsActivite"))("useGrouping",!0),r(2),s("formControl",e.getControl(e.rentabiliteN2Form,"autresRevenusHorsActivite"))("useGrouping",!0),r(7),s("ngClass",e.resultatNetN()>=0?"text-green-800":"text-red-700"),r(),d(" ",g(271,199,v(241,f,e.resultatNetN()))," "),r(2),s("ngClass",e.resultatNetN1()>=0?"text-green-800":"text-red-700"),r(),d(" ",g(274,205,v(243,f,e.resultatNetN1()))," "),r(2),s("ngClass",e.resultatNetN2()>=0?"text-green-800":"text-red-700"),r(),d(" ",g(277,211,v(245,f,e.resultatNetN2()))," ")}}function $e(m,i){if(m&1){let e=B();n(0,"div",88)(1,"span",89),o(2),t(),n(3,"button",90),F("click",function(){I(e);let p=h().index,b=h(3);return _(b.removePersonnecaution(p))}),t()()}if(m&2){let e=h().$implicit;r(2),D("",e.prenom," ",e.nom,"")}}function Ue(m,i){if(m&1&&(n(0,"div",91)(1,"strong"),o(2,"T\xE9l\xE9phone:"),t(),o(3),t()),m&2){let e=h().$implicit;r(3),d(" ",e.telephone," ")}}function Oe(m,i){if(m&1&&(n(0,"div",91)(1,"strong"),o(2,"\xC2ge:"),t(),o(3),t()),m&2){let e=h().$implicit;r(3),d(" ",e.age," ans ")}}function He(m,i){if(m&1&&(n(0,"div",91)(1,"strong"),o(2,"Activit\xE9:"),t(),o(3),t()),m&2){let e=h().$implicit;r(3),d(" ",e.activite," ")}}function ze(m,i){if(m&1&&(n(0,"div",91)(1,"strong"),o(2,"Profession:"),t(),o(3),t()),m&2){let e=h().$implicit;r(3),d(" ",e.profession," ")}}function Qe(m,i){if(m&1&&(n(0,"div",75)(1,"p-card"),C(2,$e,4,2,"ng-template",16),n(3,"div",86),C(4,Ue,4,1,"div",87)(5,Oe,4,1,"div",87)(6,He,4,1,"div",87)(7,ze,4,1,"div",87),t()()()),m&2){let e=i.$implicit;r(4),s("ngIf",e.telephone),r(),s("ngIf",e.age),r(),s("ngIf",e.activite),r(),s("ngIf",e.profession)}}function We(m,i){if(m&1&&(n(0,"div",71)(1,"h3",72),o(2),t(),n(3,"div",70),C(4,Qe,8,4,"div",85),t()()),m&2){let e=h(2);r(2),d(" Personnes caution ajout\xE9es (",e.personnecautions.length,") "),r(2),s("ngForOf",e.personnecautions)}}function Xe(m,i){m&1&&(n(0,"div",71)(1,"div",92),a(2,"i",11),n(3,"span"),o(4,"Aucune personne caution ajout\xE9e."),t()()())}function Je(m,i){if(m&1){let e=B();n(0,"div")(1,"p-card",69)(2,"div",70)(3,"div",71)(4,"h3",72),o(5," Ajouter une personne caution "),t(),n(6,"p",73),o(7," Les personnes caution sont optionnelles mais peuvent renforcer le dossier. "),t()(),n(8,"div",71)(9,"form",74)(10,"div",70)(11,"div",75)(12,"label",76),o(13,"Nom"),t(),a(14,"input",77),t(),n(15,"div",75)(16,"label",76),o(17,"Pr\xE9nom"),t(),a(18,"input",78),t(),n(19,"div",75)(20,"label",76),o(21,"T\xE9l\xE9phone"),t(),a(22,"input",79),t(),n(23,"div",75)(24,"label",76),o(25,"\xC2ge"),t(),a(26,"p-inputNumber",80),t(),n(27,"div",75)(28,"label",76),o(29,"Activit\xE9"),t(),a(30,"input",81),t(),n(31,"div",75)(32,"label",76),o(33,"Profession"),t(),a(34,"input",82),t(),n(35,"div",71)(36,"button",83),F("click",function(){I(e);let p=h();return _(p.addPersonnecaution())}),t()()()()(),C(37,We,5,2,"div",84)(38,Xe,5,0,"div",84),t()()()}if(m&2){let e=h();r(9),s("formGroup",e.personnecautionForm),r(17),s("showButtons",!0)("min",18)("max",100),r(11),s("ngIf",e.personnecautions.length>0),r(),s("ngIf",e.personnecautions.length===0)}}function Ke(m,i){if(m&1&&(n(0,"span",116),o(1),t()),m&2){let e=h().$implicit;r(),d("- ",e.profession,"")}}function Ye(m,i){if(m&1&&(n(0,"div",75)(1,"div",114)(2,"strong"),o(3),t(),C(4,Ke,2,1,"span",115),t()()),m&2){let e=i.$implicit;r(3),D("",e.prenom," ",e.nom,""),r(),s("ngIf",e.profession)}}function Ze(m,i){if(m&1&&(n(0,"div",86),C(1,Ye,5,3,"div",85),t()),m&2){let e=h(2);r(),s("ngForOf",e.personnecautions)}}function et(m,i){m&1&&(n(0,"div",112),a(1,"i",11),o(2,"Aucune personne caution ajout\xE9e "),t())}function tt(m,i){if(m&1){let e=B();n(0,"div",117)(1,"button",118),F("click",function(){I(e);let p=h(2);return _(p.submitAnalyse())}),t()()}if(m&2){let e=h(2);r(),s("loading",e.loading())("disabled",!e.state().analyseExiste)}}function it(m,i){if(m&1&&(n(0,"div")(1,"p-card",93)(2,"div",86)(3,"div",71)(4,"h3",94),a(5,"i",95),o(6,"R\xE9capitulatif de la demande "),t()(),n(7,"div",96)(8,"div",97)(9,"span",98),o(10,"Montant sollicit\xE9"),t(),n(11,"strong",99),o(12),c(13,"currency"),t()()(),n(14,"div",96)(15,"div",97)(16,"span",98),o(17,"Dur\xE9e sollicit\xE9e"),t(),n(18,"strong",99),o(19),t()()(),n(20,"div",96)(21,"div",100)(22,"span",98),o(23,"Besoin Investissement"),t(),n(24,"strong",101),o(25),c(26,"currency"),t()()(),n(27,"div",96)(28,"div",102)(29,"span",98),o(30,"Besoin Exploitation"),t(),n(31,"strong",103),o(32),c(33,"currency"),t()()(),n(34,"div",104)(35,"div",105)(36,"span",106),o(37,"Besoin Total de Financement (effectif)"),t(),n(38,"strong",107),o(39),c(40,"currency"),t()()(),n(41,"div",108)(42,"h3",72),a(43,"i",109),o(44),t(),C(45,Ze,2,1,"div",110)(46,et,3,0,"div",111),t(),n(47,"div",108)(48,"div",112),a(49,"i",113),n(50,"span"),o(51,"En soumettant cette analyse, le dossier sera transf\xE9r\xE9 au comit\xE9 de cr\xE9dit pour examen."),t()()()(),C(52,tt,2,2,"ng-template",44),t()()),m&2){let e,l,p=h();r(12),R(g(13,8,v(32,f,(e=p.state().demandeIndividuel)==null?null:e.montantDemande))),r(7),d("",(l=p.state().demandeIndividuel)==null?null:l.dureeDemande," mois"),r(6),R(g(26,14,v(34,f,p.besoinReelInvestissementFinal()))),r(7),R(g(33,20,v(36,f,p.besoinReelExploitationFinal()))),r(7),R(g(40,26,v(38,f,p.besoinTotalFinancementFinal()))),r(5),d("Personnes caution (",p.personnecautions.length,") "),r(),s("ngIf",p.personnecautions.length>0),r(),s("ngIf",p.personnecautions.length===0)}}function nt(m,i){m&1&&(n(0,"div",45)(1,"h2",46),o(2,"BESOIN EN CR\xC9DIT"),t(),n(3,"span",47),o(4,"en GNF"),t()())}function rt(m,i){if(m&1){let e=B();n(0,"div",48)(1,"button",182),F("click",function(){I(e);let p=h(2);return _(p.saveBesoinCredit())}),t()()}if(m&2){let e=h(2);r(),s("loading",e.savingBesoinCredit())("disabled",!e.state().analyseExiste)}}function ot(m,i){if(m&1&&(n(0,"div")(1,"p-card"),C(2,nt,5,0,"ng-template",16),n(3,"form",119)(4,"div",17)(5,"table",18)(6,"thead")(7,"tr",19)(8,"th",50),o(9,"D\xE9signation "),t(),n(10,"th",120),o(11," Montant"),t(),n(12,"th",121),o(13," Ajustement"),t(),n(14,"th",122),o(15," Montant effectif"),t()()(),n(16,"tbody")(17,"tr",25)(18,"td",26),a(19,"i",123),o(20,"INVESTISSEMENT "),t()(),n(21,"tr")(22,"td",60),o(23,"Co\xFBt de l'\xE9quipement"),t(),n(24,"td",33),a(25,"p-inputNumber",124),t(),n(26,"td",125),a(27,"p-inputNumber",126),t(),n(28,"td",127),o(29),c(30,"currency"),t()(),n(31,"tr")(32,"td",60),o(33,"D\xE9penses rattach\xE9es"),t(),n(34,"td",33),a(35,"p-inputNumber",128),t(),n(36,"td",125),a(37,"p-inputNumber",129),t(),n(38,"td",127),o(39),c(40,"currency"),t()(),n(41,"tr",55)(42,"td",130),o(43,"Total Investissement"),t(),n(44,"td",131),o(45),c(46,"currency"),t(),n(47,"td",132),o(48),c(49,"currency"),t(),n(50,"td",133),o(51),c(52,"currency"),t()(),n(53,"tr")(54,"td",134),o(55,"(-) Apport personnel "),t(),n(56,"td",33),a(57,"p-inputNumber",135),t(),n(58,"td",125),a(59,"p-inputNumber",136),t(),n(60,"td",137),o(61),c(62,"currency"),t()(),n(63,"tr",138)(64,"td",37),o(65,"= BESOIN R\xC9EL INVESTISSEMENT"),t(),n(66,"td",139),o(67),c(68,"currency"),t(),n(69,"td",140),o(70),c(71,"currency"),t(),n(72,"td",141),o(73),c(74,"currency"),t()(),n(75,"tr"),a(76,"td",39),t(),n(77,"tr",40)(78,"td",26),a(79,"i",142),o(80,"EXPLOITATION "),t()(),n(81,"tr")(82,"td",60),o(83,"Co\xFBt d'achat du cycle"),t(),n(84,"td",33),a(85,"p-inputNumber",143),t(),n(86,"td",125),a(87,"p-inputNumber",144),t(),n(88,"td",127),o(89),c(90,"currency"),t()(),n(91,"tr")(92,"td",60),o(93,"Nombre de cycles \xE0 financer"),t(),n(94,"td",145),a(95,"p-inputNumber",146),t(),n(96,"td",147),o(97),t()(),n(98,"tr",148)(99,"td",130),o(100,"Besoin brut (Co\xFBt \xD7 Cycles)"),t(),n(101,"td",66),o(102),c(103,"currency"),t(),n(104,"td",132),o(105),c(106,"currency"),t(),n(107,"td",133),o(108),c(109,"currency"),t()(),n(110,"tr",27)(111,"td",149),o(112," (-) Ressources disponibles "),t()(),n(113,"tr")(114,"td",150),o(115,"Tr\xE9sorerie disponible"),t(),n(116,"td",33),a(117,"p-inputNumber",151),t(),n(118,"td",125),a(119,"p-inputNumber",152),t(),n(120,"td",127),o(121),c(122,"currency"),t()(),n(123,"tr")(124,"td",150),o(125,"Stock actuel"),t(),n(126,"td",33),a(127,"p-inputNumber",153),t(),n(128,"td",125),a(129,"p-inputNumber",154),t(),n(130,"td",127),o(131),c(132,"currency"),t()(),n(133,"tr")(134,"td",150),o(135,"Comptes \xE0 recevoir"),t(),n(136,"td",33),a(137,"p-inputNumber",155),t(),n(138,"td",125),a(139,"p-inputNumber",156),t(),n(140,"td",127),o(141),c(142,"currency"),t()(),n(143,"tr",157)(144,"td",158),o(145,"Total ressources disponibles"),t(),n(146,"td",38),o(147),c(148,"currency"),t(),n(149,"td",132),o(150),c(151,"currency"),t(),n(152,"td",159),o(153),c(154,"currency"),t()(),n(155,"tr",27)(156,"td",160),o(157," (+) Dettes \xE0 payer "),t()(),n(158,"tr")(159,"td",150),o(160,"Dettes fournisseurs"),t(),n(161,"td",33),a(162,"p-inputNumber",161),t(),n(163,"td",125),a(164,"p-inputNumber",162),t(),n(165,"td",127),o(166),c(167,"currency"),t()(),n(168,"tr")(169,"td",150),o(170,"Cr\xE9dit fournisseur"),t(),n(171,"td",33),a(172,"p-inputNumber",163),t(),n(173,"td",125),a(174,"p-inputNumber",164),t(),n(175,"td",127),o(176),c(177,"currency"),t()(),n(178,"tr",58)(179,"td",165),o(180,"Total dettes \xE0 payer"),t(),n(181,"td",62),o(182),c(183,"currency"),t(),n(184,"td",132),o(185),c(186,"currency"),t(),n(187,"td",166),o(188),c(189,"currency"),t()(),n(190,"tr",167)(191,"td",37),o(192,"= BESOIN R\xC9EL EXPLOITATION"),t(),n(193,"td",168),o(194),c(195,"currency"),t(),n(196,"td",140),o(197),c(198,"currency"),t(),n(199,"td",141),o(200),c(201,"currency"),t()(),n(202,"tr"),a(203,"td",169),t(),n(204,"tr",170)(205,"td",171),a(206,"i",172),o(207,"BESOIN TOTAL DE FINANCEMENT "),t(),n(208,"td",173),o(209),c(210,"currency"),t(),n(211,"td",174),o(212),c(213,"currency"),t(),n(214,"td",175),o(215),c(216,"currency"),t()()()()(),n(217,"div",176)(218,"div",177)(219,"div",178)(220,"span",98),o(221,"Besoin Investissement"),t(),n(222,"strong",99),o(223),c(224,"currency"),t()()(),n(225,"div",177)(226,"div",179)(227,"span",98),o(228,"Besoin Exploitation"),t(),n(229,"strong",103),o(230),c(231,"currency"),t()()(),n(232,"div",177)(233,"div",180)(234,"span",98),o(235,"Total Financement (effectif)"),t(),n(236,"strong",181),o(237),c(238,"currency"),t()()()()(),C(239,rt,2,2,"ng-template",44),t()()),m&2){let e=h();r(3),s("formGroup",e.besoinCreditForm),r(22),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(30,56,v(254,f,e.effCoutEquipement()))," "),r(6),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(40,62,v(256,f,e.effDepensesRattachees()))," "),r(6),d(" ",g(46,68,v(258,f,e.totalInvestissementMontant()))," "),r(3),d(" ",g(49,74,v(260,f,e.totalInvestissementAjuste()))," "),r(3),d(" ",g(52,80,v(262,f,e.totalInvestissementEffectif()))," "),r(6),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(62,86,v(264,f,e.effApportPersonnel()))," "),r(6),d(" ",g(68,92,v(266,f,e.besoinReelInvestissementMontant()))," "),r(3),d(" ",g(71,98,v(268,f,e.besoinReelInvestissementAjuste()))," "),r(3),d(" ",g(74,104,v(270,f,e.besoinReelInvestissementFinal()))," "),r(12),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(90,110,v(272,f,e.effCoutAchatCycle()))," "),r(6),s("showButtons",!0)("min",1)("max",12),r(2),d(" ",e.exploitationNbreCycles()," "),r(5),d(" ",g(103,116,v(274,f,e.besoinBrutExploitationMontant()))," "),r(3),d(" ",g(106,122,v(276,f,e.besoinBrutExploitationAjuste()))," "),r(3),d(" ",g(109,128,v(278,f,e.besoinBrutExploitationEffectif()))," "),r(9),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(122,134,v(280,f,e.effTresorerieDispo()))," "),r(6),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(132,140,v(282,f,e.effStockActuel()))," "),r(6),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(142,146,v(284,f,e.effComptesRecevoir()))," "),r(6),d(" ",g(148,152,v(286,f,e.ressourcesDisponiblesMontant()))," "),r(3),d(" ",g(151,158,v(288,f,e.ressourcesDisponiblesAjuste()))," "),r(3),d(" ",g(154,164,v(290,f,e.ressourcesDisponiblesEffectif()))," "),r(9),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(167,170,v(292,f,e.effDettesFournisseurs()))," "),r(6),s("useGrouping",!0),r(2),s("useGrouping",!0),r(2),d(" ",g(177,176,v(294,f,e.effCreditFournisseur()))," "),r(6),d(" ",g(183,182,v(296,f,e.totalDettesMontant()))," "),r(3),d(" ",g(186,188,v(298,f,e.totalDettesAjuste()))," "),r(3),d(" ",g(189,194,v(300,f,e.totalDettesEffectif()))," "),r(6),d(" ",g(195,200,v(302,f,e.besoinReelExploitationMontant()))," "),r(3),d(" ",g(198,206,v(304,f,e.besoinReelExploitationAjuste()))," "),r(3),d(" ",g(201,212,v(306,f,e.besoinReelExploitationFinal()))," "),r(9),d(" ",g(210,218,v(308,f,e.besoinTotalFinancementMontant()))," "),r(3),d(" ",g(213,224,v(310,f,e.besoinTotalFinancementAjuste()))," "),r(3),d(" ",g(216,230,v(312,f,e.besoinTotalFinancementFinal()))," "),r(8),R(g(224,236,v(314,f,e.besoinReelInvestissementFinal()))),r(7),R(g(231,242,v(316,f,e.besoinReelExploitationFinal()))),r(7),R(g(238,248,v(318,f,e.besoinTotalFinancementFinal())))}}L(Pe,"fr-FR");var De=class m{fb=A(re);router=A(X);messageService=A(G);destroyRef=A(V);userService=A(ge);http=A(Q);route=A(W);apiUrl=ve.apiBaseUrl;state=S({loading:!1,allDelegations:[],allAgences:[],allPointsVente:[],filteredAgences:[],filteredPointsVente:[],demandeIndividuel:null,userId:null,analyseId:null,analyseExiste:!1});activeIndex=S(0);items=S([]);loading=S(!1);savingBilan=S(!1);savingRentabilite=S(!1);savingBesoinCredit=S(!1);calculatingRatios=S(!1);bilanNForm;bilanN1Form;rentabiliteNForm;rentabiliteN1Form;rentabiliteN2Form;besoinCreditForm;propositionForm;demandeCreditForm;personnecautionForm;ratiosData=S([]);formChangeCounter=S(0);personnecautions=[];demandeIndividuelId=null;periodicites=[{label:"Mensuelle",value:"MENSUELLE",facteur:1},{label:"Bimestrielle",value:"BIMESTRIELLE",facteur:2},{label:"Trimestrielle",value:"TRIMESTRIELLE",facteur:3},{label:"Quadrimestrielle",value:"QUADRIMESTRIELLE",facteur:4},{label:"Semestrielle",value:"SEMESTRIELLE",facteur:6},{label:"Annuelle",value:"ANNUELLE",facteur:12},{label:"Unique",value:"UNIQUE",facteur:1}];totalActifImmobiliseN=u(()=>{this.formChangeCounter();let i=this.bilanNForm;return i?(i.get("terrains")?.value||0)+(i.get("constructions")?.value||0)+(i.get("installationsTechniques")?.value||0)+(i.get("materielTransport")?.value||0)+(i.get("materielBureau")?.value||0)+(i.get("autresImmobilisations")?.value||0)+(i.get("immobilisationsEnCours")?.value||0)+(i.get("immobilisationsFinancieres")?.value||0):0});totalActifCirculantN=u(()=>{this.formChangeCounter();let i=this.bilanNForm;return i?(i.get("stocks")?.value||0)+(i.get("creances")?.value||0)+(i.get("tresorerieActif")?.value||0):0});totalActifN=u(()=>(this.formChangeCounter(),this.totalActifImmobiliseN()+this.totalActifCirculantN()));totalBilanN=u(()=>(this.formChangeCounter(),this.totalActifN()));capitauxPropresN=u(()=>{this.formChangeCounter();let i=this.bilanNForm?.get("capitauxPropre")?.value||0;if(i>0)return i;let e=(this.bilanNForm?.get("dettesLongTerme")?.value||0)+(this.bilanNForm?.get("dettesCourtTerme")?.value||0)+(this.bilanNForm?.get("tresoreriePassif")?.value||0);return this.totalActifN()-e});totalPassifN=u(()=>{this.formChangeCounter();let i=this.bilanNForm;return i?this.capitauxPropresN()+(i.get("dettesLongTerme")?.value||0)+(i.get("dettesCourtTerme")?.value||0)+(i.get("tresoreriePassif")?.value||0):0});fondsRoulementN=u(()=>(this.formChangeCounter(),this.capitauxPropresN()+(this.bilanNForm?.get("dettesLongTerme")?.value||0)-this.totalActifImmobiliseN()));besoinFondsRoulementN=u(()=>{this.formChangeCounter();let i=this.bilanNForm?.get("stocks")?.value||0,e=this.bilanNForm?.get("creances")?.value||0,l=this.bilanNForm?.get("dettesCourtTerme")?.value||0;return i+e-l});tresorerieNetteN=u(()=>(this.formChangeCounter(),this.fondsRoulementN()-this.besoinFondsRoulementN()));totalActifImmobiliseN1=u(()=>{this.formChangeCounter();let i=this.bilanN1Form;return i?(i.get("terrains")?.value||0)+(i.get("constructions")?.value||0)+(i.get("installationsTechniques")?.value||0)+(i.get("materielTransport")?.value||0)+(i.get("materielBureau")?.value||0)+(i.get("autresImmobilisations")?.value||0)+(i.get("immobilisationsEnCours")?.value||0)+(i.get("immobilisationsFinancieres")?.value||0):0});totalActifCirculantN1=u(()=>{this.formChangeCounter();let i=this.bilanN1Form;return i?(i.get("stocks")?.value||0)+(i.get("creances")?.value||0)+(i.get("tresorerieActif")?.value||0):0});totalActifN1=u(()=>(this.formChangeCounter(),this.totalActifImmobiliseN1()+this.totalActifCirculantN1()));totalBilanN1=u(()=>(this.formChangeCounter(),this.totalActifN1()));capitauxPropresN1=u(()=>{this.formChangeCounter();let i=this.bilanN1Form?.get("capitauxPropre")?.value||0;if(i>0)return i;let e=(this.bilanN1Form?.get("dettesLongTerme")?.value||0)+(this.bilanN1Form?.get("dettesCourtTerme")?.value||0)+(this.bilanN1Form?.get("tresoreriePassif")?.value||0);return this.totalActifN1()-e});totalPassifN1=u(()=>{this.formChangeCounter();let i=this.bilanN1Form;return i?this.capitauxPropresN1()+(i.get("dettesLongTerme")?.value||0)+(i.get("dettesCourtTerme")?.value||0)+(i.get("tresoreriePassif")?.value||0):0});fondsRoulementN1=u(()=>(this.formChangeCounter(),this.capitauxPropresN1()+(this.bilanN1Form?.get("dettesLongTerme")?.value||0)-this.totalActifImmobiliseN1()));besoinFondsRoulementN1=u(()=>{this.formChangeCounter();let i=this.bilanN1Form?.get("stocks")?.value||0,e=this.bilanN1Form?.get("creances")?.value||0,l=this.bilanN1Form?.get("dettesCourtTerme")?.value||0;return i+e-l});tresorerieNetteN1=u(()=>(this.formChangeCounter(),this.fondsRoulementN1()-this.besoinFondsRoulementN1()));margeBruteN=u(()=>{this.formChangeCounter();let i=this.rentabiliteNForm?.get("chiffreAffaires")?.value||0,e=this.rentabiliteNForm?.get("coutAchatMarchandises")?.value||0;return i-e});totalChargesN=u(()=>{this.formChangeCounter();let i=this.rentabiliteNForm;return i?(i.get("salaires")?.value||0)+(i.get("prelevementEntrepreneur")?.value||0)+(i.get("loyers")?.value||0)+(i.get("transport")?.value||0)+(i.get("electriciteEauTelephone")?.value||0)+(i.get("fournituresAutresBesoins")?.value||0)+(i.get("entretienReparation")?.value||0)+(i.get("carburantLubrifiants")?.value||0)+(i.get("publicitePromotion")?.value||0)+(i.get("impotsTaxes")?.value||0)+(i.get("fraisBancairesInterets")?.value||0)+(i.get("echeanceAutreCredit")?.value||0)+(i.get("diversesCharges")?.value||0):0});amortissementsN=u(()=>(this.formChangeCounter(),this.rentabiliteNForm?.get("amortissementsProvisions")?.value||0));autresRevenusN=u(()=>(this.formChangeCounter(),this.rentabiliteNForm?.get("autresRevenusHorsActivite")?.value||0));resultatExploitationN=u(()=>{this.formChangeCounter();let i=this.margeBruteN(),e=this.totalChargesN(),l=this.amortissementsN();return i-e-l});cashFlowN=u(()=>(this.formChangeCounter(),this.resultatExploitationN()+this.amortissementsN()));resultatNetN=u(()=>(this.formChangeCounter(),this.cashFlowN()+this.autresRevenusN()));tauxMargeBruteN=u(()=>{this.formChangeCounter();let i=this.rentabiliteNForm?.get("chiffreAffaires")?.value||0;return i===0?0:this.margeBruteN()/i*100});margeBruteN1=u(()=>{this.formChangeCounter();let i=this.rentabiliteN1Form?.get("chiffreAffaires")?.value||0,e=this.rentabiliteN1Form?.get("coutAchatMarchandises")?.value||0;return i-e});totalChargesN1=u(()=>{this.formChangeCounter();let i=this.rentabiliteN1Form;return i?(i.get("salaires")?.value||0)+(i.get("prelevementEntrepreneur")?.value||0)+(i.get("loyers")?.value||0)+(i.get("transport")?.value||0)+(i.get("electriciteEauTelephone")?.value||0)+(i.get("fournituresAutresBesoins")?.value||0)+(i.get("entretienReparation")?.value||0)+(i.get("carburantLubrifiants")?.value||0)+(i.get("publicitePromotion")?.value||0)+(i.get("impotsTaxes")?.value||0)+(i.get("fraisBancairesInterets")?.value||0)+(i.get("echeanceAutreCredit")?.value||0)+(i.get("diversesCharges")?.value||0):0});amortissementsN1=u(()=>(this.formChangeCounter(),this.rentabiliteN1Form?.get("amortissementsProvisions")?.value||0));autresRevenusN1=u(()=>(this.formChangeCounter(),this.rentabiliteN1Form?.get("autresRevenusHorsActivite")?.value||0));resultatExploitationN1=u(()=>{this.formChangeCounter();let i=this.margeBruteN1(),e=this.totalChargesN1(),l=this.amortissementsN1();return i-e-l});cashFlowN1=u(()=>(this.formChangeCounter(),this.resultatExploitationN1()+this.amortissementsN1()));resultatNetN1=u(()=>(this.formChangeCounter(),this.cashFlowN1()+this.autresRevenusN1()));margeBruteN2=u(()=>{this.formChangeCounter();let i=this.rentabiliteN2Form?.get("chiffreAffaires")?.value||0,e=this.rentabiliteN2Form?.get("coutAchatMarchandises")?.value||0;return i-e});totalChargesN2=u(()=>{this.formChangeCounter();let i=this.rentabiliteN2Form;return i?(i.get("salaires")?.value||0)+(i.get("prelevementEntrepreneur")?.value||0)+(i.get("loyers")?.value||0)+(i.get("transport")?.value||0)+(i.get("electriciteEauTelephone")?.value||0)+(i.get("fournituresAutresBesoins")?.value||0)+(i.get("entretienReparation")?.value||0)+(i.get("carburantLubrifiants")?.value||0)+(i.get("publicitePromotion")?.value||0)+(i.get("impotsTaxes")?.value||0)+(i.get("fraisBancairesInterets")?.value||0)+(i.get("echeanceAutreCredit")?.value||0)+(i.get("diversesCharges")?.value||0):0});amortissementsN2=u(()=>(this.formChangeCounter(),this.rentabiliteN2Form?.get("amortissementsProvisions")?.value||0));autresRevenusN2=u(()=>(this.formChangeCounter(),this.rentabiliteN2Form?.get("autresRevenusHorsActivite")?.value||0));resultatExploitationN2=u(()=>{this.formChangeCounter();let i=this.margeBruteN2(),e=this.totalChargesN2(),l=this.amortissementsN2();return i-e-l});cashFlowN2=u(()=>(this.formChangeCounter(),this.resultatExploitationN2()+this.amortissementsN2()));resultatNetN2=u(()=>(this.formChangeCounter(),this.cashFlowN2()+this.autresRevenusN2()));investissementCoutEquipement=u(()=>this.besoinCreditForm?.get("coutEquipement")?.value||0);investissementDepensesRattachees=u(()=>this.besoinCreditForm?.get("depensesRattachees")?.value||0);investissementApportPersonnel=u(()=>this.besoinCreditForm?.get("apportPersonnel")?.value||0);investissementAjustCoutEquipement=u(()=>this.besoinCreditForm?.get("ajustCoutEquipement")?.value||0);investissementAjustDepensesRattachees=u(()=>this.besoinCreditForm?.get("ajustDepensesRattachees")?.value||0);investissementAjustApportPersonnel=u(()=>this.besoinCreditForm?.get("ajustApportPersonnel")?.value||0);effCoutEquipement=u(()=>this.investissementCoutEquipement()+this.investissementAjustCoutEquipement());effDepensesRattachees=u(()=>this.investissementDepensesRattachees()+this.investissementAjustDepensesRattachees());effApportPersonnel=u(()=>this.investissementApportPersonnel()+this.investissementAjustApportPersonnel());totalInvestissementMontant=u(()=>this.investissementCoutEquipement()+this.investissementDepensesRattachees());totalInvestissementAjuste=u(()=>this.investissementAjustCoutEquipement()+this.investissementAjustDepensesRattachees());totalInvestissementEffectif=u(()=>this.effCoutEquipement()+this.effDepensesRattachees());besoinReelInvestissementMontant=u(()=>this.totalInvestissementMontant()-this.investissementApportPersonnel());besoinReelInvestissementAjuste=u(()=>this.totalInvestissementAjuste()-this.investissementAjustApportPersonnel());besoinReelInvestissementFinal=u(()=>this.totalInvestissementEffectif()-this.effApportPersonnel());exploitationCoutAchatCycle=u(()=>this.besoinCreditForm?.get("coutAchatCycle")?.value||0);exploitationNbreCycles=u(()=>this.besoinCreditForm?.get("nbreCycleFinancer")?.value||1);exploitationTresorerieDispo=u(()=>this.besoinCreditForm?.get("tresorerieDisponible")?.value||0);exploitationStockActuel=u(()=>this.besoinCreditForm?.get("stockActuel")?.value||0);exploitationComptesRecevoir=u(()=>this.besoinCreditForm?.get("comptesRecevoir")?.value||0);exploitationDettesFournisseurs=u(()=>this.besoinCreditForm?.get("dettesFournisseurs")?.value||0);exploitationCreditFournisseur=u(()=>this.besoinCreditForm?.get("creditFournisseur")?.value||0);exploitationAjustCoutAchat=u(()=>this.besoinCreditForm?.get("ajustCoutAchatCycle")?.value||0);exploitationAjustTresorerie=u(()=>this.besoinCreditForm?.get("ajustTresorerieDispo")?.value||0);exploitationAjustStock=u(()=>this.besoinCreditForm?.get("ajustStockActuel")?.value||0);exploitationAjustComptes=u(()=>this.besoinCreditForm?.get("ajustComptesRecevoir")?.value||0);exploitationAjustDettes=u(()=>this.besoinCreditForm?.get("ajustDettesFournisseurs")?.value||0);exploitationAjustCredit=u(()=>this.besoinCreditForm?.get("ajustCreditFournisseur")?.value||0);effCoutAchatCycle=u(()=>this.exploitationCoutAchatCycle()+this.exploitationAjustCoutAchat());effTresorerieDispo=u(()=>this.exploitationTresorerieDispo()+this.exploitationAjustTresorerie());effStockActuel=u(()=>this.exploitationStockActuel()+this.exploitationAjustStock());effComptesRecevoir=u(()=>this.exploitationComptesRecevoir()+this.exploitationAjustComptes());effDettesFournisseurs=u(()=>this.exploitationDettesFournisseurs()+this.exploitationAjustDettes());effCreditFournisseur=u(()=>this.exploitationCreditFournisseur()+this.exploitationAjustCredit());besoinBrutExploitationMontant=u(()=>this.exploitationCoutAchatCycle()*this.exploitationNbreCycles());besoinBrutExploitationAjuste=u(()=>this.exploitationAjustCoutAchat()*this.exploitationNbreCycles());besoinBrutExploitationEffectif=u(()=>this.effCoutAchatCycle()*this.exploitationNbreCycles());ressourcesDisponiblesMontant=u(()=>this.exploitationTresorerieDispo()+this.exploitationStockActuel()+this.exploitationComptesRecevoir());ressourcesDisponiblesAjuste=u(()=>this.exploitationAjustTresorerie()+this.exploitationAjustStock()+this.exploitationAjustComptes());ressourcesDisponiblesEffectif=u(()=>this.effTresorerieDispo()+this.effStockActuel()+this.effComptesRecevoir());totalDettesMontant=u(()=>this.exploitationDettesFournisseurs()+this.exploitationCreditFournisseur());totalDettesAjuste=u(()=>this.exploitationAjustDettes()+this.exploitationAjustCredit());totalDettesEffectif=u(()=>this.effDettesFournisseurs()+this.effCreditFournisseur());besoinReelExploitationMontant=u(()=>this.besoinBrutExploitationMontant()-this.ressourcesDisponiblesMontant()+this.totalDettesMontant());besoinReelExploitationAjuste=u(()=>this.besoinBrutExploitationAjuste()-this.ressourcesDisponiblesAjuste()+this.totalDettesAjuste());besoinReelExploitationFinal=u(()=>this.besoinBrutExploitationEffectif()-this.ressourcesDisponiblesEffectif()+this.totalDettesEffectif());besoinTotalFinancementMontant=u(()=>this.besoinReelInvestissementMontant()+this.besoinReelExploitationMontant());besoinTotalFinancementAjuste=u(()=>this.besoinReelInvestissementAjuste()+this.besoinReelExploitationAjuste());besoinTotalFinancementFinal=u(()=>this.besoinReelInvestissementFinal()+this.besoinReelExploitationFinal());echeanceMensuelle=u(()=>{let i=this.propositionForm?.get("montantPropose")?.value||0,e=this.propositionForm?.get("dureeProposee")?.value||12,l=this.propositionForm?.get("tauxPropose")?.value||0,p=this.propositionForm?.get("periodiciteProposee")?.value;if(i<=0||e<=0)return 0;let b=this.getFacteurPeriodicite(p),N=Math.ceil(e/b),T=l/100*b/12;return T===0?i/N:i*(T*Math.pow(1+T,N))/(Math.pow(1+T,N)-1)});capaciteRemboursementProposee=u(()=>{let i=this.cashFlowN2(),e=this.echeanceMensuelle();if(e===0)return 0;let l=this.propositionForm?.get("periodiciteProposee")?.value,p=this.getFacteurPeriodicite(l),b=e*(12/p);return i/b});ngOnInit(){this.initForms(),this.initStepItems(),this.route.params.pipe(x(this.destroyRef)).subscribe(i=>{if(this.demandeIndividuelId=i.demandeindividuelId?parseInt(i.demandeindividuelId,10):null,!this.demandeIndividuelId){this.messageService.add({severity:"error",summary:"Erreur",detail:"ID de la demande individuelle manquant dans l'URL",life:3e3});return}this.loadAllData()})}loadAllData(){this.state.update(i=>y(E({},i),{loading:!0})),P({initialData:this.userService.startNewDemandeInd$(),demandeData:this.userService.getDemandeWithGaranties$(this.demandeIndividuelId)}).pipe(x(this.destroyRef)).subscribe({next:i=>{if(i.initialData?.data&&this.state.update(e=>y(E({},e),{allDelegations:i.initialData.data.delegations||[],allAgences:i.initialData.data.agences||[],allPointsVente:i.initialData.data.pointVentes||[]})),i.demandeData?.data){let e=i.demandeData.data.demandeIndividuel,l=i.demandeData.data.user?.userId;this.state.update(p=>y(E({},p),{demandeIndividuel:e,userId:l,loading:!1})),this.prefillFormsWithDemande(e),this.loadExistingAnalyse()}},error:i=>{console.error("Error loading data:",i),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les donn\xE9es",life:3e3}),this.state.update(e=>y(E({},e),{loading:!1}))}})}loadExistingAnalyse(){this.http.get(`${this.apiUrl}/ecredit/bilan_finance/analyse/demande/${this.demandeIndividuelId}`).pipe(x(this.destroyRef)).subscribe({next:i=>{let e=i?.data?.analyse,l=e?.analyseId||e?.id;e&&l?(this.state.update(p=>y(E({},p),{analyseId:l,analyseExiste:!0})),this.loadAnalyseDetails(l)):this.state.update(p=>y(E({},p),{analyseExiste:!1}))},error:()=>{this.state.update(i=>y(E({},i),{analyseExiste:!1}))}})}loadAnalyseDetails(i){if(!i||i===void 0||i===null){console.warn("loadAnalyseDetails called with invalid analyseId:",i);return}this.http.get(`${this.apiUrl}/ecredit/bilan_finance/bilan/analyse/${i}`).pipe(x(this.destroyRef)).subscribe({next:e=>{e?.data?.bilans&&e.data.bilans.forEach(l=>{l.typePeriode==="N"?this.patchBilanForm(this.bilanNForm,l):l.typePeriode==="N-1"&&this.patchBilanForm(this.bilanN1Form,l)})}}),this.http.get(`${this.apiUrl}/ecredit/bilan_finance/rentabilite/analyse/${i}`).pipe(x(this.destroyRef)).subscribe({next:e=>{e?.data?.rentabilites&&e.data.rentabilites.forEach(l=>{l.typePeriode==="N"?this.patchRentabiliteForm(this.rentabiliteNForm,l):l.typePeriode==="N-1"?this.patchRentabiliteForm(this.rentabiliteN1Form,l):l.typePeriode==="N+1"&&this.patchRentabiliteForm(this.rentabiliteN2Form,l)})}}),this.http.get(`${this.apiUrl}/ecredit/bilan_finance/besoin-credit/analyse/${i}`).pipe(x(this.destroyRef)).subscribe({next:e=>{e?.data?.besoinCredit&&this.patchBesoinCreditForm(e.data.besoinCredit)}}),this.http.get(`${this.apiUrl}/ecredit/bilan_finance/proposition/${this.demandeIndividuelId}`).pipe(x(this.destroyRef)).subscribe({next:e=>{e?.data?.proposition&&this.patchPropositionForm(e.data.proposition)}}),this.loadRatios(i)}loadRatios(i){if(!i){console.warn("loadRatios called with invalid analyseId:",i);return}this.http.get(`${this.apiUrl}/ecredit/bilan_finance/ratios/analyse/${i}`).pipe(x(this.destroyRef)).subscribe({next:e=>{e?.data?.ratios&&this.updateRatiosData(e.data.ratios)}})}updateRatiosData(i){let e=[{code:"R1",nom:"Capacit\xE9 de remboursement",operateur:">=",norme:2,normeDisplay:"200%",sollicite:i.r1Sollicite,propose:i.r1Propose,conformeSollicite:i.r1ConformeSollicite||!1,conformePropose:i.r1ConformePropose||!1},{code:"R2",nom:"Solvabilit\xE9",operateur:">=",norme:.35,normeDisplay:"35%",sollicite:i.r2Sollicite,propose:i.r2Propose,conformeSollicite:i.r2ConformeSollicite||!1,conformePropose:i.r2ConformePropose||!1},{code:"R3",nom:"Liquidit\xE9 \xE0 \xE9ch\xE9ance",operateur:">=",norme:1,normeDisplay:"100%",sollicite:i.r3Sollicite,propose:i.r3Propose,conformeSollicite:i.r3ConformeSollicite||!1,conformePropose:i.r3ConformePropose||!1},{code:"R4",nom:"Endettement",operateur:"<",norme:.5,normeDisplay:"< 50%",sollicite:i.r4Sollicite,propose:i.r4Propose,conformeSollicite:i.r4ConformeSollicite||!1,conformePropose:i.r4ConformePropose||!1},{code:"R5",nom:"D\xE9pendance",operateur:"<",norme:.5,normeDisplay:"< 50%",sollicite:i.r5Sollicite,propose:i.r5Propose,conformeSollicite:i.r5ConformeSollicite||!1,conformePropose:i.r5ConformePropose||!1},{code:"R6",nom:"Couverture garantie",operateur:">",norme:1.5,normeDisplay:"> 150%",sollicite:i.r6Sollicite,propose:i.r6Propose,conformeSollicite:i.r6ConformeSollicite||!1,conformePropose:i.r6ConformePropose||!1}];this.ratiosData.set(e)}prefillFormsWithDemande(i){if(i){if(this.demandeCreditForm.patchValue({montantDemande:i.montantDemande,dureeMois:i.dureeDemande,objetFinancement:i.detailObjectCredit}),this.propositionForm.patchValue({montantSollicite:i.montantDemande,dureeSollicitee:i.dureeDemande,montantPropose:i.montantDemande,dureeProposee:i.dureeDemande}),i.delegation){let e=this.state().allDelegations.find(l=>l.id===i.delegation);e&&(this.demandeCreditForm.patchValue({delegation:e}),this.onDelegationChange({value:e}),setTimeout(()=>{if(i.agence){let l=this.state().filteredAgences.find(p=>p.id===i.agence);l&&(this.demandeCreditForm.patchValue({agence:l}),this.onAgenceChange({value:l}),setTimeout(()=>{if(i.pos){let p=this.state().filteredPointsVente.find(b=>b.id===i.pos);p&&this.demandeCreditForm.patchValue({pointVente:p})}},100))}},100))}this.demandeCreditForm.get("objetFinancement")?.disable(),this.demandeCreditForm.get("delegation")?.disable(),this.demandeCreditForm.get("agence")?.disable(),this.demandeCreditForm.get("pointVente")?.disable()}}patchBilanForm(i,e){i.patchValue({terrains:e.terrains||e.terrain||0,constructions:e.constructions||e.batimentMagasin||0,installationsTechniques:e.installationsTechniques||e.installationAgencement||0,materielTransport:e.materielTransport||0,materielBureau:e.materielBureau||e.mobilierBureau||0,autresImmobilisations:e.autresImmobilisations||e.autreImmobilisation||0,immobilisationsEnCours:e.immobilisationsEnCours||0,immobilisationsFinancieres:e.immobilisationsFinancieres||0,stocks:e.stocks||0,creances:e.creances||e.creancesClients||0,tresorerieActif:e.tresorerieActif||e.tresorerieCaisseBanque||0,capitauxPropre:e.capitauxPropre||0,dettesLongTerme:e.dettesLongTerme||e.empruntLongTerme||0,dettesCourtTerme:e.dettesCourtTerme||e.empruntCourtTerme||0,tresoreriePassif:e.tresoreriePassif||e.autresDettes||0})}patchRentabiliteForm(i,e){i.patchValue({chiffreAffaires:e.chiffreAffaires||0,coutAchatMarchandises:e.coutAchatMarchandises||0,salaires:e.salaires||0,prelevementEntrepreneur:e.prelevementEntrepreneur||0,loyers:e.loyers||0,transport:e.transport||0,electriciteEauTelephone:e.electriciteEauTelephone||0,fournituresAutresBesoins:e.fournituresAutresBesoins||0,entretienReparation:e.entretienReparation||0,carburantLubrifiants:e.carburantLubrifiants||0,publicitePromotion:e.publicitePromotion||0,impotsTaxes:e.impotsTaxes||0,fraisBancairesInterets:e.fraisBancairesInterets||0,echeanceAutreCredit:e.echeanceAutreCredit||0,diversesCharges:e.diversesCharges||0,amortissementsProvisions:e.amortissementsProvisions||0,autresRevenusHorsActivite:e.autresRevenusHorsActivite||0})}patchBesoinCreditForm(i){this.besoinCreditForm.patchValue({coutEquipement:i.coutEquipement||0,depensesRattachees:i.depensesRattachees||0,apportPersonnel:i.apportPersonnel||0,ajustCoutEquipement:i.ajustCoutEquipement||0,ajustDepensesRattachees:i.ajustDepensesRattachees||0,ajustApportPersonnel:i.ajustApportPersonnel||0,coutAchatCycle:i.coutAchatCycle||0,nbreCycleFinancer:i.nbreCycleFinancer||1,tresorerieDisponible:i.tresorerieDisponible||0,stockActuel:i.stockActuel||0,comptesRecevoir:i.comptesRecevoir||0,dettesFournisseurs:i.dettesFournisseurs||0,creditFournisseur:i.creditFournisseur||0,ajustCoutAchatCycle:i.ajustCoutAchatCycle||0,ajustTresorerieDispo:i.ajustTresorerieDispo||0,ajustStockActuel:i.ajustStockActuel||0,ajustComptesRecevoir:i.ajustComptesRecevoir||0,ajustDettesFournisseurs:i.ajustDettesFournisseurs||0,ajustCreditFournisseur:i.ajustCreditFournisseur||0})}patchPropositionForm(i){this.propositionForm.patchValue({montantSollicite:i.montantSollicite||0,dureeSollicitee:i.dureeSollicitee||0,montantPropose:i.montantPropose||0,dureeProposee:i.dureeProposee||0,tauxPropose:i.tauxPropose||0,periodiciteProposee:i.periodiciteProposee||"MENSUELLE",commentaireOrientation:i.commentaireOrientation||""})}initStepItems(){this.items.set([{label:"Bilan",command:()=>this.onStepChange(0)},{label:"Rentabilit\xE9",command:()=>this.onStepChange(1)},{label:"Personnes caution",command:()=>this.onStepChange(2)},{label:"Synth\xE8se",command:()=>this.onStepChange(3)},{label:"Besoin Cr\xE9dit",command:()=>this.onStepChange(4)}])}initForms(){this.bilanNForm=this.fb.group({terrains:[0],constructions:[0],installationsTechniques:[0],materielTransport:[0],materielBureau:[0],autresImmobilisations:[0],immobilisationsEnCours:[0],immobilisationsFinancieres:[0],stocks:[0],creances:[0],tresorerieActif:[0],capitauxPropre:[0],dettesLongTerme:[0],dettesCourtTerme:[0],tresoreriePassif:[0]}),this.bilanN1Form=this.fb.group({terrains:[0],constructions:[0],installationsTechniques:[0],materielTransport:[0],materielBureau:[0],autresImmobilisations:[0],immobilisationsEnCours:[0],immobilisationsFinancieres:[0],stocks:[0],creances:[0],tresorerieActif:[0],capitauxPropre:[0],dettesLongTerme:[0],dettesCourtTerme:[0],tresoreriePassif:[0]}),this.rentabiliteNForm=this.fb.group({chiffreAffaires:[0],coutAchatMarchandises:[0],salaires:[0],prelevementEntrepreneur:[0],loyers:[0],transport:[0],electriciteEauTelephone:[0],fournituresAutresBesoins:[0],entretienReparation:[0],carburantLubrifiants:[0],publicitePromotion:[0],impotsTaxes:[0],fraisBancairesInterets:[0],echeanceAutreCredit:[0],diversesCharges:[0],amortissementsProvisions:[0],autresRevenusHorsActivite:[0]}),this.rentabiliteN1Form=this.fb.group({chiffreAffaires:[0],coutAchatMarchandises:[0],salaires:[0],prelevementEntrepreneur:[0],loyers:[0],transport:[0],electriciteEauTelephone:[0],fournituresAutresBesoins:[0],entretienReparation:[0],carburantLubrifiants:[0],publicitePromotion:[0],impotsTaxes:[0],fraisBancairesInterets:[0],echeanceAutreCredit:[0],diversesCharges:[0],amortissementsProvisions:[0],autresRevenusHorsActivite:[0]}),this.rentabiliteN2Form=this.fb.group({chiffreAffaires:[0],coutAchatMarchandises:[0],salaires:[0],prelevementEntrepreneur:[0],loyers:[0],transport:[0],electriciteEauTelephone:[0],fournituresAutresBesoins:[0],entretienReparation:[0],carburantLubrifiants:[0],publicitePromotion:[0],impotsTaxes:[0],fraisBancairesInterets:[0],echeanceAutreCredit:[0],diversesCharges:[0],amortissementsProvisions:[0],autresRevenusHorsActivite:[0]}),this.besoinCreditForm=this.fb.group({coutEquipement:[0],depensesRattachees:[0],apportPersonnel:[0],ajustCoutEquipement:[0],ajustDepensesRattachees:[0],ajustApportPersonnel:[0],coutAchatCycle:[0],nbreCycleFinancer:[1],tresorerieDisponible:[0],stockActuel:[0],comptesRecevoir:[0],dettesFournisseurs:[0],creditFournisseur:[0],ajustCoutAchatCycle:[0],ajustTresorerieDispo:[0],ajustStockActuel:[0],ajustComptesRecevoir:[0],ajustDettesFournisseurs:[0],ajustCreditFournisseur:[0]}),this.propositionForm=this.fb.group({montantSollicite:[0],dureeSollicitee:[12],montantPropose:[0],dureeProposee:[12],tauxPropose:[0],periodiciteProposee:["MENSUELLE"],commentaireOrientation:[""]}),this.demandeCreditForm=this.fb.group({montantDemande:[0],dureeMois:[12],objetFinancement:[""],delegation:[null],agence:[null],pointVente:[null]}),this.personnecautionForm=this.fb.group({nom:[""],prenom:[""],telephone:[""],activite:[""],age:[null],profession:[""]}),this.bilanNForm.valueChanges.pipe(x(this.destroyRef)).subscribe(()=>{this.formChangeCounter.update(i=>i+1)}),this.bilanN1Form.valueChanges.pipe(x(this.destroyRef)).subscribe(()=>{this.formChangeCounter.update(i=>i+1)}),this.rentabiliteNForm.valueChanges.pipe(x(this.destroyRef)).subscribe(()=>{this.formChangeCounter.update(i=>i+1)}),this.rentabiliteN1Form.valueChanges.pipe(x(this.destroyRef)).subscribe(()=>{this.formChangeCounter.update(i=>i+1)}),this.rentabiliteN2Form.valueChanges.pipe(x(this.destroyRef)).subscribe(()=>{this.formChangeCounter.update(i=>i+1)}),this.besoinCreditForm.valueChanges.pipe(x(this.destroyRef)).subscribe(()=>{this.formChangeCounter.update(i=>i+1)}),this.propositionForm.valueChanges.pipe(x(this.destroyRef)).subscribe(()=>{this.formChangeCounter.update(i=>i+1)})}onStepChange(i){this.activeIndex.set(i)}nextStep(){let i=this.activeIndex();i<this.items().length-1&&this.activeIndex.set(i+1)}prevStep(){let i=this.activeIndex();i>0&&this.activeIndex.set(i-1)}onDelegationChange(i){let e=i.value;if(!e||!e.id){this.state.update(b=>y(E({},b),{filteredAgences:[],filteredPointsVente:[]}));return}let l=e.id,p=this.state().allAgences?.filter(b=>b.delegation_id===l)||[];this.state.update(b=>y(E({},b),{filteredAgences:p,filteredPointsVente:[]})),this.demandeCreditForm.get("delegation")?.disabled||this.demandeCreditForm.patchValue({agence:null,pointVente:null})}onAgenceChange(i){let e=i.value;if(!e||!e.id){this.state.update(b=>y(E({},b),{filteredPointsVente:[]}));return}let l=e.id,p=this.state().allPointsVente?.filter(b=>b.agence_id===l)||[];this.state.update(b=>y(E({},b),{filteredPointsVente:p})),this.demandeCreditForm.get("agence")?.disabled||this.demandeCreditForm.patchValue({pointVente:null})}addPersonnecaution(){let i={nom:this.personnecautionForm.get("nom")?.value||"",prenom:this.personnecautionForm.get("prenom")?.value||"",telephone:this.personnecautionForm.get("telephone")?.value||"",activite:this.personnecautionForm.get("activite")?.value||"",age:this.personnecautionForm.get("age")?.value||void 0,profession:this.personnecautionForm.get("profession")?.value||""};this.personnecautions.push(i),this.personnecautionForm.reset(),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Personne caution ajout\xE9e avec succ\xE8s."})}removePersonnecaution(i){this.personnecautions.splice(i,1),this.messageService.add({severity:"info",summary:"Information",detail:"Personne caution supprim\xE9e."})}createOrUpdateAnalyse(){if(this.state().analyseExiste)return;let i={demandeindividuelId:this.demandeIndividuelId,nombreCycles:12,hypothese:"CROISSANCE_MODEREE"};this.http.post(`${this.apiUrl}/ecredit/bilan_finance/analyse`,i).pipe(x(this.destroyRef)).subscribe({next:e=>{let l=e?.data?.analyse;if(l){let p=l.analyseId||l.id;this.state.update(b=>y(E({},b),{analyseId:p,analyseExiste:!0})),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Analyse cr\xE9\xE9e avec succ\xE8s"})}},error:e=>{console.error("Error creating analyse:",e),this.messageService.add({severity:"error",summary:"Erreur",detail:e?.error?.message||"Impossible de cr\xE9er l'analyse"})}})}saveBilan(i){let e=this.state().analyseId;if(!e){this.messageService.add({severity:"warn",summary:"Attention",detail:"Veuillez d'abord cr\xE9er l'analyse"});return}this.savingBilan.set(!0);let l=i==="N"?this.bilanNForm:this.bilanN1Form,p={analyseId:e,typePeriode:i,terrain:l.get("terrains")?.value||0,batimentMagasin:l.get("constructions")?.value||0,installationAgencement:l.get("installationsTechniques")?.value||0,materielIndustriel:0,mobilierBureau:l.get("materielBureau")?.value||0,materielInformatique:0,materielTransport:l.get("materielTransport")?.value||0,autreImmobilisation:(l.get("autresImmobilisations")?.value||0)+(l.get("immobilisationsEnCours")?.value||0)+(l.get("immobilisationsFinancieres")?.value||0),stocks:l.get("stocks")?.value||0,creancesClients:l.get("creances")?.value||0,tresorerieCaisseBanque:l.get("tresorerieActif")?.value||0,capitauxPropre:l.get("capitauxPropre")?.value||0,empruntLongTerme:l.get("dettesLongTerme")?.value||0,empruntCourtTerme:l.get("dettesCourtTerme")?.value||0,autresDettes:l.get("tresoreriePassif")?.value||0};this.http.post(`${this.apiUrl}/ecredit/bilan_finance/bilan`,p).pipe(x(this.destroyRef)).subscribe({next:()=>{this.savingBilan.set(!1),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Bilan ${i} enregistr\xE9 avec succ\xE8s`})},error:b=>{this.savingBilan.set(!1),this.messageService.add({severity:"error",summary:"Erreur",detail:b?.error?.message||"Impossible d'enregistrer le bilan"})}})}saveBilanAll(){let i=this.state().analyseId;if(!i){this.messageService.add({severity:"warn",summary:"Attention",detail:"Veuillez d'abord cr\xE9er l'analyse"});return}this.savingBilan.set(!0);let e=this.mapBilanFormToRequest(this.bilanNForm,i,"N"),l=this.mapBilanFormToRequest(this.bilanN1Form,i,"N-1");P({bilanN:this.http.post(`${this.apiUrl}/ecredit/bilan_finance/bilan`,e),bilanN1:this.http.post(`${this.apiUrl}/ecredit/bilan_finance/bilan`,l)}).pipe(x(this.destroyRef)).subscribe({next:()=>{this.savingBilan.set(!1),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Bilans N et N-1 enregistr\xE9s avec succ\xE8s"})},error:p=>{this.savingBilan.set(!1),this.messageService.add({severity:"error",summary:"Erreur",detail:p?.error?.message||"Impossible d'enregistrer les bilans"})}})}convertPeriodeToBackend(i){return{N:"N","N-1":"N_MOINS_1","N+1":"N_PLUS_1"}[i]||i}mapBilanFormToRequest(i,e,l){return{analyseId:e,typePeriode:this.convertPeriodeToBackend(l),terrain:i.get("terrains")?.value||0,batimentMagasin:i.get("constructions")?.value||0,installationAgencement:i.get("installationsTechniques")?.value||0,materielIndustriel:0,mobilierBureau:i.get("materielBureau")?.value||0,materielInformatique:0,materielTransport:i.get("materielTransport")?.value||0,autreImmobilisation:(i.get("autresImmobilisations")?.value||0)+(i.get("immobilisationsEnCours")?.value||0)+(i.get("immobilisationsFinancieres")?.value||0),stocks:i.get("stocks")?.value||0,creancesClients:i.get("creances")?.value||0,tresorerieCaisseBanque:i.get("tresorerieActif")?.value||0,capitauxPropre:i.get("capitauxPropre")?.value||0,empruntLongTerme:i.get("dettesLongTerme")?.value||0,empruntCourtTerme:i.get("dettesCourtTerme")?.value||0,autresDettes:i.get("tresoreriePassif")?.value||0}}saveRentabilite(i){let e=this.state().analyseId;if(!e){this.messageService.add({severity:"warn",summary:"Attention",detail:"Veuillez d'abord cr\xE9er l'analyse"});return}this.savingRentabilite.set(!0);let l;i==="N"?l=this.rentabiliteNForm:i==="N-1"?l=this.rentabiliteN1Form:l=this.rentabiliteN2Form;let p=this.mapRentabiliteFormToRequest(l,e,i);this.http.post(`${this.apiUrl}/ecredit/bilan_finance/rentabilite`,p).pipe(x(this.destroyRef)).subscribe({next:()=>{this.savingRentabilite.set(!1),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Rentabilit\xE9 ${i} enregistr\xE9e avec succ\xE8s`})},error:b=>{this.savingRentabilite.set(!1),this.messageService.add({severity:"error",summary:"Erreur",detail:b?.error?.message||"Impossible d'enregistrer la rentabilit\xE9"})}})}mapRentabiliteFormToRequest(i,e,l){let p=i.get("chiffreAffaires")?.value||0,b=i.get("coutAchatMarchandises")?.value||0;return{analyseId:e,typePeriode:this.convertPeriodeToBackend(l),chiffreAffaires:p,coutAchatMarchandises:b,margeBrute:p-b,salaires:i.get("salaires")?.value||0,prelevementEntrepreneur:i.get("prelevementEntrepreneur")?.value||0,loyers:i.get("loyers")?.value||0,transport:i.get("transport")?.value||0,electriciteEauTelephone:i.get("electriciteEauTelephone")?.value||0,fournituresAutresBesoins:i.get("fournituresAutresBesoins")?.value||0,entretienReparation:i.get("entretienReparation")?.value||0,carburantLubrifiants:i.get("carburantLubrifiants")?.value||0,publicitePromotion:i.get("publicitePromotion")?.value||0,impotsTaxes:i.get("impotsTaxes")?.value||0,fraisBancairesInterets:i.get("fraisBancairesInterets")?.value||0,echeanceAutreCredit:i.get("echeanceAutreCredit")?.value||0,diversesCharges:i.get("diversesCharges")?.value||0,amortissementsProvisions:i.get("amortissementsProvisions")?.value||0,autresRevenusHorsActivite:i.get("autresRevenusHorsActivite")?.value||0}}saveRentabiliteAll(){let i=this.state().analyseId;if(!i){this.messageService.add({severity:"warn",summary:"Attention",detail:"Veuillez d'abord cr\xE9er l'analyse"});return}this.savingRentabilite.set(!0);let e=this.mapRentabiliteFormToRequest(this.rentabiliteNForm,i,"N"),l=this.mapRentabiliteFormToRequest(this.rentabiliteN1Form,i,"N-1"),p=this.mapRentabiliteFormToRequest(this.rentabiliteN2Form,i,"N+1");P({rentabiliteN:this.http.post(`${this.apiUrl}/ecredit/bilan_finance/rentabilite`,e),rentabiliteN1:this.http.post(`${this.apiUrl}/ecredit/bilan_finance/rentabilite`,l),rentabiliteN2:this.http.post(`${this.apiUrl}/ecredit/bilan_finance/rentabilite`,p)}).pipe(x(this.destroyRef)).subscribe({next:()=>{this.savingRentabilite.set(!1),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Rentabilit\xE9s N, N-1 et N+1 enregistr\xE9es avec succ\xE8s"})},error:b=>{this.savingRentabilite.set(!1),this.messageService.add({severity:"error",summary:"Erreur",detail:b?.error?.message||"Impossible d'enregistrer les rentabilit\xE9s"})}})}saveBesoinCredit(){let i=this.state().analyseId;if(!i){this.messageService.add({severity:"warn",summary:"Attention",detail:"Veuillez d'abord cr\xE9er l'analyse"});return}this.savingBesoinCredit.set(!0);let e=this.besoinCreditForm,l={analyseId:i,coutEquipement:e.get("coutEquipement")?.value||0,depensesRattachees:e.get("depensesRattachees")?.value||0,apportPersonnel:e.get("apportPersonnel")?.value||0,ajustCoutEquipement:e.get("ajustCoutEquipement")?.value||0,ajustDepensesRattachees:e.get("ajustDepensesRattachees")?.value||0,ajustApportPersonnel:e.get("ajustApportPersonnel")?.value||0,coutAchatCycle:e.get("coutAchatCycle")?.value||0,nbreCycleFinancer:e.get("nbreCycleFinancer")?.value||1,tresorerieDisponible:e.get("tresorerieDisponible")?.value||0,stockActuel:e.get("stockActuel")?.value||0,comptesRecevoir:e.get("comptesRecevoir")?.value||0,dettesFournisseurs:e.get("dettesFournisseurs")?.value||0,creditFournisseur:e.get("creditFournisseur")?.value||0,ajustCoutAchatCycle:e.get("ajustCoutAchatCycle")?.value||0,ajustTresorerieDispo:e.get("ajustTresorerieDispo")?.value||0,ajustStockActuel:e.get("ajustStockActuel")?.value||0,ajustComptesRecevoir:e.get("ajustComptesRecevoir")?.value||0,ajustDettesFournisseurs:e.get("ajustDettesFournisseurs")?.value||0,ajustCreditFournisseur:e.get("ajustCreditFournisseur")?.value||0};this.http.post(`${this.apiUrl}/ecredit/bilan_finance/besoin-credit`,l).pipe(x(this.destroyRef)).subscribe({next:()=>{this.savingBesoinCredit.set(!1),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Besoin en cr\xE9dit enregistr\xE9 avec succ\xE8s"})},error:p=>{this.savingBesoinCredit.set(!1),this.messageService.add({severity:"error",summary:"Erreur",detail:p?.error?.message||"Impossible d'enregistrer le besoin en cr\xE9dit"})}})}saveProposition(){this.loading.set(!0);let i={montantSollicite:this.propositionForm.get("montantSollicite")?.value,dureeSollicitee:this.propositionForm.get("dureeSollicitee")?.value,montantPropose:this.propositionForm.get("montantPropose")?.value,dureeProposee:this.propositionForm.get("dureeProposee")?.value,tauxPropose:this.propositionForm.get("tauxPropose")?.value,periodiciteProposee:this.propositionForm.get("periodiciteProposee")?.value};this.http.put(`${this.apiUrl}/ecredit/bilan_finance/proposition/${this.demandeIndividuelId}`,i).pipe(x(this.destroyRef)).subscribe({next:()=>{this.loading.set(!1),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Proposition enregistr\xE9e avec succ\xE8s"})},error:e=>{this.loading.set(!1),this.messageService.add({severity:"error",summary:"Erreur",detail:e?.error?.message||"Impossible d'enregistrer la proposition"})}})}calculateRatios(){let i=this.state().analyseId;if(!i){this.messageService.add({severity:"warn",summary:"Attention",detail:"Veuillez d'abord cr\xE9er et sauvegarder l'analyse"});return}this.calculatingRatios.set(!0),this.http.post(`${this.apiUrl}/ecredit/bilan_finance/ratios/calculer/${i}`,{}).pipe(x(this.destroyRef)).subscribe({next:e=>{this.calculatingRatios.set(!1),e?.data?.ratios&&(this.updateRatiosData(e.data.ratios),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Ratios calcul\xE9s avec succ\xE8s"}))},error:e=>{this.calculatingRatios.set(!1),this.messageService.add({severity:"error",summary:"Erreur",detail:e?.error?.message||"Impossible de calculer les ratios"})}})}submitAnalyse(){let i=this.state().analyseId;if(!i){this.messageService.add({severity:"error",summary:"Erreur",detail:"L'analyse n'existe pas encore. Veuillez d'abord enregistrer le bilan et la rentabilit\xE9."});return}this.loading.set(!0);let e=this.personnecautions.map(p=>({nom:p.nom||"",prenom:p.prenom||"",telephone:p.telephone||"",activite:p.activite||"",age:p.age||null,profession:p.profession||""})),l={analyseId:i,forcerSoumission:!1,personnesCaution:e};this.http.post(`${this.apiUrl}/ecredit/bilan_finance/analyse/soumettre`,l).pipe(x(this.destroyRef)).subscribe({next:p=>{this.loading.set(!1);let b=p?.data?.soumission;if(b?.succes){let N=this.personnecautions.length;this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Analyse soumise avec succ\xE8s${N>0?" avec "+N+" personne(s) caution":""}`}),setTimeout(()=>{this.router.navigate(["/dashboards/credit/individuel/attente/detail",this.demandeIndividuelId])},2e3)}else{let N=b?.erreurs||[],T=N.length>0?N.join(`
`):"La soumission a \xE9chou\xE9. V\xE9rifiez les donn\xE9es saisies.";this.messageService.add({severity:"warn",summary:"Validation \xE9chou\xE9e",detail:T,life:1e4})}},error:p=>{this.loading.set(!1);let N=p?.error?.data?.soumission?.erreurs||[];N.length>0?this.messageService.add({severity:"warn",summary:"Validation \xE9chou\xE9e",detail:N.join(`
`),life:1e4}):this.messageService.add({severity:"error",summary:"Erreur",detail:p?.error?.message||"Impossible de soumettre l'analyse"})}})}getControl(i,e){return i.get(e)}getFacteurPeriodicite(i){return this.periodicites.find(l=>l.value===i)?.facteur||1}formatRatioValue(i){return i==null?"-":(i*100).toFixed(1)+"%"}getRatioSeverity(i){return i?"success":"danger"}getRatioLabel(i){return i?"Conforme":"Non conforme"}allRatiosConformesSollicite(){return this.ratiosData().every(i=>i.conformeSollicite)}allRatiosConformesPropose(){return this.ratiosData().every(i=>i.conformePropose)}static \u0275fac=function(e){return new(e||m)};static \u0275cmp=j({type:m,selectors:[["app-analyse-bilan-activite"]],features:[w([G,{provide:k,useValue:"fr-FR"}])],decls:16,vars:12,consts:[[1,"card"],[1,"text-surface-900","dark:text-surface-0","text-xl","font-bold","mb-6"],["class","mb-4",4,"ngIf"],["styleClass","mb-5",3,"model","activeIndex","readonly"],[1,"p-fluid"],[4,"ngIf"],[1,"flex","justify-content-between","mt-4"],["pButton","","type","button","label","Pr\xE9c\xE9dent","icon","pi pi-arrow-left",1,"p-button-outlined",3,"click","disabled"],["pButton","","type","button","label","Suivant","icon","pi pi-arrow-right","iconPos","right",1,"p-button-outlined",3,"click","disabled"],[1,"mb-4"],[1,"p-3","bg-yellow-50","border-round","border-1","border-yellow-200","flex","align-items-center","justify-content-between"],[1,"pi","pi-info-circle","mr-2"],["pButton","","label","Cr\xE9er l'analyse","icon","pi pi-plus",1,"p-button-success",3,"click","loading"],[1,"p-3","bg-green-50","border-round","border-1","border-green-200","flex","align-items-center"],[1,"pi","pi-check-circle","text-green-600","mr-2"],[1,"text-green-700"],["pTemplate","header"],[1,"overflow-x-auto"],[1,"w-full","border-collapse"],[1,"bg-gray-100"],[1,"p-3","text-left","border-1","surface-border",2,"width","35%"],[1,"p-3","text-center","border-1","surface-border","bg-blue-50",2,"width","25%"],[1,"font-normal"],[1,"p-3","text-center","border-1","surface-border","bg-gray-50",2,"width","25%"],[1,"p-3","text-center","border-1","surface-border",2,"width","15%"],[1,"bg-blue-100"],["colspan","4",1,"p-2","font-bold","border-1","surface-border"],[1,"bg-gray-50"],[1,"p-2","font-semibold","border-1","surface-border"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-primary"],[1,"p-2","text-right","border-1","surface-border","font-bold"],[1,"p-2","border-1","surface-border"],[1,"p-2","pl-5","border-1","surface-border"],[1,"p-1","border-1","surface-border"],["mode","decimal",1,"w-full","input-sm",3,"formControl","useGrouping"],["type","text","pInputText","",1,"w-full","p-1","text-sm"],[1,"bg-green-100"],[1,"p-2","font-bold","border-1","surface-border"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-green-700"],["colspan","4",1,"p-2"],[1,"bg-purple-100"],[1,"bg-yellow-50"],[1,"p-2","text-right","border-1","surface-border","font-bold",3,"ngClass"],[1,"p-2","border-1","surface-border","text-xs"],["pTemplate","footer"],[1,"flex","align-items-center","justify-content-between","p-3","bg-primary","text-white"],[1,"m-0","text-xl","font-bold"],[1,"text-sm"],[1,"flex","justify-content-end","gap-2"],["pButton","","label","Enregistrer Bilan","icon","pi pi-save",3,"click","loading","disabled"],[1,"p-3","text-left","border-1","surface-border",2,"width","30%"],[1,"p-3","text-center","border-1","surface-border","bg-blue-50",2,"width","20%"],[1,"p-3","text-center","border-1","surface-border","bg-gray-50",2,"width","20%"],[1,"p-3","text-center","border-1","surface-border","bg-green-50",2,"width","20%"],[1,"p-3","text-center","border-1","surface-border",2,"width","10%"],[1,"bg-blue-50"],[1,"p-1","border-1","surface-border","text-xs"],[1,"ml-2","text-sm","font-normal","text-color-secondary"],[1,"bg-red-50"],["colspan","5",1,"p-2","font-bold","border-1","surface-border"],[1,"p-2","pl-4","border-1","surface-border"],[1,"bg-red-100"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-red-700"],[1,"bg-orange-50"],[1,"p-2","pl-4","font-bold","border-1","surface-border"],["colspan","5",1,"p-1"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-purple-700"],[1,"bg-green-200"],["pButton","","label","Enregistrer Rentabilit\xE9","icon","pi pi-save",3,"click","loading","disabled"],["header","Personnes Caution"],[1,"grid","gap-3"],[1,"col-12"],[1,"text-lg","font-bold","mb-3","border-bottom-1","surface-border","pb-2"],[1,"text-color-secondary","mb-4"],[1,"p-fluid",3,"formGroup"],[1,"col-12","md:col-6"],[1,"block","font-medium","mb-1"],["type","text","pInputText","","formControlName","nom",1,"w-full"],["type","text","pInputText","","formControlName","prenom",1,"w-full"],["type","text","pInputText","","formControlName","telephone",1,"w-full"],["formControlName","age","suffix"," ans",1,"w-full",3,"showButtons","min","max"],["type","text","pInputText","","formControlName","activite",1,"w-full"],["type","text","pInputText","","formControlName","profession",1,"w-full"],["pButton","","type","button","label","Ajouter cette personne caution","icon","pi pi-plus",1,"p-button-success",3,"click"],["class","col-12",4,"ngIf"],["class","col-12 md:col-6",4,"ngFor","ngForOf"],[1,"grid"],["class","col-6",4,"ngIf"],[1,"flex","align-items-center","justify-content-between","p-3","bg-gray-100"],[1,"font-bold"],["pButton","","type","button","icon","pi pi-trash","pTooltip","Supprimer",1,"p-button-rounded","p-button-danger","p-button-text",3,"click"],[1,"col-6"],[1,"p-3","bg-yellow-50","border-round","border-1","border-yellow-200","text-center"],["header","Synth\xE8se de l'Analyse"],[1,"text-lg","font-bold","mb-4","border-bottom-1","surface-border","pb-2"],[1,"pi","pi-file-check","mr-2"],[1,"col-12","md:col-6","lg:col-3"],[1,"p-3","bg-blue-50","border-round","text-center"],[1,"block","text-color-secondary","mb-1"],[1,"text-lg","text-blue-700"],[1,"p-3","bg-green-50","border-round","text-center"],[1,"text-lg","text-green-700"],[1,"p-3","bg-purple-50","border-round","text-center"],[1,"text-lg","text-purple-700"],[1,"col-12","mt-3"],[1,"p-4","bg-primary","border-round","text-white","text-center"],[1,"block","text-lg","mb-1"],[1,"text-3xl"],[1,"col-12","mt-4"],[1,"pi","pi-users","mr-2"],["class","grid",4,"ngIf"],["class","p-3 bg-yellow-50 border-round border-1 border-yellow-200",4,"ngIf"],[1,"p-3","bg-yellow-50","border-round","border-1","border-yellow-200"],[1,"pi","pi-exclamation-triangle","mr-2","text-yellow-700"],[1,"p-3","bg-gray-50","border-round"],["class","ml-2 text-color-secondary",4,"ngIf"],[1,"ml-2","text-color-secondary"],[1,"flex","justify-content-end"],["pButton","","label","Soumettre l'Analyse","icon","pi pi-send",1,"p-button-success",3,"click","loading","disabled"],[3,"formGroup"],[1,"p-3","text-center","border-1","surface-border","bg-blue-50",2,"width","23%"],[1,"p-3","text-center","border-1","surface-border","bg-yellow-50",2,"width","23%"],[1,"p-3","text-center","border-1","surface-border","bg-green-50",2,"width","24%"],[1,"pi","pi-building","mr-2"],["formControlName","coutEquipement","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],[1,"p-1","border-1","surface-border","bg-yellow-50"],["formControlName","ajustCoutEquipement","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],[1,"p-2","text-right","border-1","surface-border","bg-green-50","font-semibold"],["formControlName","depensesRattachees","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustDepensesRattachees","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],[1,"p-2","pl-4","font-semibold","border-1","surface-border"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-blue-700"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-yellow-700","bg-yellow-50"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-green-700","bg-green-50"],[1,"p-2","pl-4","border-1","surface-border","text-green-700"],["formControlName","apportPersonnel","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustApportPersonnel","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],[1,"p-2","text-right","border-1","surface-border","bg-green-50","font-semibold","text-green-700"],[1,"bg-blue-200"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-blue-800"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-yellow-800","bg-yellow-100"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-green-800","bg-green-100"],[1,"pi","pi-sync","mr-2"],["formControlName","coutAchatCycle","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustCoutAchatCycle","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["colspan","2",1,"p-1","border-1","surface-border"],["formControlName","nbreCycleFinancer",1,"w-full","input-sm",3,"showButtons","min","max"],[1,"p-2","text-center","border-1","surface-border","bg-green-50","font-semibold"],[1,"bg-purple-50"],["colspan","4",1,"p-2","pl-4","font-semibold","border-1","surface-border","text-green-700"],[1,"p-2","pl-6","border-1","surface-border"],["formControlName","tresorerieDisponible","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustTresorerieDispo","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","stockActuel","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustStockActuel","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","comptesRecevoir","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustComptesRecevoir","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],[1,"bg-green-50"],[1,"p-2","pl-4","font-semibold","border-1","surface-border","text-green-700"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-green-800"],["colspan","4",1,"p-2","pl-4","font-semibold","border-1","surface-border","text-red-700"],["formControlName","dettesFournisseurs","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustDettesFournisseurs","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","creditFournisseur","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],["formControlName","ajustCreditFournisseur","mode","decimal",1,"w-full","input-sm",3,"useGrouping"],[1,"p-2","pl-4","font-semibold","border-1","surface-border","text-red-700"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-red-800","bg-red-100"],[1,"bg-purple-200"],[1,"p-2","text-right","border-1","surface-border","font-bold","text-purple-800"],["colspan","4",1,"p-3"],[1,"bg-primary","text-white"],[1,"p-3","font-bold","border-1","border-white"],[1,"pi","pi-wallet","mr-2"],[1,"p-3","text-right","border-1","border-white","font-bold","text-xl"],[1,"p-3","text-right","border-1","border-white","font-bold","text-xl","bg-yellow-600"],[1,"p-3","text-right","border-1","border-white","font-bold","text-xl","bg-green-600"],[1,"grid","mt-4"],[1,"col-12","md:col-4"],[1,"p-3","bg-blue-100","border-round","text-center"],[1,"p-3","bg-purple-100","border-round","text-center"],[1,"p-3","bg-green-100","border-round","text-center"],[1,"text-xl","text-green-700"],["pButton","","label","Enregistrer Besoin Cr\xE9dit","icon","pi pi-save",3,"click","loading","disabled"]],template:function(e,l){e&1&&(n(0,"div",0)(1,"h1",1),o(2,"Analyse Financi\xE8re"),t(),a(3,"p-toast"),C(4,Ge,6,1,"div",2)(5,Ve,5,1,"div",2),a(6,"p-steps",3),n(7,"div",4),C(8,Me,231,172,"div",5)(9,qe,281,247,"div",5)(10,Je,39,6,"div",5)(11,it,53,40,"div",5)(12,ot,240,320,"div",5),n(13,"div",6)(14,"button",7),F("click",function(){return l.prevStep()}),t(),n(15,"button",8),F("click",function(){return l.nextStep()}),t()()()()),e&2&&(r(4),s("ngIf",!l.state().analyseExiste),r(),s("ngIf",l.state().analyseExiste),r(),s("model",l.items())("activeIndex",l.activeIndex())("readonly",!1),r(2),s("ngIf",l.activeIndex()===0),r(),s("ngIf",l.activeIndex()===1),r(),s("ngIf",l.activeIndex()===2),r(),s("ngIf",l.activeIndex()===3),r(),s("ngIf",l.activeIndex()===4),r(2),s("disabled",l.activeIndex()===0),r(),s("disabled",l.activeIndex()===4))},dependencies:[z,q,$,U,O,H,_e,he,J,oe,ee,K,Y,Z,ae,te,ie,ne,pe,me,le,se,ye,Ee,Te,Re,Ie,Ae,be,fe,Fe,ue,Se,Be,xe,ce,de,Ce,Ne],encapsulation:2})};export{De as AnalyseBilanActiviteComponent};
