import{a as R,b as B}from"./chunk-LYHZ4GLG.js";import{k as w}from"./chunk-SRGIHKGJ.js";import"./chunk-KLDL5O4H.js";import"./chunk-PXEEYFPS.js";import"./chunk-4MNJFNZT.js";import"./chunk-7A4CRAMP.js";import"./chunk-3WTE2CKQ.js";import"./chunk-LA2FUI34.js";import"./chunk-ZNTL7BEM.js";import"./chunk-MPVO6A2U.js";import"./chunk-D6YNXGTA.js";import"./chunk-ED7TFTUL.js";import"./chunk-MZ7FZGG3.js";import{a as T,b as V}from"./chunk-C4WQ325L.js";import"./chunk-HNZBC55R.js";import"./chunk-J62YMCRW.js";import"./chunk-J6B6CWYC.js";import"./chunk-IEQZB3PI.js";import"./chunk-ATSSA22C.js";import"./chunk-XYTTGGFW.js";import"./chunk-ZNT52ZF3.js";import"./chunk-Z7KSDRLV.js";import"./chunk-N4Q6Z3MW.js";import{a as k,b as j}from"./chunk-3BEM77IG.js";import"./chunk-UCSGE5ZL.js";import"./chunk-2O7XYKW4.js";import"./chunk-R2ZYXRFE.js";import"./chunk-NRZ4QNP7.js";import"./chunk-GFZUU5ZD.js";import"./chunk-BODZH67C.js";import"./chunk-KR7F45VC.js";import{e as A,g as I}from"./chunk-XKXBFP6V.js";import"./chunk-ULM4QL4Q.js";import"./chunk-3YZBLOIS.js";import"./chunk-2I6ZAGC7.js";import{b as U}from"./chunk-FVCMZ6IK.js";import"./chunk-VDYO34A5.js";import"./chunk-Y2QT2WK5.js";import"./chunk-S35HUXPS.js";import{y}from"./chunk-GZWLZB4Q.js";import{Bb as p,Gb as i,Hb as r,Ib as g,Mb as h,Mc as o,Rb as C,Sb as u,Va as s,_ as P,cc as c,dc as f,ec as O,fa as S,fc as x,ga as E,gb as b,mb as v,va as M,vb as _}from"./chunk-MKA3N2SS.js";import{a as d,b as l}from"./chunk-GAL4ENT6.js";function z(a,n){if(a&1&&(i(0,"p",2),c(1," Statistiques des corrections pour la d\xE9l\xE9gation de "),i(2,"strong"),c(3),r()()),a&2){let e,t=u();s(3),x("",(e=t.user())==null?null:e.firstName," ",(e=t.user())==null?null:e.lastName,"")}}function H(a,n){if(a&1&&(i(0,"div",4),c(1),r()),a&2){let e=u();s(),O(" ",e.userError()," ")}}function N(a,n){a&1&&(i(0,"div",5),g(1,"p-progressSpinner"),i(2,"p"),c(3,"Chargement des informations..."),r()())}function $(a,n){if(a&1&&(i(0,"div",6)(1,"div",8)(2,"div",9),g(3,"i",10),r(),i(4,"div",11)(5,"span",12),c(6),r(),i(7,"span",13),c(8,"En attente"),r()()(),i(9,"div",14)(10,"div",9),g(11,"i",15),r(),i(12,"div",11)(13,"span",12),c(14),r(),i(15,"span",13),c(16,"Rejet\xE9es"),r()()(),i(17,"div",16)(18,"div",9),g(19,"i",17),r(),i(20,"div",11)(21,"span",12),c(22),r(),i(23,"span",13),c(24,"Valid\xE9es"),r()()(),i(25,"div",18)(26,"div",9),g(27,"i",19),r(),i(28,"div",11)(29,"span",12),c(30),r(),i(31,"span",13),c(32,"Total"),r()()()()),a&2){let e=u();s(6),f(e.totalEnAttente()),s(8),f(e.totalRejete()),s(8),f(e.totalValide()),s(8),f(e.totalGlobal())}}function q(a,n){if(a&1){let e=h();i(0,"div",7)(1,"div",20)(2,"app-societariat-by-agence",21),C("agenceSelected",function(m){S(e);let L=u();return E(L.onSelectAgence(m))}),r()(),i(3,"div",20),g(4,"app-societariat-by-ps",22),r()()}if(a&2){let e,t=u();s(2),_("delegationLibele","Agences de ma d\xE9l\xE9gation")("stats",t.agences())("loading",t.loadingAgences())("error",t.agenceError()),s(2),_("agenceLibele",(e=t.selectedAgence())==null?null:e.agenceLibele)("stats",t.points())("loading",t.loadingPoints())("error",t.pointError())}}var D=class a{userService=P(U);state=M({loadingUser:!1,user:void 0,userError:void 0,loadingAgences:!1,agences:[],agenceError:void 0,loadingPoints:!1,points:[],pointError:void 0,selectedAgence:null});loadingUser=o(()=>this.state().loadingUser);user=o(()=>this.state().user);userError=o(()=>this.state().userError);agences=o(()=>this.state().agences);points=o(()=>this.state().points);loadingAgences=o(()=>this.state().loadingAgences);loadingPoints=o(()=>this.state().loadingPoints);selectedAgence=o(()=>this.state().selectedAgence);agenceError=o(()=>this.state().agenceError);pointError=o(()=>this.state().pointError);totalEnAttente=o(()=>this.agences().reduce((n,e)=>n+e.enAttente,0));totalRejete=o(()=>this.agences().reduce((n,e)=>n+e.rejete,0));totalValide=o(()=>this.agences().reduce((n,e)=>n+e.valide,0));totalGlobal=o(()=>this.agences().reduce((n,e)=>n+e.total,0));ngOnInit(){this.loadUser()}loadUser(){this.state.update(n=>l(d({},n),{loadingUser:!0,userError:void 0})),this.userService.getInstanceUser$().subscribe({next:n=>{let e=n.data?.user;this.state.update(t=>l(d({},t),{user:e,loadingUser:!1})),e?.delegationId?this.loadAgenceStats(e.delegationId):this.state.update(t=>l(d({},t),{userError:"Aucune d\xE9l\xE9gation associ\xE9e \xE0 votre compte."}))},error:n=>{let e=n.error?.message||"Erreur lors du chargement des informations utilisateur.";this.state.update(t=>l(d({},t),{loadingUser:!1,userError:e}))}})}loadAgenceStats(n){this.state.update(e=>l(d({},e),{loadingAgences:!0,agenceError:void 0,agences:[],points:[],selectedAgence:null})),this.userService.getCorrectionStatsByAgence$(n).subscribe({next:e=>{let t=e.data?.correctionAgenceStats||[];this.state.update(m=>l(d({},m),{agences:t,loadingAgences:!1}))},error:e=>{let t=e.error?.message||"Erreur lors du chargement des agences.";this.state.update(m=>l(d({},m),{loadingAgences:!1,agenceError:t}))}})}onSelectAgence(n){if(!n?.agenceId){this.state.update(e=>l(d({},e),{selectedAgence:n,points:[],pointError:"Identifiant agence manquant"}));return}this.state.update(e=>l(d({},e),{selectedAgence:n,points:[],pointError:void 0,loadingPoints:!0})),this.userService.getCorrectionStatsByPointVente$(n.agenceId).subscribe({next:e=>{let t=e.data?.correctionPointVenteStats||[];this.state.update(m=>l(d({},m),{points:t,loadingPoints:!1}))},error:e=>{let t=e.error?.message||"Erreur lors du chargement des points de vente.";this.state.update(m=>l(d({},m),{loadingPoints:!1,pointError:t}))}})}refresh(){let n=this.user();n?.delegationId&&this.loadAgenceStats(n.delegationId)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=b({type:a,selectors:[["app-suivi-societariat"]],decls:11,vars:5,consts:[[1,"suivi-societariat-card"],[1,"header"],[1,"subtitle"],["pButton","","type","button","icon","pi pi-refresh","label","Rafra\xEEchir",1,"p-button-outlined",3,"click","disabled"],[1,"error"],[1,"loading"],[1,"summary-grid"],[1,"grid","mt-3"],[1,"summary-card","en-attente-bg"],[1,"summary-icon"],[1,"pi","pi-clock"],[1,"summary-content"],[1,"summary-value"],[1,"summary-label"],[1,"summary-card","rejete-bg"],[1,"pi","pi-times-circle"],[1,"summary-card","valide-bg"],[1,"pi","pi-check-circle"],[1,"summary-card","total-bg"],[1,"pi","pi-chart-bar"],[1,"col-12","md:col-6"],[3,"agenceSelected","delegationLibele","stats","loading","error"],[3,"agenceLibele","stats","loading","error"]],template:function(e,t){e&1&&(i(0,"p-card",0)(1,"div",1)(2,"div")(3,"h3"),c(4,"Suivi Soci\xE9tariat - Ma D\xE9l\xE9gation"),r(),v(5,z,4,2,"p",2),r(),i(6,"button",3),C("click",function(){return t.refresh()}),r()(),v(7,H,2,1,"div",4)(8,N,4,0,"div",5)(9,$,33,4,"div",6),r(),v(10,q,5,8,"div",7)),e&2&&(s(5),p(t.user()?5:-1),s(),_("disabled",t.loadingUser()||t.loadingAgences()),s(),p(t.userError()?7:-1),s(),p(t.loadingUser()?8:t.user()?9:-1),s(2),p(t.user()&&!t.userError()?10:-1))},dependencies:[y,V,T,w,j,k,I,A,R,B],styles:[".suivi-societariat-card[_ngcontent-%COMP%]{width:100%}.suivi-societariat-card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:1.5rem}.suivi-societariat-card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:700;color:#1f2937}.suivi-societariat-card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:.25rem 0 0;color:#6b7280;font-size:.95rem}.suivi-societariat-card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#374151}.suivi-societariat-card[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem 0;gap:1rem}.suivi-societariat-card[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6b7280}.suivi-societariat-card[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{padding:.75rem 1rem;margin-bottom:1rem;border-radius:6px;background:#fef2f2;color:#b91c1c;border:1px solid #fecdd3}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem}@media (max-width: 992px){.suivi-societariat-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 576px){.suivi-societariat-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1.25rem;border-radius:12px;transition:transform .2s ease,box-shadow .2s ease}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;border-radius:50%;background:#ffffff4d}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;color:#fff}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-content[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#fff}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-content[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:.875rem;color:#ffffffd9}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card.en-attente-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706)}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card.rejete-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card.valide-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e,#16a34a)}.suivi-societariat-card[_ngcontent-%COMP%]   .summary-card.total-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6366f1,#4f46e5)}.mt-3[_ngcontent-%COMP%]{margin-top:1.5rem}"]})};export{D as SuiviSocietariatComponent};
