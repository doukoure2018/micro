import{b as T}from"./chunk-FGMPEHU4.js";import"./chunk-X2KUNYA6.js";import"./chunk-AMXAFO4A.js";import"./chunk-2QPLZWUI.js";import{b as B}from"./chunk-KRA3R5HH.js";import{b as j}from"./chunk-IDKLANHK.js";import{a as G,b as N}from"./chunk-GBSAZIIF.js";import{c as A,d as U}from"./chunk-JK4JG2UW.js";import{c as $}from"./chunk-HNZBC55R.js";import"./chunk-J62YMCRW.js";import"./chunk-J6B6CWYC.js";import"./chunk-ATSSA22C.js";import{a as D,b as F}from"./chunk-3BEM77IG.js";import{b as R,e as w,j as k}from"./chunk-UCSGE5ZL.js";import"./chunk-2O7XYKW4.js";import{a as L}from"./chunk-YTFCGSG6.js";import"./chunk-RHLJ6NE2.js";import"./chunk-R2ZYXRFE.js";import"./chunk-GFZUU5ZD.js";import"./chunk-BODZH67C.js";import"./chunk-KR7F45VC.js";import{e as V,g as P}from"./chunk-XKXBFP6V.js";import"./chunk-ULM4QL4Q.js";import{oa as g}from"./chunk-3YZBLOIS.js";import{x as E}from"./chunk-2I6ZAGC7.js";import{b as I}from"./chunk-FVCMZ6IK.js";import{a as v}from"./chunk-VDYO34A5.js";import"./chunk-Y2QT2WK5.js";import"./chunk-S35HUXPS.js";import"./chunk-GZWLZB4Q.js";import{Bb as m,Gb as r,Hb as n,Ib as a,O as x,Qa as S,Sb as p,Va as o,_ as l,cc as s,dc as u,gb as C,i as y,lc as b,ma as h,mb as d,mc as f,va as _,vb as c,yb as M}from"./chunk-MKA3N2SS.js";import"./chunk-GAL4ENT6.js";var H=()=>({width:"5rem",height:"5rem"}),O=()=>["/"];function J(t,i){t&1&&(r(0,"div",2),a(1,"p-progress-spinner",3),r(2,"div",4),a(3,"i",5),n()(),r(4,"div",6)(5,"h2",7),s(6,"Verifying account..."),n(),r(7,"p",8),s(8,"Please wait while we validate your credentials"),n()()),t&2&&(o(),M(f(2,H)))}function Q(t,i){if(t&1&&(r(0,"p-message",10),s(1),n()),t&2){let e=p(2);c("@close",e.closeMessage),o(),u(e.state().message)}}function W(t,i){if(t&1&&(r(0,"p-message",11),s(1),n()),t&2){let e=p(2);c("@close",e.closeMessage),o(),u(e.state().error)}}function K(t,i){if(t&1&&(r(0,"div",1)(1,"div")(2,"div",9),d(3,Q,2,2,"p-message",10)(4,W,2,2,"p-message",11),n(),r(5,"div",12)(6,"a",13),s(7,"Forgot password?"),n()(),r(8,"div",14),a(9,"a",15),n(),r(10,"div",14),a(11,"a",16),n()(),a(12,"p-toast")(13,"app-configurator",17),n()),t&2){let e=p();o(3),m(e.state().message?3:-1),o(),m(e.state().error?4:-1),o(5),c("href",e.getLoginUrl(),S),o(2),c("routerLink",f(4,O))}}var q=class t{state=_({loading:!1,message:void 0,error:void 0});authServer=v.authServer;redirectUri=v.redirectUri;codeChallenge="HK02sitqCRpUlfLEX2xl4JGqaVQhNDsfTWH-oQzJHGw";destroyRef=l(h);userService=l(I);messageService=l(g);activatedRouter=l(R);ngOnInit(){console.log("Verification in action"),this.activatedRouter.queryParamMap.pipe(x(i=>{let e=i.get("token");return e?(this.state.set({loading:!0,message:void 0,error:void 0}),this.userService.verifyAccountToken$(e)):(this.state.set({loading:!1,message:void 0,error:"Invalide Link. Please try again"}),y)}),L(this.destroyRef)).subscribe(this.verifyAccount)}closeMessage=()=>this.state.set({loading:!1,message:void 0,error:void 0});getLoginUrl(){return`${this.authServer}/oauth2/authorize?response_type=code&client_id=client&scope=openid&redirect_uri=${this.redirectUri}&code_challenge_method=S256&code_challenge=${this.codeChallenge}`}verifyAccount={next:i=>{this.state.set({loading:!1,message:i.message,error:void 0}),this.messageService.add({severity:"success",summary:"Verification Account",detail:"Account has been verified"})},error:i=>{this.state.set({loading:!1,message:void 0,error:i}),this.messageService.add({severity:"error",summary:"Verification Account",detail:i})},complete:()=>{}};static \u0275fac=function(e){return new(e||t)};static \u0275cmp=C({type:t,selectors:[["app-verifyaccount"]],features:[b([g])],decls:4,vars:1,consts:[[1,"flex","flex-col","items-center","justify-center","gap-6","py-8"],[1,"bg-surface-0","dark:bg-surface-900","p-6","shadow","rounded","w-full","lg:w-6/12"],[1,"relative"],["ariaLabel","Verifying account","strokeWidth","4","animationDuration",".5s",1,"text-primary"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"pi","pi-lock","text-lg","text-primary"],[1,"text-center"],[1,"text-2xl","font-semibold","mb-2"],[1,"text-surface-600","dark:text-surface-300"],[1,"flex","flex-col","gap-4","mb-4"],["severity","success","closable","true"],["severity","error","closable","true"],[1,"flex","items-center","justify-between","mb-12"],[1,"font-medium","no-underline","ml-2","text-primary","text-right","cursor-pointer"],[1,"mt-4"],["pButton","","pRipple","","label","Log in",1,"w-full",3,"href"],["pButton","","pRipple","","text","","label","Page d'accueil",1,"w-full","text-primary-500",3,"routerLink"],["simple",""]],template:function(e,z){e&1&&(r(0,"div",0),d(1,J,9,3)(2,K,14,5,"div",1),a(3,"p-toast"),n()),e&2&&(o(),m(z.state().loading?1:2))},dependencies:[P,V,k,w,E,T,j,B,$,N,G,U,A,F,D],encapsulation:2})};export{q as VerifyaccountComponent};
