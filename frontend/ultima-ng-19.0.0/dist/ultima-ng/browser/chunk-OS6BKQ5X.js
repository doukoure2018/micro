import{a as Z}from"./chunk-ZT3TTGVJ.js";import{a as X,b as Y}from"./chunk-E24E7YRI.js";import"./chunk-F6BLPIFZ.js";import"./chunk-SQPWYWAP.js";import"./chunk-TOQUJNDH.js";import{c as V,d as j}from"./chunk-JK4JG2UW.js";import{b as B}from"./chunk-ML3LU6MO.js";import{a as $,d as J,e as H,k as G}from"./chunk-SRGIHKGJ.js";import"./chunk-KLDL5O4H.js";import"./chunk-PXEEYFPS.js";import"./chunk-4MNJFNZT.js";import"./chunk-7A4CRAMP.js";import"./chunk-3WTE2CKQ.js";import"./chunk-LA2FUI34.js";import"./chunk-ZNTL7BEM.js";import{a as q,b as K}from"./chunk-QZOXHZZK.js";import"./chunk-MPVO6A2U.js";import"./chunk-D6YNXGTA.js";import"./chunk-ED7TFTUL.js";import"./chunk-MZ7FZGG3.js";import{a as Q,b as W}from"./chunk-C4WQ325L.js";import"./chunk-HNZBC55R.js";import"./chunk-J62YMCRW.js";import"./chunk-J6B6CWYC.js";import"./chunk-IEQZB3PI.js";import"./chunk-ATSSA22C.js";import"./chunk-XYTTGGFW.js";import"./chunk-ZNT52ZF3.js";import"./chunk-Z7KSDRLV.js";import"./chunk-N4Q6Z3MW.js";import{b as z}from"./chunk-3BEM77IG.js";import{d as T}from"./chunk-UCSGE5ZL.js";import"./chunk-2O7XYKW4.js";import"./chunk-RHLJ6NE2.js";import"./chunk-R2ZYXRFE.js";import{a as L,b as F}from"./chunk-NRZ4QNP7.js";import"./chunk-GFZUU5ZD.js";import"./chunk-BODZH67C.js";import"./chunk-KR7F45VC.js";import{b as A,f as N,g as k}from"./chunk-XKXBFP6V.js";import"./chunk-ULM4QL4Q.js";import{ka as S,oa as x,sa as w}from"./chunk-3YZBLOIS.js";import"./chunk-2I6ZAGC7.js";import{b as U}from"./chunk-FVCMZ6IK.js";import"./chunk-VDYO34A5.js";import"./chunk-Y2QT2WK5.js";import"./chunk-S35HUXPS.js";import{y as R}from"./chunk-GZWLZB4Q.js";import{Bb as v,Gb as t,Hb as n,Ib as o,Mb as P,Mc as m,Rb as C,Sb as c,Va as l,_ as u,cc as a,dc as d,ec as y,fa as b,ga as O,gb as E,lc as h,mb as f,mc as M,va as g,vb as p,wc as D,yc as I}from"./chunk-MKA3N2SS.js";import"./chunk-GAL4ENT6.js";var ne=()=>[5,10,25,50],ae=()=>({"min-width":"50rem"});function ie(r,e){r&1&&(t(0,"tr")(1,"th",30),a(2," ID "),o(3,"p-sortIcon",31),n(),t(4,"th",32),a(5," Matricule "),o(6,"p-sortIcon",33),n(),t(7,"th",34),a(8," Montant "),o(9,"p-sortIcon",35),n(),t(10,"th"),a(11,"N\xB0 Compte"),n(),t(12,"th",36),a(13," Statut "),o(14,"p-sortIcon",37),n(),t(15,"th",38),a(16," Date "),o(17,"p-sortIcon",39),n(),t(18,"th",40),a(19,"Actions"),n()())}function re(r,e){if(r&1&&(t(0,"span",45),a(1),n()),r&2){let i=c().$implicit;l(),d(i.numeroCompte)}}function oe(r,e){r&1&&(t(0,"span",46),a(1,"-"),n())}function se(r,e){if(r&1){let i=P();t(0,"p-button",50),C("onClick",function(){b(i);let _=c().$implicit,te=c();return O(te.confirmAnnuler(_))}),n()}if(r&2){let i=c().$implicit,s=c();p("text",!0)("rounded",!0)("loading",s.cancellingId()===i.id)}}function le(r,e){r&1&&(t(0,"span",49),a(1,"-"),n())}function me(r,e){if(r&1&&(t(0,"tr")(1,"td")(2,"span",41),a(3),n()(),t(4,"td")(5,"span",42),a(6),n()(),t(7,"td",43)(8,"span",44),a(9),n()(),t(10,"td"),f(11,re,2,1,"span",45)(12,oe,2,0,"span",46),n(),t(13,"td"),o(14,"p-tag",47),n(),t(15,"td"),a(16),D(17,"javaDate"),n(),t(18,"td"),f(19,se,1,3,"p-button",48)(20,le,2,0,"span",49),n()()),r&2){let i=e.$implicit,s=c();l(3),y("#",i.id,""),l(3),d(i.matricule),l(3),d(s.formatMontant(i.amount)),l(2),v(i.numeroCompte?11:12),l(3),p("value",s.getStatutLabel(i.statut))("severity",s.getStatutSeverity(i.statut)),l(2),d(I(17,8,i.createdAt,"dd/MM/yyyy HH:mm")),l(3),v(s.canCancel(i)?19:20)}}function de(r,e){r&1&&(t(0,"tr")(1,"td",51)(2,"div",52),o(3,"i",53),t(4,"span"),a(5,"Aucune demande trouv\xE9e"),n(),o(6,"p-button",54),n()()()),r&2&&(l(6),p("link",!0))}var ee=class r{salaireService=u(U);router=u(T);messageService=u(x);confirmationService=u(S);isLoading=g(!1);demandes=g([]);cancellingId=g(null);demandesEncours=m(()=>this.demandes().filter(e=>e.statut==="ENCOURS"));demandesValidees=m(()=>this.demandes().filter(e=>e.statut==="VALIDER"));demandesConfirmees=m(()=>this.demandes().filter(e=>e.statut==="CONFIRMER"));demandesRejetees=m(()=>this.demandes().filter(e=>e.statut==="REJET"));demandesAnnulees=m(()=>this.demandes().filter(e=>e.statut==="ANNULLER"));totalActif=m(()=>this.demandes().filter(e=>["ENCOURS","VALIDER","CONFIRMER"].includes(e.statut)).reduce((e,i)=>e+(i.amount||0),0));countTotal=m(()=>this.demandes().length);countActives=m(()=>this.demandes().filter(e=>["ENCOURS","VALIDER","CONFIRMER"].includes(e.statut)).length);ngOnInit(){this.loadDemandes()}loadDemandes(){this.isLoading.set(!0),this.salaireService.getMyDemandeSalary().subscribe({next:e=>{e.data?.demandes&&this.demandes.set(e.data.demandes),this.isLoading.set(!1)},error:e=>{console.error("Erreur chargement demandes:",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger vos demandes"}),this.isLoading.set(!1)}})}confirmAnnuler(e){this.confirmationService.confirm({message:`\xCAtes-vous s\xFBr de vouloir annuler cette demande de ${this.formatMontant(e.amount)} ?`,header:"Confirmation d'annulation",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui, annuler",rejectLabel:"Non",acceptButtonStyleClass:"p-button-danger",accept:()=>{this.annulerDemande(e.id)}})}annulerDemande(e){this.cancellingId.set(e),this.salaireService.annulerDemandeSalary(e).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Demande annul\xE9e avec succ\xE8s"}),this.loadDemandes(),this.cancellingId.set(null)},error:i=>{console.error("Erreur annulation:",i),this.messageService.add({severity:"error",summary:"Erreur",detail:i.error?.message||"Impossible d'annuler la demande"}),this.cancellingId.set(null)}})}canCancel(e){return e.statut==="ENCOURS"}formatMontant(e){return e==null?"-":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"GNF",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}getStatutSeverity(e){switch(e?.toUpperCase()){case"ENCOURS":return"info";case"VALIDER":return"success";case"CONFIRMER":return"success";case"REJET":return"danger";case"ANNULLER":return"secondary";default:return"info"}}getStatutLabel(e){switch(e?.toUpperCase()){case"ENCOURS":return"En cours";case"VALIDER":return"Valid\xE9e";case"CONFIRMER":return"Confirm\xE9e";case"REJET":return"Rejet\xE9e";case"ANNULLER":return"Annul\xE9e";default:return e}}nouvelleDemande(){this.router.navigate(["/dashboards/demande-avance-salaire"])}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=E({type:r,selectors:[["app-mes-demandes-salaire"]],features:[h([x,S])],decls:66,vars:16,consts:[[1,"mes-demandes-container"],[1,"header-section"],[1,"pi","pi-list"],[1,"subtitle"],[1,"stats-section"],[1,"stat-card"],[1,"stat-icon"],[1,"pi","pi-file"],[1,"stat-info"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","active"],[1,"pi","pi-clock"],[1,"stat-card","amount"],[1,"pi","pi-wallet"],[1,"actions-bar"],["icon","pi pi-refresh","label","Actualiser",3,"onClick","text","loading"],["icon","pi pi-plus","label","Nouvelle demande",3,"onClick"],["styleClass","p-datatable-striped p-datatable-gridlines","currentPageReportTemplate","Affichage {first} \xE0 {last} sur {totalRecords} demandes",3,"value","paginator","rows","rowsPerPageOptions","loading","tableStyle","showCurrentPageReport","sortField","sortOrder"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"legend-section"],[1,"legend-items"],[1,"legend-item"],["value","En cours","severity","info"],["value","Valid\xE9e","severity","success"],["value","Confirm\xE9e","severity","success"],["value","Rejet\xE9e","severity","danger"],["value","Annul\xE9e","severity","secondary"],["pSortableColumn","id",2,"width","80px"],["field","id"],["pSortableColumn","matricule",2,"width","100px"],["field","matricule"],["pSortableColumn","amount"],["field","amount"],["pSortableColumn","statut",2,"width","120px"],["field","statut"],["pSortableColumn","createdAt",2,"width","150px"],["field","createdAt"],[2,"width","100px"],[1,"id-badge"],[1,"matricule-badge"],[1,"text-right"],[1,"montant"],[1,"numero-compte"],[1,"no-data"],[3,"value","severity"],["icon","pi pi-times","severity","danger","pTooltip","Annuler cette demande",3,"text","rounded","loading"],[1,"no-action"],["icon","pi pi-times","severity","danger","pTooltip","Annuler cette demande",3,"onClick","text","rounded","loading"],["colspan","7",1,"empty-message"],[1,"empty-content"],[1,"pi","pi-inbox"],["label","Faire une demande","icon","pi pi-plus","routerLink","/dashboard/demande-avance-salaire",3,"link"]],template:function(i,s){i&1&&(o(0,"p-toast")(1,"p-confirmDialog"),t(2,"div",0)(3,"div",1)(4,"h2"),o(5,"i",2),a(6," Mes demandes d'avance sur salaire"),n(),t(7,"p",3),a(8,"Consultez et g\xE9rez vos demandes d'avance"),n()(),t(9,"div",4)(10,"div",5)(11,"div",6),o(12,"i",7),n(),t(13,"div",8)(14,"span",9),a(15),n(),t(16,"span",10),a(17,"Total demandes"),n()()(),t(18,"div",11)(19,"div",6),o(20,"i",12),n(),t(21,"div",8)(22,"span",9),a(23),n(),t(24,"span",10),a(25,"Demandes actives"),n()()(),t(26,"div",13)(27,"div",6),o(28,"i",14),n(),t(29,"div",8)(30,"span",9),a(31),n(),t(32,"span",10),a(33,"Montant total actif"),n()()()(),t(34,"div",15)(35,"p-button",16),C("onClick",function(){return s.loadDemandes()}),n(),t(36,"p-button",17),C("onClick",function(){return s.nouvelleDemande()}),n()(),t(37,"p-card")(38,"p-table",18),f(39,ie,20,0,"ng-template",19)(40,me,21,11,"ng-template",20)(41,de,7,1,"ng-template",21),n()(),t(42,"div",22)(43,"h4"),a(44,"L\xE9gende des statuts"),n(),t(45,"div",23)(46,"div",24),o(47,"p-tag",25),t(48,"span"),a(49,"Demande en attente de validation"),n()(),t(50,"div",24),o(51,"p-tag",26),t(52,"span"),a(53,"Demande valid\xE9e par le responsable"),n()(),t(54,"div",24),o(55,"p-tag",27),t(56,"span"),a(57,"Demande confirm\xE9e et en traitement"),n()(),t(58,"div",24),o(59,"p-tag",28),t(60,"span"),a(61,"Demande rejet\xE9e"),n()(),t(62,"div",24),o(63,"p-tag",29),t(64,"span"),a(65,"Demande annul\xE9e par vous"),n()()()()()),i&2&&(l(15),d(s.countTotal()),l(8),d(s.countActives()),l(8),d(s.formatMontant(s.totalActif())),l(4),p("text",!0)("loading",s.isLoading()),l(3),p("value",s.demandes())("paginator",!0)("rows",10)("rowsPerPageOptions",M(14,ne))("loading",s.isLoading())("tableStyle",M(15,ae))("showCurrentPageReport",!0)("sortField","createdAt")("sortOrder",-1))},dependencies:[R,Z,G,$,w,J,H,W,Q,k,N,K,q,j,V,Y,X,F,L,A,z,B],styles:[".mes-demandes-container[_ngcontent-%COMP%]{padding:1.5rem}.header-section[_ngcontent-%COMP%]{margin-bottom:2rem}.header-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary-color);margin-bottom:.5rem}.header-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem}.header-section[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:var(--text-color-secondary)}.stats-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;display:flex;align-items:center;gap:1rem;box-shadow:0 2px 4px #0000000d;border-left:4px solid var(--surface-400)}.stats-section[_ngcontent-%COMP%]   .stat-card.active[_ngcontent-%COMP%]{border-left-color:var(--blue-500)}.stats-section[_ngcontent-%COMP%]   .stat-card.active[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:var(--blue-100);color:var(--blue-600)}.stats-section[_ngcontent-%COMP%]   .stat-card.amount[_ngcontent-%COMP%]{border-left-color:var(--green-500)}.stats-section[_ngcontent-%COMP%]   .stat-card.amount[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:var(--green-100);color:var(--green-600)}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:var(--surface-100);display:flex;align-items:center;justify-content:center}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.25rem}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:block;font-size:1.5rem;font-weight:700;color:var(--text-color)}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-color-secondary)}.actions-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.id-badge[_ngcontent-%COMP%]{background:var(--surface-200);padding:.25rem .5rem;border-radius:4px;font-family:monospace;font-size:.85rem}.matricule-badge[_ngcontent-%COMP%]{background:var(--primary-100);color:var(--primary-700);padding:.25rem .75rem;border-radius:4px;font-weight:600}.montant[_ngcontent-%COMP%]{font-weight:600;color:var(--text-color)}.numero-compte[_ngcontent-%COMP%]{font-family:monospace;background:var(--surface-100);padding:.25rem .5rem;border-radius:4px}.no-data[_ngcontent-%COMP%], .no-action[_ngcontent-%COMP%]{color:var(--text-color-secondary)}.empty-message[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3rem}.empty-message[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;color:var(--surface-400);margin-bottom:1rem}.empty-message[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-color-secondary);margin-bottom:1rem}.legend-section[_ngcontent-%COMP%]{margin-top:2rem;padding:1.5rem;background:var(--surface-50);border-radius:8px}.legend-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--text-color)}.legend-section[_ngcontent-%COMP%]   .legend-items[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem}.legend-section[_ngcontent-%COMP%]   .legend-items[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.legend-section[_ngcontent-%COMP%]   .legend-items[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-color-secondary)}@media (max-width: 768px){.stats-section[_ngcontent-%COMP%]{grid-template-columns:1fr}.actions-bar[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.legend-section[_ngcontent-%COMP%]   .legend-items[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}}"]})};export{ee as MesDemandesSalaireComponent};
